{"componentChunkName":"component---src-templates-blog-post-js","path":"/blogs/Business-Logic-Flaws/","result":{"data":{"site":{"siteMetadata":{"title":"Twistronics Blog"}},"markdownRemark":{"id":"4f294468-6b08-5084-be92-ad0f92f48585","excerpt":"业务逻辑漏洞是使用Web应用正常流程但是可以造成负面结果的方式。 使用现有安全工具检测业务逻辑漏洞非常困难，有以下几个原因： 安全扫描器无法识别业务逻辑漏洞 因为需要正常的商业业务逻辑，无法有效使用 pattern-based 的方式进行扫描识别。 WAF…","html":"<p>业务逻辑漏洞是使用Web应用正常流程但是可以造成负面结果的方式。</p>\n<p>使用现有安全工具检测业务逻辑漏洞非常困难，有以下几个原因：</p>\n<ol>\n<li>安全扫描器无法识别业务逻辑漏洞</li>\n</ol>\n<p>因为需要正常的商业业务逻辑，无法有效使用 pattern-based 的方式进行扫描识别。</p>\n<ol start=\"2\">\n<li>WAF不能有效防御业务逻辑漏洞</li>\n</ol>\n<p>每当这些应用程序更改时，都需要重新配置软件并大量定制WAF。如果没有自动化系统，没有人来配置此策略，那么WAF将总是无效。</p>\n<ol start=\"3\">\n<li>IDS检测也无法检测到业务逻辑漏洞的攻击</li>\n</ol>\n<p>它缺少应用程序的上下文，无法有效地区分合法用户或业务逻辑滥用者。</p>\n<h3>测试业务逻辑漏洞</h3>\n<ol>\n<li>\n<p>检查 Time-of-Check-time-of-use 和竞态条件问题</p>\n<ul>\n<li>尝试同时在Web应用程序中触发交易请求</li>\n<li>尝试打开购物车中价格较低的商品和价格较高的商品的结帐页面，然后在价格较低的商品页面上执行交易，并检查其中是否还包含价格较高的商品。</li>\n<li>付款完成后更改订单。</li>\n</ul>\n</li>\n<li>\n<p>参数修改</p>\n<ul>\n<li>价格修改</li>\n<li>货币修改（如果以美元为单位，则尝试更改为INR）</li>\n<li>数量修改（通过以十进制形式提供诸如0.01之类的值）</li>\n<li>响应修改</li>\n<li>重放攻击</li>\n</ul>\n</li>\n<li>未隐藏和不安全的后端API</li>\n<li>在生产环境中使用测试数据</li>\n</ol>\n<h3>业务逻辑的攻击向量</h3>\n<h4>身份校验和特权升级</h4>\n<ol>\n<li>通过代理观察HTTP流量，包括请求和响应块。</li>\n<li>POST/GET请求的name/value对，JSON，XML或Cookies中的典型参数，参数名称和值都需要分析。</li>\n<li>如果参数名称暗示与权限管理有关，那么它将成为目标。</li>\n<li>一旦确定了目标，下一步就是评估该值，可以将其编码为十六进制，二进制，字符串等。测试仪应该进行一些篡改，并尝试通过一些模糊测试来定义其行为。</li>\n<li>在这种情况下，模糊测试可能需要一种逻辑方法，将位模式或许可标志（例如1更改为0或将Y更改为N）等等。暴力破解，逻辑推理的某种组合将有助于破译逻辑。如果成功的话，将获得利用的机会，最终提升特权或绕过授权。</li>\n</ol>\n<h4>关键参数修改和对未授权内容的访问</h4>\n<ol>\n<li>通过代理观察HTTP流量，包括请求和响应块。</li>\n<li>POST/GET请求的name/value对，JSON，XML或Cookies中的典型参数，参数名称和值都需要分析。</li>\n<li>观察流量中的值，并在所有参数中查找递增的数字和易于猜测的值。</li>\n<li>可以更改此参数的值，并且可能会获得未经授权的访问。</li>\n<li>在上述情况下，我们能够访问其他用户的个人资料。</li>\n</ol>\n<h4>Cookie篡改和旁路攻击</h4>\n<ol>\n<li>在分析阶段或通过代理观察HTTP流量，包括请求和响应块。</li>\n<li>分析该应用的所有cookie，其中一些cookie将由开发人员定义，而不是由Web应用程序服务器定义的会话cookie。</li>\n<li>观察cookie值，在所有cookie中增加容易猜测的值。</li>\n<li>Cookie值可以更改，并且可能会获得未经授权的访问。</li>\n</ol>\n<h4>LDAP参数识别和关键基础架构访问</h4>\n<ol>\n<li>通过代理观察HTTP流量，包括请求和响应块。</li>\n<li>POST/GET请求的name/value对，JSON，XML或Cookies中的典型参数，参数名称和值都需要分析。</li>\n<li>分析参数及其值，查找ON，CN，DN等。通常，这些参数与LDAP链接。另外，查找带有电子邮件或用户名的参数，这些参数可以作为预期目标。</li>\n<li>可以使用 * 或任何其他LDAP特定过滤器（例如OR，AND等）来操纵和注入这些目标参数。这可能导致对LDAP的逻辑旁路攻击，并最终导致访问权限提升。</li>\n</ol>\n<h4>商业逻辑漏洞</h4>\n<ol>\n<li>通过代理观察HTTP流量，包括请求和响应块。</li>\n<li>POST/GET请求的name/value对，JSON，XML或Cookies中的典型参数，参数名称和值都需要分析。</li>\n<li>分析隐藏的参数及其值，查找与业务有关的调用，例如转账，最高限额等。所有这些指示商业逻辑的参数都可以成为目标。</li>\n<li>可以操纵这些目标参数，并可以更改值。可以越过业​​务限制并注入未经授​​权的交易。</li>\n</ol>\n<h4>业务流程绕过</h4>\n<ol>\n<li>通过代理观察HTTP流量，包括请求和响应块。</li>\n<li>POST/GET请求的name/value对，JSON，XML或Cookies中的典型参数，参数名称和值都需要分析。</li>\n<li>确定特定步骤中的业务功能。</li>\n<li>仔细分析所有步骤，并查找应用程序使用隐藏值或通过JavaScript添加的可能参数。</li>\n<li>这些参数可以在进行交易时通过代理进行篡改。这会中断流程，并最终绕过一些业务限制。</li>\n</ol>\n<h4>利用嵌入在JavaScript，Flash或Silverlight中的客户端业务例程</h4>\n<ol>\n<li>将页面加载到浏览器后，需要使用Firebug或任何其他类似工具来分析DOM。</li>\n<li>确定驻留在浏览器堆栈上的所有变量。</li>\n<li>查找可疑的值和参数。</li>\n<li>可以在DOM中操纵这些值并重放HTTP请求。</li>\n<li>如果业务逻辑仅在客户端验证，则最终可能会导致未经授权的访问。</li>\n</ol>\n<h4>身份或配置文件提取</h4>\n<ol>\n<li>通过代理观察HTTP流量，包括请求和响应块。</li>\n<li>POST/GET请求的name/value对，JSON，XML或Cookies中的典型参数，参数名称和值都需要分析。</li>\n<li>查找控制配置文件的参数。一旦确定了这些目标参数，就可以解密，猜测或逆向token。</li>\n</ol>\n<h4>未经授权的URL文件访问和业务身份信息提取</h4>\n<ol>\n<li>通过代理观察HTTP流量，包括请求和响应块。</li>\n<li>POST/GET请求的name/value对，JSON，XML或Cookies中的典型参数，参数名称和值都需要分析。</li>\n<li>根据文件名，文件名，目录名等参数名称确定文件调用功能。这些参数将指出可能存在的未授权文件访问漏洞。</li>\n<li>一旦确定了目标参数，就开始进行基本的猜测或者暴力破解，以从服务器获取另一个用户的文件。</li>\n</ol>\n<h4>业务逻辑的DOS攻击</h4>\n<p>在某些情况下，在应用的不正确实现导致的无限循环可能会导致DoS攻击。</p>","frontmatter":{"title":"Web应用中的业务逻辑漏洞","date":"March 12, 2018","description":"对于常见的业务逻辑漏洞及其攻击向量的说明。","tags":["Cybersecurity","Vulnerability analysis"]}}},"pageContext":{"slug":"/blogs/Business-Logic-Flaws/","previous":{"fields":{"slug":"/blogs/malicious-code-command/"},"frontmatter":{"title":"Several methods to download and execute malicious code through command"}},"next":{"fields":{"slug":"/blogs/CVE-2020-5410/"},"frontmatter":{"title":"Spring Cloud Config Server directory traversal vulnerability CVE-2020-5410"}}}}}