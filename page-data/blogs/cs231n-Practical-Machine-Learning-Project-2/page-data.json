{"componentChunkName":"component---src-templates-blog-post-js","path":"/blogs/cs231n-Practical-Machine-Learning-Project-2/","result":{"data":{"site":{"siteMetadata":{"title":"Twistronics Blog"}},"markdownRemark":{"id":"0bf178c8-cf74-5942-a924-e4b6598b93f9","excerpt":"Option 1. Image Captioning using RNN and LSTM Q1: Image Captioning with Vanilla RNNs The IPython notebook  walk through the implementation of an imageâ€¦","html":"<h2>Option 1. Image Captioning using RNN and LSTM</h2>\n<h3>Q1: Image Captioning with Vanilla RNNs</h3>\n<p>The IPython notebook <code class=\"language-text\">RNN_Captioning.ipynb</code> walk through the implementation of an image captioning system on MS-COCO using vanilla recurrent networks.</p>\n<p>The file <code class=\"language-text\">cs231n/rnn_layers.py</code> contains implementations of different layer types that are needed for recurrent neural networks. The file <code class=\"language-text\">cs231n/classifiers/rnn.py</code> contains implementations of CaptioningRNN class.</p>\n<p>run the following command</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">ipython notebook RNN_Captioning.ipynb</code></pre></div>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 590px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/5c2a1a0727a3df4380e360d8e9c65ca8/5754a/q1-1.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 82.43243243243244%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAQCAYAAAAWGF8bAAAACXBIWXMAAAsSAAALEgHS3X78AAABLUlEQVQ4y62U3WrCMBSAw2BvtPu9wSrMurHn2S7GHsIX2I3rBpuCQr0RigzGMPZKGabWiyahHWhNTZeYSm2ZYCUHDgknyccX8gOAiMWCvqcaIgiCR8kDCFErq61Fbk7IWC4mhDxsgfN5+KJ4nPETIhPJgbMZec2B1baZAVnZ0NIKnExowbAK9D/g2XQatZJEn+E5xupQxJgWQxBFasuMcaYmHQ89AFSGcZwD99vKQELwmyxQWjQ8xvSA4W9LFpZLzoQlV9MqXeyyIdndwzgM02S1SuWZF1Ks25Rre7l7eveZYfSh43PAGD9tgbZtX/q+f42QZ7guNCEc10cjz4AQ1Wz787bfd+uW5dx1u9DsdL4bjuPVhkPfaLe/bnq9sSn6V4PBT6PZfL4AAgx0xh9quEi13cfkwgAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"q1 1\"\n        title=\"q1 1\"\n        src=\"/static/5c2a1a0727a3df4380e360d8e9c65ca8/fcda8/q1-1.png\"\n        srcset=\"/static/5c2a1a0727a3df4380e360d8e9c65ca8/12f09/q1-1.png 148w,\n/static/5c2a1a0727a3df4380e360d8e9c65ca8/e4a3f/q1-1.png 295w,\n/static/5c2a1a0727a3df4380e360d8e9c65ca8/fcda8/q1-1.png 590w,\n/static/5c2a1a0727a3df4380e360d8e9c65ca8/5754a/q1-1.png 613w\"\n        sizes=\"(max-width: 590px) 100vw, 590px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span></p>\n<p>result</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 590px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/1c1beeec8cf45227483558972c058330/3dd3e/q1-2.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 75%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAPCAYAAADkmO9VAAAACXBIWXMAAAsSAAALEgHS3X78AAAEH0lEQVQ4y1WS3U9bdRjHzykvHdDTUqBAuxZKS19A3ikvhVagLRRIBxQObz2nDFoEgU0s5UUZAhlsDIeTBBzETGPUocu8ckuMeuOFF144TNyF/4DpjS/x2p3+vvawTeeTfPMkz/PNJ883eSjq/yUBIHY6oaQXuqhccf/CXPJMzz1Pa27nfpJvZsflCy0Pmcrr+cRo2KBSBKzqTE6TLeMpiSQolSbzsrRUXp4h5eTy9KA8UzaqVKRzvp4BrlSv4zJkikAoujV09NlXTso7fZ3h1z/5bSB6iOr2UfE8mNVZaDTmod6Qi9riXKhzZMiUpyErMwMaVTpK1akoMRZidjaCchWDxmYPHv8B3Hn44+NEEDMTunovNnfra4S27sd1piqSgBIlk06YNClpLj9PvHY9MeszSaUpi/ja68jy2k1y6bV1EuYmSH1eBnE6vU+Ovvsd/JUPHlE5ZgfTxl2JDUZu4fLeg3ho6ZBo1JozqCiJhCKq7AxiNOpJ9+AEeXXziOx+8TMJTi4Tq6WEmLPTiK2uTeh/4wTOoYVTamnjPcYViMYahiMY3/o8Htk4xubbn4INr6De44fd2YI2dxca+6YxsnyMyP6XGIu+g8JE1Gq9EjkKKQr0xYI/cozOifVTqrjWztS7fLGuPh6h2bX49PgMFmZXEIls4pWxcUwGx8D3sujr4zAcmMWl5V3YmtxwF2fh/akWGHMZpKSeE7z8CtjprVMqScowiWgxR7MbV29+HA/4/Bjs9CHy1iEC4ShaWzxwl+hRU9sIu6sHnsFJqLVa9FXqcIOtRX+1FnRKmsBH99HJLZ5SqnztGVCelY+t2w/iQW4avT2j2D75CeHtu3i5LwRHmQVGmxu2njC6xudRWqiG16rB3fFGtJvzQCelCNzyARy9U6fiKzI0LYmJ71JmtcR5vx9jvk6svz6PyPQMRru6UFNhQq29EoUVZnQ0lcKmUUKRmopARSGKlHKk0pTQ0MGiyTv0FCheKALlisz4+soq3r2xh72NHeyubSDA8mi01aC/04ma+hr0VBvQZso/+9eA3QJv4XlMFOiE2QoHmpvb/wPSNCWa4serC+SHOwfkeGGRXBsfIdfCk8TvrCP2lwqIt8pK+AYjKZDLiCrlHPloxkPuXWwnK0UWIarQY15t/hf4q0QiEYFPbq/OCX9+/1D4ZntVuNxUKQRri4SWYo3gsBQIw3UmwVepE/RJMkFBpwhHM63CSdAluJNz/g4odVjMNjx6DvzrGRARfgjffniIJW4Eb164AH+1Fd2lRlRqctFVpkOVOhtaSfqZd9VfhR1XNSwUgzFlAQJK7S8iMDkhH03TQ4nOsp42dn81wl7s72anWh1sk9HA2nQaVq+QszVaFauRZbBSOpkVvVyDgT3osLOO5KyBMaVupIXJ8fwDdsa+5ko/EiUAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"q1 2\"\n        title=\"q1 2\"\n        src=\"/static/1c1beeec8cf45227483558972c058330/fcda8/q1-2.png\"\n        srcset=\"/static/1c1beeec8cf45227483558972c058330/12f09/q1-2.png 148w,\n/static/1c1beeec8cf45227483558972c058330/e4a3f/q1-2.png 295w,\n/static/1c1beeec8cf45227483558972c058330/fcda8/q1-2.png 590w,\n/static/1c1beeec8cf45227483558972c058330/3dd3e/q1-2.png 595w\"\n        sizes=\"(max-width: 590px) 100vw, 590px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span>\n<span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 498px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/306663fdfbc2c89f6a7e190a5eee2051/79e1b/q1-3.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 104.05405405405406%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAVCAYAAABG1c6oAAAACXBIWXMAAAsSAAALEgHS3X78AAAFxElEQVQ4y03UeVATVxwH8AeI1quCQq12GMSDO6A5SCAgR7jCFUISjkBIAgYEISSKKAg1CCIeHF4VrTggEpRUQVsdkXqN2nEKtVNr/6itGP6w//hH/+h0pnW7+XZ5ZdruzHd33r55n/293Z0fIf8dniveX+4BgCx2Jwvm77nNn1Ys8PD0XUCWug3s6Zy75TE/7z6fRf9zyAouK7lEcAnmIuEi8vbxi1y2fGWU58IlW+bGXKRcorjwiZubxN3DY4ubu1s0N47kEs7lIy4+3Jybx6JFC+kTVq9de/zD1at/DQkMe6nIzp/NV2tn83KVM1KJ+LVIKJ6Jk8bOhoeGzoYEbXq9Yb3/jK+P9xsuT7y8li+Zq9rd3d2TlqhX5tGtiQX80a1RYmyNjkeaLAtF+UUo0RYjRy5HapIMyYmJiJVEgR8eiiB/PwSs+QBrfVa+8fFe8d6/+5XGCIksXjr3Hog8NWE4T5GJzBzVnxm5BrZ8Ww1rsdazCo2SlaWksHEJCWyMRMSKJVvYsND1THhQADYF+M0EB/gvnlsf4LeWkHxVLsnNkVNQmZNhN5RqUarVMsYSDXo79mHCMYTaaiOU2anQFiq5ipUoUMsRnxDFRvJDsEUQ5owWR1FQIOARsrNMRpqLYyi4u0Rq76iWY791B5MmiUBHbgiGLGk4opfCXJqJ5j0mtDQaYSnLQVFuMivh8yDmhzglUh4FowQhhLTWpZPuxioK2sxK+0hvEz6uNTF6iR/Ol2xGT4Y/WrICUabNR5MhBUfNqbCoeChODmdlsVLwecHO6CDyT4Xh6wi5OW4hNRX5FDzeZbQfbDYjI1HKVCWForc0Fl2FAuzJCEdleTk+1ooxbivAaFMJutTBrDo2EHGxQqc5L4iCqQl8Qno6C0iMQEzB7Qa5PTstDvGCMKZam4VdhizUaxKwd7sW1tpq1BoLYNVGo04Rju3yIDZdvBGKNKnzUreVgnp1CiEaVTopVGdSMF8lt2sLs1FhyGMOpgvRr4xDn60OzRY9Dne0oqmrBrzadTBWJMNUJGMLVako1qQ5r189RMGaSjUhKSkJZI9ZR0F9UbbdXGOArUbPTG0NwwvxBoyYDWhorEJbQzX2HitEWGsAGlqNaGusZU93NaHn0F5nVpqMggeazISYdEqSIAykoCJFYi9VJWJbupgZ5G/EhcCPYFrnC3FEAIpkPNw+ocaN9ixUZgqRkyRilekS+tuQZSspuCEskJD2vZXkUIuJgi27DPZrA214OHGW6dNno95rKRpiN6NcwsPF/SpM2Utw54gCl7orcW5XEjsQ4oXdwWucAZp0Cpoi1xMyMnSCTE9PUvD2rWH7i+cP8PPMFGMr06Eu1BNdOgEqQ+PRv3MrJo9GYLw1FTeu2fC0fRN7f9VyTK5e6pyOWEjBe2u4i8v1jrz87hEFf//trf3pXQcunu1khvpOo6U0Gp/uW4WaeC/023xxqmQdmhVCnG8vgOMwYUeLPeHQLXZOv+VT8EYj17ReTD0kwiDv+S1vsx9u0OPkwVpm6vEXuDM2wC0Ow2D7Apzbx8NgTzNaLUVoFfljQLWMHe31wa2xaufzX0DByTtnCHl8e4zstv7zlT/psQ0PnD2Mbx473v347LZr+u4ZV0tFmsuSstG1Iz3Sde9Wv+uru4MuW4yv62iQ91/HrUno7dz/ut6op+CRA42EXP/sIpm8cZmCN68Njzx9cBWvfvj6r2dPJvDo8zaM9DWhu1GHY/uUePX9Tfz0/BFuDXfCrAl11ZUrsLOqZFaTI6JgrSmfkDHHILlysY+CjuELlybGL+DJRN8fX44fZRz9O5mmugKmo9HEHG/TMfevH2G+fXKHmeDmWuqN76xVOjRYtr3SFytpP7Ts0BMyau/nqhyivXHMMbR+ZLBPcuWcRXjveovo5MFqUXlRsqggJ0ZUX5kqunyyUHTpVLHobLdaZK3WCSsNmijrjvKI7RVltEGbq8rI3/gmj4x1Ld6dAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"q1 3\"\n        title=\"q1 3\"\n        src=\"/static/306663fdfbc2c89f6a7e190a5eee2051/79e1b/q1-3.png\"\n        srcset=\"/static/306663fdfbc2c89f6a7e190a5eee2051/12f09/q1-3.png 148w,\n/static/306663fdfbc2c89f6a7e190a5eee2051/e4a3f/q1-3.png 295w,\n/static/306663fdfbc2c89f6a7e190a5eee2051/79e1b/q1-3.png 498w\"\n        sizes=\"(max-width: 498px) 100vw, 498px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span>\n<span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 493px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/ef331f867c6cde9910796dbfae36ec58/f88d0/q1-4.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 105.40540540540542%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,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'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"q1 4\"\n        title=\"q1 4\"\n        src=\"/static/ef331f867c6cde9910796dbfae36ec58/f88d0/q1-4.png\"\n        srcset=\"/static/ef331f867c6cde9910796dbfae36ec58/12f09/q1-4.png 148w,\n/static/ef331f867c6cde9910796dbfae36ec58/e4a3f/q1-4.png 295w,\n/static/ef331f867c6cde9910796dbfae36ec58/f88d0/q1-4.png 493w\"\n        sizes=\"(max-width: 493px) 100vw, 493px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span>\n<span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 489px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/23aee6a39b75f1da8cbbf4d8eaae6fcb/03e1f/q1-5.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 106.08108108108108%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAVCAYAAABG1c6oAAAACXBIWXMAAAsSAAALEgHS3X78AAAEbklEQVQ4y2WV+S+caxTHh7HvS7lErAmN3DJcqUtvpAQJWiFCYgvpFLGEH0osk3LREgTX1tqjUmtLUFtDYknT1C80/Fht+oNf7v0T3HfmOfd7nmJu0jc5eWbmfZ/P+z3nOec7KpVKZY5QW1tbq7FaIMxUP67r1QRhg3C6+m76v+BLbW5ufr2XQ/ULIgBx28nJKSIyMjIsNTU1JDY2NvLBgwe/urm5/XHr1q0QZ2dnjYuLS7iDg0MYXv67ra3tXQ8PDw2+/4a9gQjNzUtDQkJYpSo+Pr4c8XdCQsJ5enr619zc3O+9vb3fX79+/W1tbe0L1u+vXr36OjEx8e3FixdfOjs7/2ltba3nvTExMRaq62t2dpYlq/r7+xtHR0cJEIqIiKC4uDhaXV2lhYUFWlpaopWVFWppaaHGxkaqr68nwGloaKib956enpreALu7u2W9RkZGGvjBurq6y+TkZINWqzUkJSUZiouLDYWFhQaoMUCZYWpqyvDkyZN/oZQWFxc7eO/4+Lj6BoiHJHByclLX3t5OtbW1SkNDg8jLyyMrKyuKioqirKws4ntzc3OsWLS1tSkoAWfQyXvfvHnzMxCrDm+nyspKJScnR2g0GvLx8SE/Pz9CXQkKKTs7myoqKgRCWV9fp42NDQkE2Ajs6OiQQCjQAUrDw8MKVApvb28KDQ2l6OhoevjwIT19+pRYNUog8vPzld3dXXr//r0Ebm5uGoEvX768UchpfPr0SUGxBatDy5Cnpyfdu3dPKgSIQxQVFSk7Ozu0vb0tgVtbW0bg2NiYBOKEdfPz81RQUKD4+vqKwMBAYpWOjo4UHh4uFXJwfauqqhRkQn19fRKI1QiEXAlEW+iOj48pLS1NQfdLhUFBQbJuZWVl9OHDB/r8+TMdHR2Jd+/eKTU1NVRSUiKB5eXlRuDHjx8lcG9vT3dxcUFIWzExMRH+/v5SGQ6ASktLqbq6mgYGBgjPC2SlYHoIkySBWI3Aw8NDCTw4ONCxgpOTEwXpi8TERMJ4EUaN3N3dZfrcRniJ4LKwelNTUwm0s7MzAvf3928UouPp7OxMOT8/F9x7FhYWhHklV1dXwvySjY0Nr6xewcxTQECABAYHBxuBOCmzq5PScZ0AVqBaYFqkIobBOKRSS0tLsre3FwArDMc9CcRLjcDl5WWzq1WHAyJ0vYKiCziOhHDarJI/q9VqCYRKPjhCSCBSNwJnZmbMrlYdoDQ9Pa28fftWZGRkSIiXlxdDZMp4jMLCwgQcSuHPaCkJvPLEHxcAZlerDsNOfILc2JhXAcdhNQInKqBOcDthDAXmWwJx72cgTOHaHBpgZYQTvuzp6dE3NzfrHz9+rEeT61Ev/Z07d/SZmZl6GK8e5bhk5VAo3QbmawQODg5KIHrsT/Y+Ngj2RXQ/dXV1sZ3JGX7+/Dk1NTURmlg2e0pKCs/5X7z3/v37RiA28v+GCsaqQbpl8MVHAGlhFloYhxbpa+F9Wv4No6d99uyZFn34CO5eCke6y3thyJLxHwXuZpqGijIhAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"q1 5\"\n        title=\"q1 5\"\n        src=\"/static/23aee6a39b75f1da8cbbf4d8eaae6fcb/03e1f/q1-5.png\"\n        srcset=\"/static/23aee6a39b75f1da8cbbf4d8eaae6fcb/12f09/q1-5.png 148w,\n/static/23aee6a39b75f1da8cbbf4d8eaae6fcb/e4a3f/q1-5.png 295w,\n/static/23aee6a39b75f1da8cbbf4d8eaae6fcb/03e1f/q1-5.png 489w\"\n        sizes=\"(max-width: 489px) 100vw, 489px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span></p>\n<p>code: in <code class=\"language-text\">cs231n/classifiers/rnn.py</code></p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">  <span class=\"token keyword\">def</span> <span class=\"token function\">loss</span><span class=\"token punctuation\">(</span>self<span class=\"token punctuation\">,</span> features<span class=\"token punctuation\">,</span> captions<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    <span class=\"token triple-quoted-string string\">\"\"\"\n    Compute training-time loss for the RNN. We input image features and\n    ground-truth captions for those images, and use an RNN (or LSTM) to compute\n    loss and gradients on all parameters.\n\n    Inputs:\n    - features: Input image features, of shape (N, D)\n    - captions: Ground-truth captions; an integer array of shape (N, T) where\n      each element is in the range 0 &lt;= y[i, t] &lt; V\n\n    Returns a tuple of:\n    - loss: Scalar loss\n    - grads: Dictionary of gradients parallel to self.params\n    \"\"\"</span>\n    <span class=\"token comment\"># Cut captions into two pieces: captions_in has everything but the last word</span>\n    <span class=\"token comment\"># and will be input to the RNN; captions_out has everything but the first</span>\n    <span class=\"token comment\"># word and this is what we will expect the RNN to generate. These are offset</span>\n    <span class=\"token comment\"># by one relative to each other because the RNN should produce word (t+1)</span>\n    <span class=\"token comment\"># after receiving word t. The first element of captions_in will be the START</span>\n    <span class=\"token comment\"># token, and the first element of captions_out will be the first word.</span>\n    captions_in <span class=\"token operator\">=</span> captions<span class=\"token punctuation\">[</span><span class=\"token punctuation\">:</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">:</span><span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span>\n    captions_out <span class=\"token operator\">=</span> captions<span class=\"token punctuation\">[</span><span class=\"token punctuation\">:</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">:</span><span class=\"token punctuation\">]</span>\n    <span class=\"token comment\"># You'll need this</span>\n    mask <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span>captions_out <span class=\"token operator\">!=</span> self<span class=\"token punctuation\">.</span>_null<span class=\"token punctuation\">)</span>\n\n    <span class=\"token comment\"># Weight and bias for the affine transform from image features to initial</span>\n    <span class=\"token comment\"># hidden state</span>\n    W_proj<span class=\"token punctuation\">,</span> b_proj <span class=\"token operator\">=</span> self<span class=\"token punctuation\">.</span>params<span class=\"token punctuation\">[</span><span class=\"token string\">'W_proj'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> self<span class=\"token punctuation\">.</span>params<span class=\"token punctuation\">[</span><span class=\"token string\">'b_proj'</span><span class=\"token punctuation\">]</span>\n    <span class=\"token comment\"># Word embedding matrix</span>\n    W_embed <span class=\"token operator\">=</span> self<span class=\"token punctuation\">.</span>params<span class=\"token punctuation\">[</span><span class=\"token string\">'W_embed'</span><span class=\"token punctuation\">]</span>\n    <span class=\"token comment\"># Input-to-hidden, hidden-to-hidden, and biases for the RNN</span>\n    Wx<span class=\"token punctuation\">,</span> Wh<span class=\"token punctuation\">,</span> b <span class=\"token operator\">=</span> self<span class=\"token punctuation\">.</span>params<span class=\"token punctuation\">[</span><span class=\"token string\">'Wx'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> self<span class=\"token punctuation\">.</span>params<span class=\"token punctuation\">[</span><span class=\"token string\">'Wh'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> self<span class=\"token punctuation\">.</span>params<span class=\"token punctuation\">[</span><span class=\"token string\">'b'</span><span class=\"token punctuation\">]</span>\n    <span class=\"token comment\"># Weight and bias for the hidden-to-vocab transformation.</span>\n    W_vocab<span class=\"token punctuation\">,</span> b_vocab <span class=\"token operator\">=</span> self<span class=\"token punctuation\">.</span>params<span class=\"token punctuation\">[</span><span class=\"token string\">'W_vocab'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> self<span class=\"token punctuation\">.</span>params<span class=\"token punctuation\">[</span><span class=\"token string\">'b_vocab'</span><span class=\"token punctuation\">]</span>\n    loss<span class=\"token punctuation\">,</span> grads <span class=\"token operator\">=</span> <span class=\"token number\">0.0</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span><span class=\"token punctuation\">}</span>\n    <span class=\"token comment\">############################################################################</span>\n    <span class=\"token comment\"># TODO: Implement the forward and backward passes for the CaptioningRNN.   #</span>\n    <span class=\"token comment\"># In the forward pass you will need to do the following:                   #</span>\n    <span class=\"token comment\"># (1) Use an affine transformation to compute the initial hidden state     #</span>\n    <span class=\"token comment\">#     from the image features. This should produce an array of shape (N, H)#</span>\n    <span class=\"token comment\"># (2) Use a word embedding layer to transform the words in captions_in     #</span>\n    <span class=\"token comment\">#     from indices to vectors, giving an array of shape (N, T, W).         #</span>\n    <span class=\"token comment\"># (3) Use either a vanilla RNN or LSTM (depending on self.cell_type) to    #</span>\n    <span class=\"token comment\">#     process the sequence of input word vectors and produce hidden state  #</span>\n    <span class=\"token comment\">#     vectors for all timesteps, producing an array of shape (N, T, H).    #</span>\n    <span class=\"token comment\"># (4) Use a (temporal) affine transformation to compute scores over the    #</span>\n    <span class=\"token comment\">#     vocabulary at every timestep using the hidden states, giving an      #</span>\n    <span class=\"token comment\">#     array of shape (N, T, V).                                            #</span>\n    <span class=\"token comment\"># (5) Use (temporal) softmax to compute loss using captions_out, ignoring  #</span>\n    <span class=\"token comment\">#     the points where the output word is &lt;NULL> using the mask above.     #</span>\n    <span class=\"token comment\">#                                                                          #</span>\n    <span class=\"token comment\"># In the backward pass you will need to compute the gradient of the loss   #</span>\n    <span class=\"token comment\"># with respect to all model parameters. Use the loss and grads variables   #</span>\n    <span class=\"token comment\"># defined above to store loss and gradients; grads[k] should give the      #</span>\n    <span class=\"token comment\"># gradients for self.params[k].                                            #</span>\n    <span class=\"token comment\">############################################################################</span>\n\n    affine_out<span class=\"token punctuation\">,</span> affine_cache <span class=\"token operator\">=</span> affine_forward<span class=\"token punctuation\">(</span>features<span class=\"token punctuation\">,</span> W_proj<span class=\"token punctuation\">,</span> b_proj<span class=\"token punctuation\">)</span>\n    embed_out<span class=\"token punctuation\">,</span> embed_cache <span class=\"token operator\">=</span> word_embedding_forward<span class=\"token punctuation\">(</span>captions_in<span class=\"token punctuation\">,</span> W_embed<span class=\"token punctuation\">)</span>\n    forward <span class=\"token operator\">=</span> rnn_forward <span class=\"token keyword\">if</span> self<span class=\"token punctuation\">.</span>cell_type <span class=\"token operator\">==</span> <span class=\"token string\">'rnn'</span> <span class=\"token keyword\">else</span> lstm_forward\n    forward_out<span class=\"token punctuation\">,</span> forward_cache <span class=\"token operator\">=</span> forward<span class=\"token punctuation\">(</span>embed_out<span class=\"token punctuation\">,</span> affine_out<span class=\"token punctuation\">,</span> Wx<span class=\"token punctuation\">,</span> Wh<span class=\"token punctuation\">,</span> b<span class=\"token punctuation\">)</span>\n    temporal_out<span class=\"token punctuation\">,</span> temporal_cache <span class=\"token operator\">=</span> temporal_affine_forward<span class=\"token punctuation\">(</span>forward_out<span class=\"token punctuation\">,</span> W_vocab<span class=\"token punctuation\">,</span> b_vocab<span class=\"token punctuation\">)</span>\n    loss<span class=\"token punctuation\">,</span> dx <span class=\"token operator\">=</span> temporal_softmax_loss<span class=\"token punctuation\">(</span>temporal_out<span class=\"token punctuation\">,</span> captions_out<span class=\"token punctuation\">,</span> mask<span class=\"token punctuation\">,</span> <span class=\"token boolean\">False</span><span class=\"token punctuation\">)</span>\n    drnn<span class=\"token punctuation\">,</span> dW_vocab<span class=\"token punctuation\">,</span> db_vocab <span class=\"token operator\">=</span> temporal_affine_backward<span class=\"token punctuation\">(</span>dx<span class=\"token punctuation\">,</span> temporal_cache<span class=\"token punctuation\">)</span>\n    backward <span class=\"token operator\">=</span> rnn_backward <span class=\"token keyword\">if</span> self<span class=\"token punctuation\">.</span>cell_type <span class=\"token operator\">==</span> <span class=\"token string\">'rnn'</span> <span class=\"token keyword\">else</span> lstm_backward\n    dembed<span class=\"token punctuation\">,</span> daffine<span class=\"token punctuation\">,</span> dWx<span class=\"token punctuation\">,</span> dWh<span class=\"token punctuation\">,</span> db <span class=\"token operator\">=</span> backward<span class=\"token punctuation\">(</span>drnn<span class=\"token punctuation\">,</span> forward_cache<span class=\"token punctuation\">)</span>\n    dW_embed <span class=\"token operator\">=</span> word_embedding_backward<span class=\"token punctuation\">(</span>dembed<span class=\"token punctuation\">,</span> embed_cache<span class=\"token punctuation\">)</span>\n    dx<span class=\"token punctuation\">,</span> dW_proj<span class=\"token punctuation\">,</span> db_proj <span class=\"token operator\">=</span> affine_backward<span class=\"token punctuation\">(</span>daffine<span class=\"token punctuation\">,</span> affine_cache<span class=\"token punctuation\">)</span>\n    grads <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span><span class=\"token string\">'W_vocab'</span><span class=\"token punctuation\">:</span>dW_vocab<span class=\"token punctuation\">,</span><span class=\"token string\">'b_vocab'</span><span class=\"token punctuation\">:</span>db_vocab<span class=\"token punctuation\">,</span><span class=\"token string\">'Wx'</span><span class=\"token punctuation\">:</span>dWx<span class=\"token punctuation\">,</span><span class=\"token string\">'Wh'</span><span class=\"token punctuation\">:</span>dWh<span class=\"token punctuation\">,</span><span class=\"token string\">'b'</span><span class=\"token punctuation\">:</span>db<span class=\"token punctuation\">,</span>\n             <span class=\"token string\">'W_embed'</span><span class=\"token punctuation\">:</span>dW_embed<span class=\"token punctuation\">,</span><span class=\"token string\">'W_proj'</span><span class=\"token punctuation\">:</span>dW_proj<span class=\"token punctuation\">,</span><span class=\"token string\">'b_proj'</span><span class=\"token punctuation\">:</span>db_proj<span class=\"token punctuation\">}</span>\n\n    <span class=\"token comment\">############################################################################</span>\n    <span class=\"token comment\">#                             END OF YOUR CODE                             #</span>\n    <span class=\"token comment\">############################################################################</span>\n    <span class=\"token keyword\">return</span> loss<span class=\"token punctuation\">,</span> grads</code></pre></div>\n<p>in <code class=\"language-text\">cs231n/classifiers/rnn.py</code></p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">  <span class=\"token keyword\">def</span> <span class=\"token function\">sample</span><span class=\"token punctuation\">(</span>self<span class=\"token punctuation\">,</span> features<span class=\"token punctuation\">,</span> max_length<span class=\"token operator\">=</span><span class=\"token number\">30</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    <span class=\"token triple-quoted-string string\">\"\"\"\n    Run a test-time forward pass for the model, sampling captions for input\n    feature vectors.\n\n    At each timestep, we embed the current word, pass it and the previous hidden\n    state to the RNN to get the next hidden state, use the hidden state to get\n    scores for all vocab words, and choose the word with the highest score as\n    the next word. The initial hidden state is computed by applying an affine\n    transform to the input image features, and the initial word is the &lt;START>\n    token.\n\n    For LSTMs you will also have to keep track of the cell state; in that case\n    the initial cell state should be zero.\n\n    Inputs:\n    - features: Array of input image features of shape (N, D).\n    - max_length: Maximum length T of generated captions.\n\n    Returns:\n    - captions: Array of shape (N, max_length) giving sampled captions,\n      where each element is an integer in the range [0, V). The first element\n      of captions should be the first sampled word, not the &lt;START> token.\n    \"\"\"</span>\n    N <span class=\"token operator\">=</span> features<span class=\"token punctuation\">.</span>shape<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span>\n    captions <span class=\"token operator\">=</span> self<span class=\"token punctuation\">.</span>_null <span class=\"token operator\">*</span> np<span class=\"token punctuation\">.</span>ones<span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span>N<span class=\"token punctuation\">,</span> max_length<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> dtype<span class=\"token operator\">=</span>np<span class=\"token punctuation\">.</span>int32<span class=\"token punctuation\">)</span>\n\n    <span class=\"token comment\"># Unpack parameters</span>\n    W_proj<span class=\"token punctuation\">,</span> b_proj <span class=\"token operator\">=</span> self<span class=\"token punctuation\">.</span>params<span class=\"token punctuation\">[</span><span class=\"token string\">'W_proj'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> self<span class=\"token punctuation\">.</span>params<span class=\"token punctuation\">[</span><span class=\"token string\">'b_proj'</span><span class=\"token punctuation\">]</span>\n    W_embed <span class=\"token operator\">=</span> self<span class=\"token punctuation\">.</span>params<span class=\"token punctuation\">[</span><span class=\"token string\">'W_embed'</span><span class=\"token punctuation\">]</span>\n    Wx<span class=\"token punctuation\">,</span> Wh<span class=\"token punctuation\">,</span> b <span class=\"token operator\">=</span> self<span class=\"token punctuation\">.</span>params<span class=\"token punctuation\">[</span><span class=\"token string\">'Wx'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> self<span class=\"token punctuation\">.</span>params<span class=\"token punctuation\">[</span><span class=\"token string\">'Wh'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> self<span class=\"token punctuation\">.</span>params<span class=\"token punctuation\">[</span><span class=\"token string\">'b'</span><span class=\"token punctuation\">]</span>\n    W_vocab<span class=\"token punctuation\">,</span> b_vocab <span class=\"token operator\">=</span> self<span class=\"token punctuation\">.</span>params<span class=\"token punctuation\">[</span><span class=\"token string\">'W_vocab'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> self<span class=\"token punctuation\">.</span>params<span class=\"token punctuation\">[</span><span class=\"token string\">'b_vocab'</span><span class=\"token punctuation\">]</span>\n\n    <span class=\"token comment\">###########################################################################</span>\n    <span class=\"token comment\"># TODO: Implement test-time sampling for the model. You will need to      #</span>\n    <span class=\"token comment\"># initialize the hidden state of the RNN by applying the learned affine   #</span>\n    <span class=\"token comment\"># transform to the input image features. The first word that you feed to  #</span>\n    <span class=\"token comment\"># the RNN should be the &lt;START> token; its value is stored in the         #</span>\n    <span class=\"token comment\"># variable self._start. At each timestep you will need to do to:          #</span>\n    <span class=\"token comment\"># (1) Embed the previous word using the learned word embeddings           #</span>\n    <span class=\"token comment\"># (2) Make an RNN step using the previous hidden state and the embedded   #</span>\n    <span class=\"token comment\">#     current word to get the next hidden state.                          #</span>\n    <span class=\"token comment\"># (3) Apply the learned affine transformation to the next hidden state to #</span>\n    <span class=\"token comment\">#     get scores for all words in the vocabulary                          #</span>\n    <span class=\"token comment\"># (4) Select the word with the highest score as the next word, writing it #</span>\n    <span class=\"token comment\">#     to the appropriate slot in the captions variable                    #</span>\n    <span class=\"token comment\">#                                                                         #</span>\n    <span class=\"token comment\"># For simplicity, you do not need to stop generating after an &lt;END> token #</span>\n    <span class=\"token comment\"># is sampled, but you can if you want to.                                 #</span>\n    <span class=\"token comment\">#                                                                         #</span>\n    <span class=\"token comment\"># HINT: You will not be able to use the rnn_forward or lstm_forward       #</span>\n    <span class=\"token comment\"># functions; you'll need to call rnn_step_forward or lstm_step_forward in #</span>\n    <span class=\"token comment\"># a loop.                                                                 #</span>\n    <span class=\"token comment\">###########################################################################</span>\n\n    <span class=\"token keyword\">if</span> self<span class=\"token punctuation\">.</span>cell_type <span class=\"token operator\">==</span> <span class=\"token string\">'rnn'</span><span class=\"token punctuation\">:</span>\n      prev_word <span class=\"token operator\">=</span> np<span class=\"token punctuation\">.</span>zeros<span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span>N<span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> dtype<span class=\"token operator\">=</span>np<span class=\"token punctuation\">.</span>int32<span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> self<span class=\"token punctuation\">.</span>_start\n      prev_h<span class=\"token punctuation\">,</span> affine_cache <span class=\"token operator\">=</span> affine_forward<span class=\"token punctuation\">(</span>features<span class=\"token punctuation\">,</span> W_proj<span class=\"token punctuation\">,</span> b_proj<span class=\"token punctuation\">)</span>\n      <span class=\"token keyword\">for</span> t <span class=\"token keyword\">in</span> <span class=\"token builtin\">xrange</span><span class=\"token punctuation\">(</span>max_length<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n        embed_out<span class=\"token punctuation\">,</span> embed_cache <span class=\"token operator\">=</span> word_embedding_forward<span class=\"token punctuation\">(</span>prev_word<span class=\"token punctuation\">,</span> W_embed<span class=\"token punctuation\">)</span>\n        embed_out <span class=\"token operator\">=</span> embed_out<span class=\"token punctuation\">.</span>reshape<span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span>embed_out<span class=\"token punctuation\">.</span>shape<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>embed_out<span class=\"token punctuation\">.</span>shape<span class=\"token punctuation\">[</span><span class=\"token number\">2</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n        h<span class=\"token punctuation\">,</span> rnn_cache <span class=\"token operator\">=</span> rnn_step_forward<span class=\"token punctuation\">(</span>embed_out<span class=\"token punctuation\">,</span> prev_h<span class=\"token punctuation\">,</span> Wx<span class=\"token punctuation\">,</span> Wh<span class=\"token punctuation\">,</span> b<span class=\"token punctuation\">)</span>\n        scores<span class=\"token punctuation\">,</span> affine_cache <span class=\"token operator\">=</span> affine_forward<span class=\"token punctuation\">(</span>h<span class=\"token punctuation\">,</span> W_vocab<span class=\"token punctuation\">,</span> b_vocab<span class=\"token punctuation\">)</span>\n        prev_word <span class=\"token operator\">=</span> captions<span class=\"token punctuation\">[</span><span class=\"token punctuation\">:</span><span class=\"token punctuation\">,</span> t<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> scores<span class=\"token punctuation\">.</span>argmax<span class=\"token punctuation\">(</span>axis<span class=\"token operator\">=</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span>\n        prev_word <span class=\"token operator\">=</span> prev_word<span class=\"token punctuation\">.</span>reshape<span class=\"token punctuation\">(</span>N<span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span>\n        prev_h <span class=\"token operator\">=</span> h\n    <span class=\"token keyword\">else</span><span class=\"token punctuation\">:</span>\n      prev_word <span class=\"token operator\">=</span> np<span class=\"token punctuation\">.</span>zeros<span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span>N<span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> dtype<span class=\"token operator\">=</span>np<span class=\"token punctuation\">.</span>int32<span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> self<span class=\"token punctuation\">.</span>_start\n      prev_h<span class=\"token punctuation\">,</span> affine_cache <span class=\"token operator\">=</span> affine_forward<span class=\"token punctuation\">(</span>features<span class=\"token punctuation\">,</span> W_proj<span class=\"token punctuation\">,</span> b_proj<span class=\"token punctuation\">)</span>\n      N<span class=\"token punctuation\">,</span> H <span class=\"token operator\">=</span> prev_h<span class=\"token punctuation\">.</span>shape\n      prev_c <span class=\"token operator\">=</span> np<span class=\"token punctuation\">.</span>zeros<span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span>N<span class=\"token punctuation\">,</span>H<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n      <span class=\"token keyword\">for</span> t <span class=\"token keyword\">in</span> <span class=\"token builtin\">xrange</span><span class=\"token punctuation\">(</span>max_length<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n        embed_out<span class=\"token punctuation\">,</span> embed_cache <span class=\"token operator\">=</span> word_embedding_forward<span class=\"token punctuation\">(</span>prev_word<span class=\"token punctuation\">,</span> W_embed<span class=\"token punctuation\">)</span>\n        embed_out <span class=\"token operator\">=</span> embed_out<span class=\"token punctuation\">.</span>reshape<span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span>embed_out<span class=\"token punctuation\">.</span>shape<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>embed_out<span class=\"token punctuation\">.</span>shape<span class=\"token punctuation\">[</span><span class=\"token number\">2</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n        h<span class=\"token punctuation\">,</span> c<span class=\"token punctuation\">,</span> lstm_cache <span class=\"token operator\">=</span> lstm_step_forward<span class=\"token punctuation\">(</span>embed_out<span class=\"token punctuation\">,</span> prev_c<span class=\"token punctuation\">,</span> prev_h<span class=\"token punctuation\">,</span> Wx<span class=\"token punctuation\">,</span> Wh<span class=\"token punctuation\">,</span> b<span class=\"token punctuation\">)</span>\n        scores<span class=\"token punctuation\">,</span> affine_cache <span class=\"token operator\">=</span> affine_forward<span class=\"token punctuation\">(</span>h<span class=\"token punctuation\">,</span> W_vocab<span class=\"token punctuation\">,</span> b_vocab<span class=\"token punctuation\">)</span>\n        prev_word <span class=\"token operator\">=</span> captions<span class=\"token punctuation\">[</span><span class=\"token punctuation\">:</span><span class=\"token punctuation\">,</span> t<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> scores<span class=\"token punctuation\">.</span>argmax<span class=\"token punctuation\">(</span>axis<span class=\"token operator\">=</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span>\n        prev_word <span class=\"token operator\">=</span> prev_word<span class=\"token punctuation\">.</span>reshape<span class=\"token punctuation\">(</span>N<span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span>\n        prev_h <span class=\"token operator\">=</span> h\n        prev_c <span class=\"token operator\">=</span> c\n\n    <span class=\"token comment\">############################################################################</span>\n    <span class=\"token comment\">#                             END OF YOUR CODE                             #</span>\n    <span class=\"token comment\">############################################################################</span>\n    <span class=\"token keyword\">return</span> captions</code></pre></div>\n<h3>Q2: Image Captioning with LSTMs</h3>\n<p>The IPython notebook <code class=\"language-text\">LSTM_Captioning.ipynb</code> walk through the implementation of Long-Short Term Memory (LSTM) RNNs, and apply them to image captioning on MS-COCO.</p>\n<p>The file <code class=\"language-text\">cs231n/rnn_layers.py</code> contains implementations of different layer types that are needed for LSTM. The file <code class=\"language-text\">cs231n/classifiers/rnn.py</code> contains implementations of CaptioningRNN class.</p>\n<p>run the following command</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">ipython notebook LSTM_Captioning.ipynb</code></pre></div>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 590px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/bc0cd97e8cecd39acb4ff83b762de01f/5754a/q2-1.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 82.43243243243244%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAQCAYAAAAWGF8bAAAACXBIWXMAAAsSAAALEgHS3X78AAABTElEQVQ4y63U22qDMBgA4DDYG+1+b7AWVrux59kuxh6iL7Cbzg62XrQgvSgdrSAD6+3AQ2nVoI3URtP98YCTOSbiD4kx0Y8/B0UIwjDw26mFsG37kXtI17GY9R2hxA1KyF92XfcBpRl6L6nHKGsQWSIFaJruqAChZvWnmYG0BO52ntgquNng0eFQgOmDzcEzQvwh7wgCRn9iddAq8Nzz0k3ZbhmNogJrCiKMcbIphDBKSDm7/9BKMM+Qr2EQwCitj1aCjuO85mAMx9TzfmN/LUEluN/vh9kg5TVMnWGcE7UOdhmEhpiBIQzzbYnC8BRBphFsUnIPo3F6rSz5p3efgL7vv7fxc4Cle0pASZIuLcu6Ngyjo6qqoGnrHm+bpt5VFPlWlrXeZPJxt1iowmz22V+tjO5yaXXGY+VmOl0L0L6az7/6g8HzBQIYtRnfOwxJKfKKoLAAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"q2 1\"\n        title=\"q2 1\"\n        src=\"/static/bc0cd97e8cecd39acb4ff83b762de01f/fcda8/q2-1.png\"\n        srcset=\"/static/bc0cd97e8cecd39acb4ff83b762de01f/12f09/q2-1.png 148w,\n/static/bc0cd97e8cecd39acb4ff83b762de01f/e4a3f/q2-1.png 295w,\n/static/bc0cd97e8cecd39acb4ff83b762de01f/fcda8/q2-1.png 590w,\n/static/bc0cd97e8cecd39acb4ff83b762de01f/5754a/q2-1.png 613w\"\n        sizes=\"(max-width: 590px) 100vw, 590px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span></p>\n<p>result</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 590px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/2937345fd96472e4bb8f9affce60cc93/3dd3e/q2-2.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 75%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAPCAYAAADkmO9VAAAACXBIWXMAAAsSAAALEgHS3X78AAAEaElEQVQ4y32TW0yTdwDFP0Xk5mfAcWtkIIIymFWoSlsFWqQCFqG0/cqgQotMsaPcKliVUtksVKBSEYsDlQpRjIBykzhUnI7NTRJadzExezCLutVkl2x7nV//Zzz4up3kl/N0Xs7Joaj/1/K37rvEmiWWvcX3PxMr4nb4BCbl8uPTi8VqadYeqWCTQi/ZnF+dnaIoy9isPSDZpi4TJZcK14ept8RE7pNviS7W79+/r6OlTtFpqpSdMOwvbDZ8mGdpqhWVlzE8KiFpA20sUv1azShwUL4bmpxUtBYJ0V0qwlltNk6rxWhVCFAreR8KXhw0O7kYvPkYc/e/wq1BC0b7LbhgM8HabIBmn+J76tFvoOdn5z3naithrdjDNuorSHOZivRXZhNHpZScrVITW5WGHD+gJaq0rUS2NYlcmnhKph++JDec7d5r58ykx2J802TQoYTJc1PFGw7Sdx7/6Rl7/ArKgkKvUiYlguQU0qzKIAPVMmL/qJRYGhuIMDObZIkLCMPfQmz2YTL62XNypddCnO0NpNVYzeor1CjIFbmp8fsv6Mm7rz1PfgGymVJvGEVhR0gASoSJGKuTou2DdGjkheCsfReHGSWaCySoZgphsY2jz96GLlMN6qsOscXKAqQLkt3Ud3+Dnpz/wzM19xoXnFPeQj4XNflp0CnEOFYiwEVrDbpsneBuFyCOsxZZaRkwH2tGr+08hlsNOK/bi080uay2cBe2Jye4qdGJl/TcU3gGrrshE6R65ZnbIEjlQ5aZgT2SZBw5ooJ5aRiNlI/MlCR0dZzBTK8NX3/agsWhTsz2n8F0i4G1G6qQk5PvppzjP9G3XfD0T/6IjKw8b0etFiMmNe6012PEYUdnWxvsRh0etNdipkWHIedVXLl8A5OTc/jym2/xcPEVTvXdY8XKQzC0Nbmpvonf6ekFr2fK9QabeOleU4MJP7gWsTDcB9f1i7h34SSuHZZj0GKAo8cBfZ0Ru3ZLcUBngP3iTVQZT4GbIWNj4hORJk53U0MzL2hjx5SnrPEyQjmx3lX0ahyvr8HttgrcM5dj1qTBlFWPif5TcM0/wKSpHHWyHRAmxoATQmPpG+CEh7Lh4Rz4+QW5qahoLh0WJ/IEr5dg9RqONyLYnwTTNJErVOTu/Qfk+cJD8sx5kiwsPiNfXD1PntwaIY+mR8nI8XLSZT5GeClbybrYODY4OAT06mA3RS+j6Mj1/J8juXJwUwRvirJS2I3x69iVvr7sZl4qe/q0g/28/yQ7M2BlL5k1rNNhZ+dnxtj5q93s2OwiW1quY8NCQ//xDwhCQGCQiwoJiabf4bz3V0SCFLxUERQSIRJjoxARHooAfz8EBq2CUlUEZ6cREz2NuPKxFr0NanRZrWiy9CBPUYqomFj4+q6Ev3/AMyoiVrxiTXjc3rBoftFG7k5GnZ/NKEU8JjIshImMjGCCAgOYpZ4Y7aFGZrjrKDPWfYRxHC1jegYnmPoTZxlxbgETtS5e6bPcp9jPz1/yL+GlPJA8AJy9AAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"q2 2\"\n        title=\"q2 2\"\n        src=\"/static/2937345fd96472e4bb8f9affce60cc93/fcda8/q2-2.png\"\n        srcset=\"/static/2937345fd96472e4bb8f9affce60cc93/12f09/q2-2.png 148w,\n/static/2937345fd96472e4bb8f9affce60cc93/e4a3f/q2-2.png 295w,\n/static/2937345fd96472e4bb8f9affce60cc93/fcda8/q2-2.png 590w,\n/static/2937345fd96472e4bb8f9affce60cc93/3dd3e/q2-2.png 595w\"\n        sizes=\"(max-width: 590px) 100vw, 590px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span>\n<span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 442px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/e6ae15790a41b9e874907fa779a6cca1/e03bf/q2-3.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 117.56756756756756%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,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'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"q2 3\"\n        title=\"q2 3\"\n        src=\"/static/e6ae15790a41b9e874907fa779a6cca1/e03bf/q2-3.png\"\n        srcset=\"/static/e6ae15790a41b9e874907fa779a6cca1/12f09/q2-3.png 148w,\n/static/e6ae15790a41b9e874907fa779a6cca1/e4a3f/q2-3.png 295w,\n/static/e6ae15790a41b9e874907fa779a6cca1/e03bf/q2-3.png 442w\"\n        sizes=\"(max-width: 442px) 100vw, 442px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span>\n<span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 590px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/879ffa3d21a298c9e586e420a9b4a85b/3dd3e/q2-4.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 82.43243243243244%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAQCAYAAAAWGF8bAAAACXBIWXMAAAsSAAALEgHS3X78AAAEpklEQVQ4y4WSaUyTBwCGP/dT/UKMiXEWFaGVgkChQlEsRwuCLYeI2MMCttyggLYI7eRQoCBt5FLACCgIiHITSwVvDoVPqEcz545syRLXZHOJyRK3ZH7f9+6Iv7fnz/v+eJL3z0sQ/8+aT0l+6mv+0zbtIz4z6xP2n68qUBYq49XHZFKVxXRObR+8qRzptik7NbW5AxMzx6Zn72ZN2Ga0ff0jmU6nQ1Faolcpk5NTY8KEKl2qTHlCp0w3Gkr2ES2dnWR3S+mvEz1G1Bdr8IUqDgN1Z7B4qxcvWkfxwTCFpdEZfP/yOb51foMfH0ziu7kltFh60VakhbXmDBrrz6KqyoCKymwnAYDsvTX109myYhSrDtAFkiDGnJ7AXDOXMcvnzjOvtc3sythtdnlyiP3h2TL77m4T89DSzIw0PWAom52xDc8wV7vHPnZ1DeJSa8MqoS+tI3WqTFdyrAy6pEimNlvBtlcWs+OXrOxX80vs49mn7LPFFfa6qZadH2xjqeErrL1az96yNrBfP33BvpyeZedGbfT8hB13R6ZXCQEvgJRHSlxhu4Pgw93G8L3ckSrfj1eON/iHP377HdT9aazOPcQT2zheLT/F64UFFB7LgWCXH6Tivcg9mkIbC3XQ52Q4iAiRmEySSlzhIULs9Pic2c3joOZMA3r6+9DccQFTszN4frsXYx1WLN+5h5/fffh3aOHJl8jMLIenhwd4HlvowF1eEAXxHYRKHk8ejpO6ZOHBaD1Xwzy6bcebFQd6rOUoz1Kgod6CB4PdGLI0YqC9C1pDCe6Pj+KXt+9xb2YJ6fJoyML86ZQYEY4mRTqIlNhwUhYpdjWezsWCfZZZXHRistsCk1aNnobLWF1yoK+9Hp3VBWgrzUKaKh1m03k4F5zo6RpAXmo8NJG7aHW0EMkRAsffT1xHlufpXHPDHTilUzByiRQ1p/KQkayEQVuEO7YbmLpZi6FGDVrjBaiQBKCr5SqudfRjangYL58s4lq9gS7TSJGfLHYQ1Sf05PjFOldjWR5sk/eZriuDqKm2Qp0kQbsxEebTBphL0nAjX4bpygzkxkehtrwCj8eGMNF/A4uP5jFnn6abSlJRkSV3EPN9l0lrfb6rtDgfJ/THmZQUJbKy87HDazskQh4ydflobdbj1Mk4GPNScDJHgzRFMA7G7saefYHwjdoMSYofbdYfQqXugIMwNR8hD+ZHu8pMxUjIFTMiWSCCIwTwFu6ATzgXTcO5uDJaiBxLOAqMYWgzGFBw+hDS1ALkVCUhsy4WimoRXXRJgfKigw4iWOJHhsi5bzNK1AhV8D8GxnHpbbwttF+oBy1K8KYPHw+lyyxJtMF8mK4wRNOP0qLoZwYl/bgyla6+UETrjEfoxOPCPxMLY5CREb1CbOK4kZ5cznvNkaPw9ebCX8xFkISHaK0v+CHu8OF5gsfbij1BPOgSQyEVbsXJMHdkx/jA128HPN09sIWzEdu2boYowP81cWh/1FpZhMgeEx7sCA3kL4sCvakQ0U6Kz99OuZFu1Pq1aym3deupDSRJbdq4geJwOBTX35va6eNFCfieVKjAi4oV+S4ligOccXv9rv8FdvuWZAvSsmcAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"q2 4\"\n        title=\"q2 4\"\n        src=\"/static/879ffa3d21a298c9e586e420a9b4a85b/fcda8/q2-4.png\"\n        srcset=\"/static/879ffa3d21a298c9e586e420a9b4a85b/12f09/q2-4.png 148w,\n/static/879ffa3d21a298c9e586e420a9b4a85b/e4a3f/q2-4.png 295w,\n/static/879ffa3d21a298c9e586e420a9b4a85b/fcda8/q2-4.png 590w,\n/static/879ffa3d21a298c9e586e420a9b4a85b/3dd3e/q2-4.png 595w\"\n        sizes=\"(max-width: 590px) 100vw, 590px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span>\n<span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 590px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/3c91bcb587d44182d7d6d050f6f72242/1568e/q2-5.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 50%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAYAAAC0VX7mAAAACXBIWXMAAAsSAAALEgHS3X78AAACqElEQVQoz2XSTUzTYBgH8Dkik9iiBwQSPcLFREEPxhhikEEwHBRCvMCGxKBLIJEQBwGHBCMQCFpHQCRRIozh2EfXbu3Kvtpu3cbGMEA2vXn04NmLhm57bBtwB5s8eT/S/y/vl0qlUp2VCpGrtLQUqai4cA5B0WoELa9EUUSq8ioEQS8iCHJJo9FUnikrq7paX1dlHDZWt3d0nJdyqFqtlvPosaUqabzTfFruWG34TZzcPnQRTIak/BkPHch6qMBXwruddRG+rJtkMjjhyywtr2b1Dw2HpomZ79K8Vs5qW+5qZEvuqwDglNxSDNfMRVPARZMgJPYgntxXWl5IQiSWBoZLQVf3E6ipvQ6tbZ1AeINAUsFOOfvj5y+16uQjvAFl4PPzTYGwAJyQyrGRVC7MJfIsv5PnhN08H0vn348P5fQNdTltY0uO3ub+SP+A1eZuP95dyT8wyAoK6A9FtJHYLjBMsBCNxgvpg2+ws7sP4XAU7OY5IOdGwdyvg1fGp0D5QkcfVq2w5aI75OxnO1kEQydggNXGUgdg6m4rPGu9VVhfXIaPC0vw1jQOljfzMGMcgQm9DmaGR+Dl5PSRdL5gc3oV0ObwFEEuklBAjo9pI0IKzNNThZ76y4W+240w+qgP5kzPYaBHB7OmF0A43ODCveAkfEchfgeklSmg3UUVQbP5nQJi2GLT8tIKWDZs4tTggDjWqxPnDV1i740a0TQ0KPKJL6KXYUUPHRLdHv9v6UJksP2/LeNuSgEdTrKV4+PAsgKM9T+Gew3XYLLnPljnZ8HvC0KITwLj50G6EJBA8IdjsLbheCBn162OIhhmBeXZCPF0LYF7Fkg3jZkMeszQ3YkFhD0sHN/D6ACPeeggJr0IzIHT2KadeG3ZdK58smxdkbNrG1vKov4CRDd9gAbwGuIAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"q2 5\"\n        title=\"q2 5\"\n        src=\"/static/3c91bcb587d44182d7d6d050f6f72242/fcda8/q2-5.png\"\n        srcset=\"/static/3c91bcb587d44182d7d6d050f6f72242/12f09/q2-5.png 148w,\n/static/3c91bcb587d44182d7d6d050f6f72242/e4a3f/q2-5.png 295w,\n/static/3c91bcb587d44182d7d6d050f6f72242/fcda8/q2-5.png 590w,\n/static/3c91bcb587d44182d7d6d050f6f72242/efc66/q2-5.png 885w,\n/static/3c91bcb587d44182d7d6d050f6f72242/1568e/q2-5.png 892w\"\n        sizes=\"(max-width: 590px) 100vw, 590px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span></p>\n<p>code: in <code class=\"language-text\">cs231n/rnn_layers.py</code></p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token keyword\">def</span> <span class=\"token function\">rnn_step_forward</span><span class=\"token punctuation\">(</span>x<span class=\"token punctuation\">,</span> prev_h<span class=\"token punctuation\">,</span> Wx<span class=\"token punctuation\">,</span> Wh<span class=\"token punctuation\">,</span> b<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n  <span class=\"token triple-quoted-string string\">\"\"\"\n  Run the forward pass for a single timestep of a vanilla RNN that uses a tanh\n  activation function.\n\n  The input data has dimension D, the hidden state has dimension H, and we use\n  a minibatch size of N.\n\n  Inputs:\n  - x: Input data for this timestep, of shape (N, D).\n  - prev_h: Hidden state from previous timestep, of shape (N, H)\n  - Wx: Weight matrix for input-to-hidden connections, of shape (D, H)\n  - Wh: Weight matrix for hidden-to-hidden connections, of shape (H, H)\n  - b: Biases of shape (H,)\n\n  Returns a tuple of:\n  - next_h: Next hidden state, of shape (N, H)\n  - cache: Tuple of values needed for the backward pass.\n  \"\"\"</span>\n  next_h<span class=\"token punctuation\">,</span> cache <span class=\"token operator\">=</span> <span class=\"token boolean\">None</span><span class=\"token punctuation\">,</span> <span class=\"token boolean\">None</span>\n  <span class=\"token comment\">##############################################################################</span>\n  <span class=\"token comment\"># TODO: Implement a single forward step for the vanilla RNN. Store the next  #</span>\n  <span class=\"token comment\"># hidden state and any values you need for the backward pass in the next_h   #</span>\n  <span class=\"token comment\"># and cache variables respectively.                                          #</span>\n  <span class=\"token comment\">##############################################################################</span>\n\n  next_h <span class=\"token operator\">=</span> np<span class=\"token punctuation\">.</span>tanh<span class=\"token punctuation\">(</span>np<span class=\"token punctuation\">.</span>dot<span class=\"token punctuation\">(</span>x<span class=\"token punctuation\">,</span> Wx<span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> np<span class=\"token punctuation\">.</span>dot<span class=\"token punctuation\">(</span>prev_h<span class=\"token punctuation\">,</span> Wh<span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> b<span class=\"token punctuation\">)</span>\n\n  cache <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span>x<span class=\"token punctuation\">,</span> prev_h<span class=\"token punctuation\">,</span> Wx<span class=\"token punctuation\">,</span> Wh<span class=\"token punctuation\">,</span> next_h<span class=\"token punctuation\">)</span>\n  <span class=\"token comment\">##############################################################################</span>\n  <span class=\"token comment\">#                               END OF YOUR CODE                             #</span>\n  <span class=\"token comment\">##############################################################################</span>\n  <span class=\"token keyword\">return</span> next_h<span class=\"token punctuation\">,</span> cache</code></pre></div>\n<p>in <code class=\"language-text\">cs231n/rnn_layers.py</code></p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token keyword\">def</span> <span class=\"token function\">rnn_step_backward</span><span class=\"token punctuation\">(</span>dnext_h<span class=\"token punctuation\">,</span> cache<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n  <span class=\"token triple-quoted-string string\">\"\"\"\n  Backward pass for a single timestep of a vanilla RNN.\n\n  Inputs:\n  - dnext_h: Gradient of loss with respect to next hidden state\n  - cache: Cache object from the forward pass\n\n  Returns a tuple of:\n  - dx: Gradients of input data, of shape (N, D)\n  - dprev_h: Gradients of previous hidden state, of shape (N, H)\n  - dWx: Gradients of input-to-hidden weights, of shape (N, H)\n  - dWh: Gradients of hidden-to-hidden weights, of shape (H, H)\n  - db: Gradients of bias vector, of shape (H,)\n  \"\"\"</span>\n  dx<span class=\"token punctuation\">,</span> dprev_h<span class=\"token punctuation\">,</span> dWx<span class=\"token punctuation\">,</span> dWh<span class=\"token punctuation\">,</span> db <span class=\"token operator\">=</span> <span class=\"token boolean\">None</span><span class=\"token punctuation\">,</span> <span class=\"token boolean\">None</span><span class=\"token punctuation\">,</span> <span class=\"token boolean\">None</span><span class=\"token punctuation\">,</span> <span class=\"token boolean\">None</span><span class=\"token punctuation\">,</span> <span class=\"token boolean\">None</span>\n  <span class=\"token comment\">##############################################################################</span>\n  <span class=\"token comment\"># TODO: Implement the backward pass for a single step of a vanilla RNN.      #</span>\n  <span class=\"token comment\">#                                                                            #</span>\n  <span class=\"token comment\"># HINT: For the tanh function, you can compute the local derivative in terms #</span>\n  <span class=\"token comment\"># of the output value from tanh.                                             #</span>\n  <span class=\"token comment\">##############################################################################</span>\n\n  x<span class=\"token punctuation\">,</span> prev_h<span class=\"token punctuation\">,</span> Wx<span class=\"token punctuation\">,</span> Wh<span class=\"token punctuation\">,</span> next_h <span class=\"token operator\">=</span> cache\n\n  dt <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token number\">1</span> <span class=\"token operator\">-</span> next_h <span class=\"token operator\">**</span> <span class=\"token number\">2</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">*</span> dnext_h\n  dx <span class=\"token operator\">=</span> np<span class=\"token punctuation\">.</span>dot<span class=\"token punctuation\">(</span>dt<span class=\"token punctuation\">,</span> np<span class=\"token punctuation\">.</span>transpose<span class=\"token punctuation\">(</span>Wx<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n  dprev_h <span class=\"token operator\">=</span> np<span class=\"token punctuation\">.</span>dot<span class=\"token punctuation\">(</span>dt<span class=\"token punctuation\">,</span> np<span class=\"token punctuation\">.</span>transpose<span class=\"token punctuation\">(</span>Wh<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n  dWx <span class=\"token operator\">=</span> np<span class=\"token punctuation\">.</span>dot<span class=\"token punctuation\">(</span>np<span class=\"token punctuation\">.</span>transpose<span class=\"token punctuation\">(</span>x<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> dt<span class=\"token punctuation\">)</span>\n  dWh <span class=\"token operator\">=</span> np<span class=\"token punctuation\">.</span>dot<span class=\"token punctuation\">(</span>np<span class=\"token punctuation\">.</span>transpose<span class=\"token punctuation\">(</span>prev_h<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> dt<span class=\"token punctuation\">)</span>\n  db <span class=\"token operator\">=</span> np<span class=\"token punctuation\">.</span><span class=\"token builtin\">sum</span><span class=\"token punctuation\">(</span>dt<span class=\"token punctuation\">,</span> axis<span class=\"token operator\">=</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span>\n\n  <span class=\"token comment\">##############################################################################</span>\n  <span class=\"token comment\">#                               END OF YOUR CODE                             #</span>\n  <span class=\"token comment\">##############################################################################</span>\n  <span class=\"token keyword\">return</span> dx<span class=\"token punctuation\">,</span> dprev_h<span class=\"token punctuation\">,</span> dWx<span class=\"token punctuation\">,</span> dWh<span class=\"token punctuation\">,</span> db</code></pre></div>\n<p>in <code class=\"language-text\">cs231n/rnn_layers.py</code></p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token keyword\">def</span> <span class=\"token function\">rnn_forward</span><span class=\"token punctuation\">(</span>x<span class=\"token punctuation\">,</span> h0<span class=\"token punctuation\">,</span> Wx<span class=\"token punctuation\">,</span> Wh<span class=\"token punctuation\">,</span> b<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n  <span class=\"token triple-quoted-string string\">\"\"\"\n  Run a vanilla RNN forward on an entire sequence of data. We assume an input\n  sequence composed of T vectors, each of dimension D. The RNN uses a hidden\n  size of H, and we work over a minibatch containing N sequences. After running\n  the RNN forward, we return the hidden states for all timesteps.\n\n  Inputs:\n  - x: Input data for the entire timeseries, of shape (N, T, D).\n  - h0: Initial hidden state, of shape (N, H)\n  - Wx: Weight matrix for input-to-hidden connections, of shape (D, H)\n  - Wh: Weight matrix for hidden-to-hidden connections, of shape (H, H)\n  - b: Biases of shape (H,)\n\n  Returns a tuple of:\n  - h: Hidden states for the entire timeseries, of shape (N, T, H).\n  - cache: Values needed in the backward pass\n  \"\"\"</span>\n  h<span class=\"token punctuation\">,</span> cache <span class=\"token operator\">=</span> <span class=\"token boolean\">None</span><span class=\"token punctuation\">,</span> <span class=\"token boolean\">None</span>\n  <span class=\"token comment\">##############################################################################</span>\n  <span class=\"token comment\"># TODO: Implement forward pass for a vanilla RNN running on a sequence of    #</span>\n  <span class=\"token comment\"># input data. You should use the rnn_step_forward function that you defined  #</span>\n  <span class=\"token comment\"># above.                                                                     #</span>\n  <span class=\"token comment\">##############################################################################</span>\n\n  N<span class=\"token punctuation\">,</span> T<span class=\"token punctuation\">,</span> D <span class=\"token operator\">=</span> x<span class=\"token punctuation\">.</span>shape\n  N<span class=\"token punctuation\">,</span> H <span class=\"token operator\">=</span> h0<span class=\"token punctuation\">.</span>shape\n  h <span class=\"token operator\">=</span> np<span class=\"token punctuation\">.</span>zeros<span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span>N<span class=\"token punctuation\">,</span> T<span class=\"token punctuation\">,</span> H<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n  cache <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span>\n  prev_h <span class=\"token operator\">=</span> h0\n  <span class=\"token keyword\">for</span> i <span class=\"token keyword\">in</span> <span class=\"token builtin\">xrange</span><span class=\"token punctuation\">(</span>T<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    prev_h<span class=\"token punctuation\">,</span> _cache <span class=\"token operator\">=</span> rnn_step_forward<span class=\"token punctuation\">(</span>x<span class=\"token punctuation\">[</span><span class=\"token punctuation\">:</span><span class=\"token punctuation\">,</span> i<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">:</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> prev_h<span class=\"token punctuation\">,</span> Wx<span class=\"token punctuation\">,</span> Wh<span class=\"token punctuation\">,</span> b<span class=\"token punctuation\">)</span>\n    cache<span class=\"token punctuation\">.</span>append<span class=\"token punctuation\">(</span>_cache<span class=\"token punctuation\">)</span>\n    h<span class=\"token punctuation\">[</span><span class=\"token punctuation\">:</span><span class=\"token punctuation\">,</span> i<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">:</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> prev_h\n\n  <span class=\"token comment\">##############################################################################</span>\n  <span class=\"token comment\">#                               END OF YOUR CODE                             #</span>\n  <span class=\"token comment\">##############################################################################</span>\n  <span class=\"token keyword\">return</span> h<span class=\"token punctuation\">,</span> cache</code></pre></div>\n<p>in <code class=\"language-text\">cs231n/rnn_layers.py</code></p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token keyword\">def</span> <span class=\"token function\">rnn_backward</span><span class=\"token punctuation\">(</span>dh<span class=\"token punctuation\">,</span> cache<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n  <span class=\"token triple-quoted-string string\">\"\"\"\n  Compute the backward pass for a vanilla RNN over an entire sequence of data.\n\n  Inputs:\n  - dh: Upstream gradients of all hidden states, of shape (N, T, H)\n\n  Returns a tuple of:\n  - dx: Gradient of inputs, of shape (N, T, D)\n  - dh0: Gradient of initial hidden state, of shape (N, H)\n  - dWx: Gradient of input-to-hidden weights, of shape (D, H)\n  - dWh: Gradient of hidden-to-hidden weights, of shape (H, H)\n  - db: Gradient of biases, of shape (H,)\n  \"\"\"</span>\n  dx<span class=\"token punctuation\">,</span> dh0<span class=\"token punctuation\">,</span> dWx<span class=\"token punctuation\">,</span> dWh<span class=\"token punctuation\">,</span> db <span class=\"token operator\">=</span> <span class=\"token boolean\">None</span><span class=\"token punctuation\">,</span> <span class=\"token boolean\">None</span><span class=\"token punctuation\">,</span> <span class=\"token boolean\">None</span><span class=\"token punctuation\">,</span> <span class=\"token boolean\">None</span><span class=\"token punctuation\">,</span> <span class=\"token boolean\">None</span>\n  <span class=\"token comment\">##############################################################################</span>\n  <span class=\"token comment\"># TODO: Implement the backward pass for a vanilla RNN running an entire      #</span>\n  <span class=\"token comment\"># sequence of data. You should use the rnn_step_backward function that you   #</span>\n  <span class=\"token comment\"># defined above.                                                             #</span>\n  <span class=\"token comment\">##############################################################################</span>\n\n  N<span class=\"token punctuation\">,</span> T<span class=\"token punctuation\">,</span> H <span class=\"token operator\">=</span> dh<span class=\"token punctuation\">.</span>shape\n  N<span class=\"token punctuation\">,</span> D <span class=\"token operator\">=</span> cache<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>shape\n  dx <span class=\"token operator\">=</span> np<span class=\"token punctuation\">.</span>zeros<span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span>N<span class=\"token punctuation\">,</span> T<span class=\"token punctuation\">,</span> D<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n  dh0 <span class=\"token operator\">=</span> np<span class=\"token punctuation\">.</span>zeros<span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span>N<span class=\"token punctuation\">,</span> H<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n  dWx <span class=\"token operator\">=</span> np<span class=\"token punctuation\">.</span>zeros<span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span>D<span class=\"token punctuation\">,</span> H<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n  dWh <span class=\"token operator\">=</span> np<span class=\"token punctuation\">.</span>zeros<span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span>H<span class=\"token punctuation\">,</span> H<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n  db <span class=\"token operator\">=</span> np<span class=\"token punctuation\">.</span>zeros<span class=\"token punctuation\">(</span>H<span class=\"token punctuation\">)</span>\n  dprevh<span class=\"token operator\">=</span> np<span class=\"token punctuation\">.</span>zeros<span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span>N<span class=\"token punctuation\">,</span> H<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n  <span class=\"token keyword\">for</span> i <span class=\"token keyword\">in</span> <span class=\"token builtin\">xrange</span><span class=\"token punctuation\">(</span>T <span class=\"token operator\">-</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    t_dx<span class=\"token punctuation\">,</span> t_dprevh<span class=\"token punctuation\">,</span> t_dWx<span class=\"token punctuation\">,</span> t_dWh<span class=\"token punctuation\">,</span> t_db <span class=\"token operator\">=</span> rnn_step_backward<span class=\"token punctuation\">(</span>dh<span class=\"token punctuation\">[</span><span class=\"token punctuation\">:</span><span class=\"token punctuation\">,</span>i<span class=\"token punctuation\">,</span><span class=\"token punctuation\">:</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">+</span> dprevh<span class=\"token punctuation\">,</span> cache<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>\n    dx<span class=\"token punctuation\">[</span><span class=\"token punctuation\">:</span><span class=\"token punctuation\">,</span>i<span class=\"token punctuation\">,</span><span class=\"token punctuation\">:</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> t_dx\n    dWx <span class=\"token operator\">+=</span> t_dWx\n    dWh <span class=\"token operator\">+=</span> t_dWh\n    db <span class=\"token operator\">+=</span> t_db\n    dprevh <span class=\"token operator\">=</span> t_dprevh\n  dh0 <span class=\"token operator\">=</span> dprevh\n\n  <span class=\"token comment\">##############################################################################</span>\n  <span class=\"token comment\">#                               END OF YOUR CODE                             #</span>\n  <span class=\"token comment\">##############################################################################</span>\n  <span class=\"token keyword\">return</span> dx<span class=\"token punctuation\">,</span> dh0<span class=\"token punctuation\">,</span> dWx<span class=\"token punctuation\">,</span> dWh<span class=\"token punctuation\">,</span> db</code></pre></div>\n<p>in <code class=\"language-text\">cs231n/rnn_layers.py</code></p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token keyword\">def</span> <span class=\"token function\">word_embedding_forward</span><span class=\"token punctuation\">(</span>x<span class=\"token punctuation\">,</span> W<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n  <span class=\"token triple-quoted-string string\">\"\"\"\n  Forward pass for word embeddings. We operate on minibatches of size N where\n  each sequence has length T. We assume a vocabulary of V words, assigning each\n  to a vector of dimension D.\n\n  Inputs:\n  - x: Integer array of shape (N, T) giving indices of words. Each element idx\n    of x muxt be in the range 0 &lt;= idx &lt; V.\n  - W: Weight matrix of shape (V, D) giving word vectors for all words.\n\n  Returns a tuple of:\n  - out: Array of shape (N, T, D) giving word vectors for all input words.\n  - cache: Values needed for the backward pass\n  \"\"\"</span>\n  out<span class=\"token punctuation\">,</span> cache <span class=\"token operator\">=</span> <span class=\"token boolean\">None</span><span class=\"token punctuation\">,</span> <span class=\"token boolean\">None</span>\n  <span class=\"token comment\">##############################################################################</span>\n  <span class=\"token comment\"># TODO: Implement the forward pass for word embeddings.                      #</span>\n  <span class=\"token comment\">#                                                                            #</span>\n  <span class=\"token comment\"># HINT: This should be very simple.                                          #</span>\n  <span class=\"token comment\">##############################################################################</span>\n\n  N<span class=\"token punctuation\">,</span> T <span class=\"token operator\">=</span> x<span class=\"token punctuation\">.</span>shape\n  V<span class=\"token punctuation\">,</span> D <span class=\"token operator\">=</span> W<span class=\"token punctuation\">.</span>shape\n  out <span class=\"token operator\">=</span> np<span class=\"token punctuation\">.</span>zeros<span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span>N<span class=\"token punctuation\">,</span> T<span class=\"token punctuation\">,</span> D<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n  <span class=\"token keyword\">for</span> i <span class=\"token keyword\">in</span> <span class=\"token builtin\">xrange</span><span class=\"token punctuation\">(</span>N<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    <span class=\"token keyword\">for</span> j <span class=\"token keyword\">in</span> <span class=\"token builtin\">xrange</span><span class=\"token punctuation\">(</span>T<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n      out<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">,</span> j<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> W<span class=\"token punctuation\">[</span>x<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">,</span> j<span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span>\n\n  cache <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span>x<span class=\"token punctuation\">,</span> W<span class=\"token punctuation\">,</span> out<span class=\"token punctuation\">)</span>\n\n  <span class=\"token comment\">##############################################################################</span>\n  <span class=\"token comment\">#                               END OF YOUR CODE                             #</span>\n  <span class=\"token comment\">##############################################################################</span>\n  <span class=\"token keyword\">return</span> out<span class=\"token punctuation\">,</span> cache</code></pre></div>\n<p>in <code class=\"language-text\">cs231n/rnn_layers.py</code></p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token keyword\">def</span> <span class=\"token function\">word_embedding_backward</span><span class=\"token punctuation\">(</span>dout<span class=\"token punctuation\">,</span> cache<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n  <span class=\"token triple-quoted-string string\">\"\"\"\n  Backward pass for word embeddings. We cannot back-propagate into the words\n  since they are integers, so we only return gradient for the word embedding\n  matrix.\n\n  HINT: Look up the function np.add.at\n\n  Inputs:\n  - dout: Upstream gradients of shape (N, T, D)\n  - cache: Values from the forward pass\n\n  Returns:\n  - dW: Gradient of word embedding matrix, of shape (V, D).\n  \"\"\"</span>\n  dW <span class=\"token operator\">=</span> <span class=\"token boolean\">None</span>\n  <span class=\"token comment\">##############################################################################</span>\n  <span class=\"token comment\"># TODO: Implement the backward pass for word embeddings.                     #</span>\n  <span class=\"token comment\">#                                                                            #</span>\n  <span class=\"token comment\"># HINT: Look up the function np.add.at                                       #</span>\n  <span class=\"token comment\">##############################################################################</span>\n\n  x<span class=\"token punctuation\">,</span> W<span class=\"token punctuation\">,</span> o <span class=\"token operator\">=</span> cache\n  dW <span class=\"token operator\">=</span> np<span class=\"token punctuation\">.</span>zeros<span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span>W<span class=\"token punctuation\">.</span>shape<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> dout<span class=\"token punctuation\">.</span>shape<span class=\"token punctuation\">[</span><span class=\"token number\">2</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n  np<span class=\"token punctuation\">.</span>add<span class=\"token punctuation\">.</span>at<span class=\"token punctuation\">(</span>dW<span class=\"token punctuation\">,</span> x<span class=\"token punctuation\">,</span> dout<span class=\"token punctuation\">)</span>\n\n  <span class=\"token comment\">##############################################################################</span>\n  <span class=\"token comment\">#                               END OF YOUR CODE                             #</span>\n  <span class=\"token comment\">##############################################################################</span>\n  <span class=\"token keyword\">return</span> dW</code></pre></div>\n<p>in <code class=\"language-text\">cs231n/rnn_layers.py</code></p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token keyword\">def</span> <span class=\"token function\">lstm_step_forward</span><span class=\"token punctuation\">(</span>x<span class=\"token punctuation\">,</span> prev_h<span class=\"token punctuation\">,</span> prev_c<span class=\"token punctuation\">,</span> Wx<span class=\"token punctuation\">,</span> Wh<span class=\"token punctuation\">,</span> b<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n  <span class=\"token triple-quoted-string string\">\"\"\"\n  Forward pass for a single timestep of an LSTM.\n\n  The input data has dimension D, the hidden state has dimension H, and we use\n  a minibatch size of N.\n\n  Inputs:\n  - x: Input data, of shape (N, D)\n  - prev_h: Previous hidden state, of shape (N, H)\n  - prev_c: previous cell state, of shape (N, H)\n  - Wx: Input-to-hidden weights, of shape (D, 4H)\n  - Wh: Hidden-to-hidden weights, of shape (H, 4H)\n  - b: Biases, of shape (4H,)\n\n  Returns a tuple of:\n  - next_h: Next hidden state, of shape (N, H)\n  - next_c: Next cell state, of shape (N, H)\n  - cache: Tuple of values needed for backward pass.\n  \"\"\"</span>\n  next_h<span class=\"token punctuation\">,</span> next_c<span class=\"token punctuation\">,</span> cache <span class=\"token operator\">=</span> <span class=\"token boolean\">None</span><span class=\"token punctuation\">,</span> <span class=\"token boolean\">None</span><span class=\"token punctuation\">,</span> <span class=\"token boolean\">None</span>\n  <span class=\"token comment\">#############################################################################</span>\n  <span class=\"token comment\"># TODO: Implement the forward pass for a single timestep of an LSTM.        #</span>\n  <span class=\"token comment\"># You may want to use the numerically stable sigmoid implementation above.  #</span>\n  <span class=\"token comment\">#############################################################################</span>\n\n  N<span class=\"token punctuation\">,</span> H <span class=\"token operator\">=</span> prev_h<span class=\"token punctuation\">.</span>shape\n  a <span class=\"token operator\">=</span> np<span class=\"token punctuation\">.</span>dot<span class=\"token punctuation\">(</span>prev_h<span class=\"token punctuation\">,</span> Wh<span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> np<span class=\"token punctuation\">.</span>dot<span class=\"token punctuation\">(</span>x<span class=\"token punctuation\">,</span> Wx<span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> b\n  i <span class=\"token operator\">=</span> sigmoid<span class=\"token punctuation\">(</span>a<span class=\"token punctuation\">[</span><span class=\"token punctuation\">:</span><span class=\"token punctuation\">,</span><span class=\"token punctuation\">:</span>H<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>\n  f <span class=\"token operator\">=</span> sigmoid<span class=\"token punctuation\">(</span>a<span class=\"token punctuation\">[</span><span class=\"token punctuation\">:</span><span class=\"token punctuation\">,</span>H<span class=\"token punctuation\">:</span><span class=\"token number\">2</span><span class=\"token operator\">*</span>H<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>\n  o <span class=\"token operator\">=</span> sigmoid<span class=\"token punctuation\">(</span>a<span class=\"token punctuation\">[</span><span class=\"token punctuation\">:</span><span class=\"token punctuation\">,</span><span class=\"token number\">2</span><span class=\"token operator\">*</span>H<span class=\"token punctuation\">:</span><span class=\"token number\">3</span><span class=\"token operator\">*</span>H<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>\n  g <span class=\"token operator\">=</span> np<span class=\"token punctuation\">.</span>tanh<span class=\"token punctuation\">(</span>a<span class=\"token punctuation\">[</span><span class=\"token punctuation\">:</span><span class=\"token punctuation\">,</span><span class=\"token number\">3</span><span class=\"token operator\">*</span>H<span class=\"token punctuation\">:</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>\n  next_c <span class=\"token operator\">=</span> g<span class=\"token operator\">*</span>i <span class=\"token operator\">+</span> prev_c<span class=\"token operator\">*</span>f\n  next_h <span class=\"token operator\">=</span> np<span class=\"token punctuation\">.</span>tanh<span class=\"token punctuation\">(</span>next_c<span class=\"token punctuation\">)</span> <span class=\"token operator\">*</span> o\n  cache <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span>next_c<span class=\"token punctuation\">,</span> i<span class=\"token punctuation\">,</span> f<span class=\"token punctuation\">,</span> o<span class=\"token punctuation\">,</span> g<span class=\"token punctuation\">,</span> a<span class=\"token punctuation\">,</span> x<span class=\"token punctuation\">,</span> Wx<span class=\"token punctuation\">,</span> Wh<span class=\"token punctuation\">,</span> prev_h<span class=\"token punctuation\">,</span> prev_c<span class=\"token punctuation\">)</span>\n\n  <span class=\"token comment\">##############################################################################</span>\n  <span class=\"token comment\">#                               END OF YOUR CODE                             #</span>\n  <span class=\"token comment\">##############################################################################</span>\n\n  <span class=\"token keyword\">return</span> next_h<span class=\"token punctuation\">,</span> next_c<span class=\"token punctuation\">,</span> cache</code></pre></div>\n<p>in <code class=\"language-text\">cs231n/rnn_layers.py</code></p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token keyword\">def</span> <span class=\"token function\">lstm_step_backward</span><span class=\"token punctuation\">(</span>dnext_h<span class=\"token punctuation\">,</span> dnext_c<span class=\"token punctuation\">,</span> cache<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n  <span class=\"token triple-quoted-string string\">\"\"\"\n  Backward pass for a single timestep of an LSTM.\n\n  Inputs:\n  - dnext_h: Gradients of next hidden state, of shape (N, H)\n  - dnext_c: Gradients of next cell state, of shape (N, H)\n  - cache: Values from the forward pass\n\n  Returns a tuple of:\n  - dx: Gradient of input data, of shape (N, D)\n  - dprev_h: Gradient of previous hidden state, of shape (N, H)\n  - dprev_c: Gradient of previous cell state, of shape (N, H)\n  - dWx: Gradient of input-to-hidden weights, of shape (D, 4H)\n  - dWh: Gradient of hidden-to-hidden weights, of shape (H, 4H)\n  - db: Gradient of biases, of shape (4H,)\n  \"\"\"</span>\n  dx<span class=\"token punctuation\">,</span> dh<span class=\"token punctuation\">,</span> dc<span class=\"token punctuation\">,</span> dWx<span class=\"token punctuation\">,</span> dWh<span class=\"token punctuation\">,</span> db <span class=\"token operator\">=</span> <span class=\"token boolean\">None</span><span class=\"token punctuation\">,</span> <span class=\"token boolean\">None</span><span class=\"token punctuation\">,</span> <span class=\"token boolean\">None</span><span class=\"token punctuation\">,</span> <span class=\"token boolean\">None</span><span class=\"token punctuation\">,</span> <span class=\"token boolean\">None</span><span class=\"token punctuation\">,</span> <span class=\"token boolean\">None</span>\n  <span class=\"token comment\">#############################################################################</span>\n  <span class=\"token comment\"># TODO: Implement the backward pass for a single timestep of an LSTM.       #</span>\n  <span class=\"token comment\">#                                                                           #</span>\n  <span class=\"token comment\"># HINT: For sigmoid and tanh you can compute local derivatives in terms of  #</span>\n  <span class=\"token comment\"># the output value from the nonlinearity.                                   #</span>\n  <span class=\"token comment\">#############################################################################</span>\n\n  next_c<span class=\"token punctuation\">,</span> i<span class=\"token punctuation\">,</span> f<span class=\"token punctuation\">,</span> o<span class=\"token punctuation\">,</span> g<span class=\"token punctuation\">,</span> a<span class=\"token punctuation\">,</span> x<span class=\"token punctuation\">,</span> Wx<span class=\"token punctuation\">,</span> Wh<span class=\"token punctuation\">,</span> prev_h<span class=\"token punctuation\">,</span> prev_c <span class=\"token operator\">=</span> cache\n  dnext_c <span class=\"token operator\">=</span> dnext_c <span class=\"token operator\">+</span> <span class=\"token punctuation\">(</span>dnext_h<span class=\"token operator\">*</span>o<span class=\"token punctuation\">)</span> <span class=\"token operator\">*</span> <span class=\"token punctuation\">(</span><span class=\"token number\">1</span> <span class=\"token operator\">-</span> np<span class=\"token punctuation\">.</span>tanh<span class=\"token punctuation\">(</span>next_c<span class=\"token punctuation\">)</span><span class=\"token operator\">**</span><span class=\"token number\">2</span><span class=\"token punctuation\">)</span>\n  dprev_c <span class=\"token operator\">=</span> dnext_c<span class=\"token operator\">*</span>f\n  di <span class=\"token operator\">=</span> g<span class=\"token operator\">*</span>dnext_c\n  df <span class=\"token operator\">=</span> dnext_c<span class=\"token operator\">*</span>prev_c\n  do <span class=\"token operator\">=</span> np<span class=\"token punctuation\">.</span>tanh<span class=\"token punctuation\">(</span>next_c<span class=\"token punctuation\">)</span><span class=\"token operator\">*</span>dnext_h\n  dg <span class=\"token operator\">=</span> dnext_c<span class=\"token operator\">*</span>i\n  da <span class=\"token operator\">=</span> np<span class=\"token punctuation\">.</span>zeros<span class=\"token punctuation\">(</span>a<span class=\"token punctuation\">.</span>shape<span class=\"token punctuation\">)</span>\n  H <span class=\"token operator\">=</span> next_c<span class=\"token punctuation\">.</span>shape<span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span>\n  da<span class=\"token punctuation\">[</span><span class=\"token punctuation\">:</span><span class=\"token punctuation\">,</span><span class=\"token punctuation\">:</span>H<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> di<span class=\"token operator\">*</span>i<span class=\"token operator\">*</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token operator\">-</span>i<span class=\"token punctuation\">)</span>\n  da<span class=\"token punctuation\">[</span><span class=\"token punctuation\">:</span><span class=\"token punctuation\">,</span>H<span class=\"token punctuation\">:</span><span class=\"token number\">2</span><span class=\"token operator\">*</span>H<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> df<span class=\"token operator\">*</span>f<span class=\"token operator\">*</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token operator\">-</span>f<span class=\"token punctuation\">)</span>\n  da<span class=\"token punctuation\">[</span><span class=\"token punctuation\">:</span><span class=\"token punctuation\">,</span><span class=\"token number\">2</span><span class=\"token operator\">*</span>H<span class=\"token punctuation\">:</span><span class=\"token number\">3</span><span class=\"token operator\">*</span>H<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> do<span class=\"token operator\">*</span>o<span class=\"token operator\">*</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token operator\">-</span>o<span class=\"token punctuation\">)</span>\n  da<span class=\"token punctuation\">[</span><span class=\"token punctuation\">:</span><span class=\"token punctuation\">,</span><span class=\"token number\">3</span><span class=\"token operator\">*</span>H<span class=\"token punctuation\">:</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> dg<span class=\"token operator\">*</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token operator\">-</span>g<span class=\"token operator\">**</span><span class=\"token number\">2</span><span class=\"token punctuation\">)</span>\n  db <span class=\"token operator\">=</span> np<span class=\"token punctuation\">.</span><span class=\"token builtin\">sum</span><span class=\"token punctuation\">(</span>da<span class=\"token punctuation\">,</span> axis<span class=\"token operator\">=</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span>\n  dWx <span class=\"token operator\">=</span> np<span class=\"token punctuation\">.</span>dot<span class=\"token punctuation\">(</span>np<span class=\"token punctuation\">.</span>transpose<span class=\"token punctuation\">(</span>x<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> da<span class=\"token punctuation\">)</span>\n  dWh <span class=\"token operator\">=</span> np<span class=\"token punctuation\">.</span>dot<span class=\"token punctuation\">(</span>np<span class=\"token punctuation\">.</span>transpose<span class=\"token punctuation\">(</span>prev_h<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> da<span class=\"token punctuation\">)</span>\n  dx <span class=\"token operator\">=</span> np<span class=\"token punctuation\">.</span>dot<span class=\"token punctuation\">(</span>da<span class=\"token punctuation\">,</span> np<span class=\"token punctuation\">.</span>transpose<span class=\"token punctuation\">(</span>Wx<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n  dprev_h <span class=\"token operator\">=</span> np<span class=\"token punctuation\">.</span>dot<span class=\"token punctuation\">(</span>da<span class=\"token punctuation\">,</span> np<span class=\"token punctuation\">.</span>transpose<span class=\"token punctuation\">(</span>Wh<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n\n  <span class=\"token comment\">##############################################################################</span>\n  <span class=\"token comment\">#                               END OF YOUR CODE                             #</span>\n  <span class=\"token comment\">##############################################################################</span>\n\n  <span class=\"token keyword\">return</span> dx<span class=\"token punctuation\">,</span> dprev_h<span class=\"token punctuation\">,</span> dprev_c<span class=\"token punctuation\">,</span> dWx<span class=\"token punctuation\">,</span> dWh<span class=\"token punctuation\">,</span> db</code></pre></div>\n<p>in <code class=\"language-text\">cs231n/rnn_layers.py</code></p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token keyword\">def</span> <span class=\"token function\">lstm_forward</span><span class=\"token punctuation\">(</span>x<span class=\"token punctuation\">,</span> h0<span class=\"token punctuation\">,</span> Wx<span class=\"token punctuation\">,</span> Wh<span class=\"token punctuation\">,</span> b<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n  <span class=\"token triple-quoted-string string\">\"\"\"\n  Forward pass for an LSTM over an entire sequence of data. We assume an input\n  sequence composed of T vectors, each of dimension D. The LSTM uses a hidden\n  size of H, and we work over a minibatch containing N sequences. After running\n  the LSTM forward, we return the hidden states for all timesteps.\n\n  Note that the initial cell state is passed as input, but the initial cell\n  state is set to zero. Also note that the cell state is not returned; it is\n  an internal variable to the LSTM and is not accessed from outside.\n\n  Inputs:\n  - x: Input data of shape (N, T, D)\n  - h0: Initial hidden state of shape (N, H)\n  - Wx: Weights for input-to-hidden connections, of shape (D, 4H)\n  - Wh: Weights for hidden-to-hidden connections, of shape (H, 4H)\n  - b: Biases of shape (4H,)\n\n  Returns a tuple of:\n  - h: Hidden states for all timesteps of all sequences, of shape (N, T, H)\n  - cache: Values needed for the backward pass.\n  \"\"\"</span>\n  h<span class=\"token punctuation\">,</span> cache <span class=\"token operator\">=</span> <span class=\"token boolean\">None</span><span class=\"token punctuation\">,</span> <span class=\"token boolean\">None</span>\n  <span class=\"token comment\">#############################################################################</span>\n  <span class=\"token comment\"># TODO: Implement the forward pass for an LSTM over an entire timeseries.   #</span>\n  <span class=\"token comment\"># You should use the lstm_step_forward function that you just defined.      #</span>\n  <span class=\"token comment\">#############################################################################</span>\n\n  N<span class=\"token punctuation\">,</span> T<span class=\"token punctuation\">,</span> D <span class=\"token operator\">=</span> x<span class=\"token punctuation\">.</span>shape\n  N<span class=\"token punctuation\">,</span> H <span class=\"token operator\">=</span> h0<span class=\"token punctuation\">.</span>shape\n  h <span class=\"token operator\">=</span> np<span class=\"token punctuation\">.</span>zeros<span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span>N<span class=\"token punctuation\">,</span> T<span class=\"token punctuation\">,</span> H<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n  prev_h <span class=\"token operator\">=</span> h0\n  prev_c <span class=\"token operator\">=</span> np<span class=\"token punctuation\">.</span>zeros<span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span>N<span class=\"token punctuation\">,</span> H<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n  cache <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span>\n  <span class=\"token keyword\">for</span> t <span class=\"token keyword\">in</span> <span class=\"token builtin\">xrange</span><span class=\"token punctuation\">(</span>T<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    prev_h<span class=\"token punctuation\">,</span> prev_c<span class=\"token punctuation\">,</span> t_cache <span class=\"token operator\">=</span> lstm_step_forward<span class=\"token punctuation\">(</span>x<span class=\"token punctuation\">[</span><span class=\"token punctuation\">:</span><span class=\"token punctuation\">,</span>t<span class=\"token punctuation\">,</span><span class=\"token punctuation\">:</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>prev_h<span class=\"token punctuation\">,</span>prev_c<span class=\"token punctuation\">,</span>Wx<span class=\"token punctuation\">,</span>Wh<span class=\"token punctuation\">,</span>b<span class=\"token punctuation\">)</span>\n    h<span class=\"token punctuation\">[</span><span class=\"token punctuation\">:</span><span class=\"token punctuation\">,</span>t<span class=\"token punctuation\">,</span><span class=\"token punctuation\">:</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> prev_h\n    cache<span class=\"token punctuation\">.</span>append<span class=\"token punctuation\">(</span>t_cache<span class=\"token punctuation\">)</span>\n  cache <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span>cache<span class=\"token punctuation\">,</span> D<span class=\"token punctuation\">)</span>\n\n  <span class=\"token comment\">##############################################################################</span>\n  <span class=\"token comment\">#                               END OF YOUR CODE                             #</span>\n  <span class=\"token comment\">##############################################################################</span>\n\n  <span class=\"token keyword\">return</span> h<span class=\"token punctuation\">,</span> cache</code></pre></div>\n<p>in <code class=\"language-text\">cs231n/rnn_layers.py</code></p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token keyword\">def</span> <span class=\"token function\">lstm_backward</span><span class=\"token punctuation\">(</span>dh<span class=\"token punctuation\">,</span> cache<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n  <span class=\"token triple-quoted-string string\">\"\"\"\n  Backward pass for an LSTM over an entire sequence of data.]\n\n  Inputs:\n  - dh: Upstream gradients of hidden states, of shape (N, T, H)\n  - cache: Values from the forward pass\n\n  Returns a tuple of:\n  - dx: Gradient of input data of shape (N, T, D)\n  - dh0: Gradient of initial hidden state of shape (N, H)\n  - dWx: Gradient of input-to-hidden weight matrix of shape (D, 4H)\n  - dWh: Gradient of hidden-to-hidden weight matrix of shape (H, 4H)\n  - db: Gradient of biases, of shape (4H,)\n  \"\"\"</span>\n  dx<span class=\"token punctuation\">,</span> dh0<span class=\"token punctuation\">,</span> dWx<span class=\"token punctuation\">,</span> dWh<span class=\"token punctuation\">,</span> db <span class=\"token operator\">=</span> <span class=\"token boolean\">None</span><span class=\"token punctuation\">,</span> <span class=\"token boolean\">None</span><span class=\"token punctuation\">,</span> <span class=\"token boolean\">None</span><span class=\"token punctuation\">,</span> <span class=\"token boolean\">None</span><span class=\"token punctuation\">,</span> <span class=\"token boolean\">None</span>\n  <span class=\"token comment\">#############################################################################</span>\n  <span class=\"token comment\"># TODO: Implement the backward pass for an LSTM over an entire timeseries.  #</span>\n  <span class=\"token comment\"># You should use the lstm_step_backward function that you just defined.     #</span>\n  <span class=\"token comment\">#############################################################################</span>\n  N<span class=\"token punctuation\">,</span> T<span class=\"token punctuation\">,</span> H <span class=\"token operator\">=</span> dh<span class=\"token punctuation\">.</span>shape\n  cache<span class=\"token punctuation\">,</span> D <span class=\"token operator\">=</span> cache\n  dx <span class=\"token operator\">=</span> np<span class=\"token punctuation\">.</span>zeros<span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span>N<span class=\"token punctuation\">,</span> T<span class=\"token punctuation\">,</span> D<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n  dh0 <span class=\"token operator\">=</span> np<span class=\"token punctuation\">.</span>zeros<span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span>N<span class=\"token punctuation\">,</span> H<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n  dWx <span class=\"token operator\">=</span> np<span class=\"token punctuation\">.</span>zeros<span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span>D<span class=\"token punctuation\">,</span> <span class=\"token number\">4</span><span class=\"token operator\">*</span>H<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n  dWh <span class=\"token operator\">=</span> np<span class=\"token punctuation\">.</span>zeros<span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span>H<span class=\"token punctuation\">,</span> <span class=\"token number\">4</span><span class=\"token operator\">*</span>H<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n  db <span class=\"token operator\">=</span> np<span class=\"token punctuation\">.</span>zeros<span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token number\">4</span><span class=\"token operator\">*</span>H<span class=\"token punctuation\">,</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n  dprev_h <span class=\"token operator\">=</span> np<span class=\"token punctuation\">.</span>zeros<span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span>N<span class=\"token punctuation\">,</span> H<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n  dprev_c <span class=\"token operator\">=</span> np<span class=\"token punctuation\">.</span>zeros<span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span>N<span class=\"token punctuation\">,</span> H<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n  <span class=\"token keyword\">for</span> i <span class=\"token keyword\">in</span> <span class=\"token builtin\">xrange</span><span class=\"token punctuation\">(</span>T<span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    dx_i<span class=\"token punctuation\">,</span>dprev_h<span class=\"token punctuation\">,</span>dprev_c<span class=\"token punctuation\">,</span>dWx_i<span class=\"token punctuation\">,</span>dWh_i<span class=\"token punctuation\">,</span>db_i <span class=\"token operator\">=</span> lstm_step_backward<span class=\"token punctuation\">(</span>dh<span class=\"token punctuation\">[</span><span class=\"token punctuation\">:</span><span class=\"token punctuation\">,</span>i<span class=\"token punctuation\">,</span><span class=\"token punctuation\">:</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span>dprev_h<span class=\"token punctuation\">,</span>dprev_c<span class=\"token punctuation\">,</span>cache<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>\n    dx<span class=\"token punctuation\">[</span><span class=\"token punctuation\">:</span><span class=\"token punctuation\">,</span>i<span class=\"token punctuation\">,</span><span class=\"token punctuation\">:</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> dx_i\n    dWh <span class=\"token operator\">+=</span> dWh_i\n    dWx <span class=\"token operator\">+=</span> dWx_i\n    db <span class=\"token operator\">+=</span> db_i\n  dh0 <span class=\"token operator\">=</span> dprev_h\n\n  <span class=\"token comment\">##############################################################################</span>\n  <span class=\"token comment\">#                               END OF YOUR CODE                             #</span>\n  <span class=\"token comment\">##############################################################################</span>\n\n  <span class=\"token keyword\">return</span> dx<span class=\"token punctuation\">,</span> dh0<span class=\"token punctuation\">,</span> dWx<span class=\"token punctuation\">,</span> dWh<span class=\"token punctuation\">,</span> db</code></pre></div>","frontmatter":{"title":"cs231n: Practical Machine Learning Project 2","date":"November 10, 2016","description":"Option 1. Image Captioning using RNN and LSTM. ","tags":["Python","Machine learning","æœºå™¨å­¦ä¹ "]}}},"pageContext":{"slug":"/blogs/cs231n-Practical-Machine-Learning-Project-2/","previous":{"fields":{"slug":"/blogs/latent-semantic-indexing/"},"frontmatter":{"title":"å¯¹zhwikiæ•°æ®é›†è¿›è¡ŒLSIåˆ†æž (latent semantic indexing)"}},"next":{"fields":{"slug":"/blogs/an-attempt-to-playing-contra-with-machine-learning/"},"frontmatter":{"title":"An attempt to playing contra with machine learning"}}}}}