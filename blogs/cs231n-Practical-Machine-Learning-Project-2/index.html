<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><meta http-equiv="x-ua-compatible" content="ie=edge"/><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"/><style id="typography.js">html{font-family:sans-serif;-ms-text-size-adjust:100%;-webkit-text-size-adjust:100%}body{margin:0}article,aside,details,figcaption,figure,footer,header,main,menu,nav,section,summary{display:block}audio,canvas,progress,video{display:inline-block}audio:not([controls]){display:none;height:0}progress{vertical-align:baseline}[hidden],template{display:none}a{background-color:transparent;-webkit-text-decoration-skip:objects}a:active,a:hover{outline-width:0}abbr[title]{border-bottom:none;text-decoration:underline;text-decoration:underline dotted}b,strong{font-weight:inherit;font-weight:bolder}dfn{font-style:italic}h1{font-size:2em;margin:.67em 0}mark{background-color:#ff0;color:#000}small{font-size:80%}sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}sub{bottom:-.25em}sup{top:-.5em}img{border-style:none}svg:not(:root){overflow:hidden}code,kbd,pre,samp{font-family:monospace,monospace;font-size:1em}figure{margin:1em 40px}hr{box-sizing:content-box;height:0;overflow:visible}button,input,optgroup,select,textarea{font:inherit;margin:0}optgroup{font-weight:700}button,input{overflow:visible}button,select{text-transform:none}[type=reset],[type=submit],button,html [type=button]{-webkit-appearance:button}[type=button]::-moz-focus-inner,[type=reset]::-moz-focus-inner,[type=submit]::-moz-focus-inner,button::-moz-focus-inner{border-style:none;padding:0}[type=button]:-moz-focusring,[type=reset]:-moz-focusring,[type=submit]:-moz-focusring,button:-moz-focusring{outline:1px dotted ButtonText}fieldset{border:1px solid silver;margin:0 2px;padding:.35em .625em .75em}legend{box-sizing:border-box;color:inherit;display:table;max-width:100%;padding:0;white-space:normal}textarea{overflow:auto}[type=checkbox],[type=radio]{box-sizing:border-box;padding:0}[type=number]::-webkit-inner-spin-button,[type=number]::-webkit-outer-spin-button{height:auto}[type=search]{-webkit-appearance:textfield;outline-offset:-2px}[type=search]::-webkit-search-cancel-button,[type=search]::-webkit-search-decoration{-webkit-appearance:none}::-webkit-input-placeholder{color:inherit;opacity:.54}::-webkit-file-upload-button{-webkit-appearance:button;font:inherit}html{font:131.25%/1.5 'Crimson Text',serif;box-sizing:border-box;overflow-y:scroll;}*{box-sizing:inherit;}*:before{box-sizing:inherit;}*:after{box-sizing:inherit;}body{color:hsla(0,0%,0%,0.73);font-family:'Crimson Text',serif;font-weight:400;word-wrap:break-word;font-kerning:normal;-moz-font-feature-settings:"kern", "liga", "clig", "calt";-ms-font-feature-settings:"kern", "liga", "clig", "calt";-webkit-font-feature-settings:"kern", "liga", "clig", "calt";font-feature-settings:"kern", "liga", "clig", "calt";}img{max-width:100%;margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.5rem;}h1{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.5rem;color:hsla(0,0%,0%,0.9);font-family:'Rosario',sans-serif;font-weight:700;text-rendering:optimizeLegibility;font-size:2rem;line-height:1.1;}h2{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.5rem;color:hsla(0,0%,0%,0.9);font-family:'Rosario',sans-serif;font-weight:700;text-rendering:optimizeLegibility;font-size:1.51572rem;line-height:1.1;}h3{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.5rem;color:hsla(0,0%,0%,0.9);font-family:'Rosario',sans-serif;font-weight:700;text-rendering:optimizeLegibility;font-size:1.31951rem;line-height:1.1;}h4{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.5rem;color:hsla(0,0%,0%,0.9);font-family:'Rosario',sans-serif;font-weight:700;text-rendering:optimizeLegibility;font-size:1rem;line-height:1.1;}h5{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.5rem;color:hsla(0,0%,0%,0.9);font-family:'Rosario',sans-serif;font-weight:700;text-rendering:optimizeLegibility;font-size:0.87055rem;line-height:1.1;}h6{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.5rem;color:hsla(0,0%,0%,0.9);font-family:'Rosario',sans-serif;font-weight:700;text-rendering:optimizeLegibility;font-size:0.81225rem;line-height:1.1;}hgroup{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.5rem;}ul{margin-left:1.5rem;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.5rem;list-style-position:outside;list-style-image:none;}ol{margin-left:1.5rem;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.5rem;list-style-position:outside;list-style-image:none;}dl{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.5rem;}dd{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.5rem;}p{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.5rem;}figure{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.5rem;}pre{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.5rem;font-size:0.85rem;line-height:1.5rem;}table{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.5rem;font-size:1rem;line-height:1.5rem;border-collapse:collapse;width:100%;}fieldset{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.5rem;}blockquote{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:1.21875rem;padding-right:0;padding-top:0;margin-bottom:1.5rem;font-size:1.1487rem;line-height:1.5rem;border-left:0.28125rem solid #ff5700;color:hsla(0,0%,0%,0.59);font-style:italic;}form{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.5rem;}noscript{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.5rem;}iframe{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.5rem;}hr{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:calc(1.5rem - 1px);background:hsla(0,0%,0%,0.2);border:none;height:1px;}address{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.5rem;}b{font-weight:600;}strong{font-weight:600;}dt{font-weight:600;}th{font-weight:600;}li{margin-bottom:calc(1.5rem / 2);}ol li{padding-left:0;}ul li{padding-left:0;}li > ol{margin-left:1.5rem;margin-bottom:calc(1.5rem / 2);margin-top:calc(1.5rem / 2);}li > ul{margin-left:1.5rem;margin-bottom:calc(1.5rem / 2);margin-top:calc(1.5rem / 2);}blockquote *:last-child{margin-bottom:0;}li *:last-child{margin-bottom:0;}p *:last-child{margin-bottom:0;}li > p{margin-bottom:calc(1.5rem / 2);}code{font-size:0.85rem;line-height:1.5rem;}kbd{font-size:0.85rem;line-height:1.5rem;}samp{font-size:0.85rem;line-height:1.5rem;}abbr{border-bottom:1px dotted hsla(0,0%,0%,0.5);cursor:help;}acronym{border-bottom:1px dotted hsla(0,0%,0%,0.5);cursor:help;}abbr[title]{border-bottom:1px dotted hsla(0,0%,0%,0.5);cursor:help;text-decoration:none;}thead{text-align:left;}td,th{text-align:left;border-bottom:1px solid hsla(0,0%,0%,0.12);font-feature-settings:"tnum";-moz-font-feature-settings:"tnum";-ms-font-feature-settings:"tnum";-webkit-font-feature-settings:"tnum";padding-left:1rem;padding-right:1rem;padding-top:0.75rem;padding-bottom:calc(0.75rem - 1px);}th:first-child,td:first-child{padding-left:0;}th:last-child,td:last-child{padding-right:0;}a{color:#ff5700;text-decoration:none;text-shadow:.03em 0 #fff,-.03em 0 #fff,0 .03em #fff,0 -.03em #fff,.06em 0 #fff,-.06em 0 #fff,.09em 0 #fff,-.09em 0 #fff,.12em 0 #fff,-.12em 0 #fff,.15em 0 #fff,-.15em 0 #fff;background-image:linear-gradient(to top, rgba(0, 0, 0, 0), rgba(0, 0, 0, 0) 1px, #ff5700 1px, #ff5700 2px, rgba(0, 0, 0, 0) 2px);}a:hover,a:active{text-shadow:none;background-image:none;}h1,h2,h3,h4,h5,h6{margin-top:2.25rem;margin-bottom:0.75rem;}ul,ol{margin-left:1rem;}li>ol,li>ul{margin-left:1rem;margin-bottom:0;}blockquote > :last-child{margin-bottom:0;}blockquote cite{font-size:1rem;line-height:1.5rem;color:hsla(0,0%,0%,0.73);font-style:normal;font-weight:400;}blockquote cite:before{content:"— ";}@media only screen and (max-width:480px){html{font-size:118.75%;line-height:29.85px;}blockquote{border-left:0.28125rem solid #ff5700;color:hsla(0,0%,0%,0.59);padding-left:0.84375rem;font-style:italic;margin-left:-1.125rem;margin-right:0;}}h1 > a{background-image:none;}</style><style data-href="/styles.7d98cd1d3e064c18e8a4.css">@font-face{font-family:Montserrat;font-style:normal;font-display:swap;font-weight:100;src:local("Montserrat Thin "),local("Montserrat-Thin"),url(/static/montserrat-latin-100-191cc9f50f3b76b9617cb383f19acb7d.woff2) format("woff2"),url(/static/montserrat-latin-100-370318464551d5f25b0f0a78f374faac.woff) format("woff")}@font-face{font-family:Montserrat;font-style:italic;font-display:swap;font-weight:100;src:local("Montserrat Thin italic"),local("Montserrat-Thinitalic"),url(/static/montserrat-latin-100italic-bdeaeb79db315697bd173a55b097dc18.woff2) format("woff2"),url(/static/montserrat-latin-100italic-ecf7d49386e8f265878e735db34a7c4b.woff) format("woff")}@font-face{font-family:Montserrat;font-style:normal;font-display:swap;font-weight:200;src:local("Montserrat Extra Light "),local("Montserrat-Extra Light"),url(/static/montserrat-latin-200-85d5ef9db7f2dc6979172a4a3b2c57cb.woff2) format("woff2"),url(/static/montserrat-latin-200-1fc98e126a3d152549240e6244d7e669.woff) format("woff")}@font-face{font-family:Montserrat;font-style:italic;font-display:swap;font-weight:200;src:local("Montserrat Extra Light italic"),local("Montserrat-Extra Lightitalic"),url(/static/montserrat-latin-200italic-49095760a498d024fe1a85a078850df9.woff2) format("woff2"),url(/static/montserrat-latin-200italic-fe46cf8b9462c820457d3bf537e4057f.woff) format("woff")}@font-face{font-family:Montserrat;font-style:normal;font-display:swap;font-weight:300;src:local("Montserrat Light "),local("Montserrat-Light"),url(/static/montserrat-latin-300-7c3daf12b706645b5d3710f863a4da04.woff2) format("woff2"),url(/static/montserrat-latin-300-8dc95fab9cf98d02ca8d76e97d3dff60.woff) format("woff")}@font-face{font-family:Montserrat;font-style:italic;font-display:swap;font-weight:300;src:local("Montserrat Light italic"),local("Montserrat-Lightitalic"),url(/static/montserrat-latin-300italic-f20b178ca2024a5eac8e42e6649db86c.woff2) format("woff2"),url(/static/montserrat-latin-300italic-3fe16939288856e8e828fa2661bf2354.woff) format("woff")}@font-face{font-family:Montserrat;font-style:normal;font-display:swap;font-weight:400;src:local("Montserrat Regular "),local("Montserrat-Regular"),url(/static/montserrat-latin-400-bc3aa95dca08f5fee5291e34959c27bc.woff2) format("woff2"),url(/static/montserrat-latin-400-8102c4838f9e3d08dad644290a9cb701.woff) format("woff")}@font-face{font-family:Montserrat;font-style:italic;font-display:swap;font-weight:400;src:local("Montserrat Regular italic"),local("Montserrat-Regularitalic"),url(/static/montserrat-latin-400italic-5cad650422a7184467af5a4d17b264c4.woff2) format("woff2"),url(/static/montserrat-latin-400italic-d191f22af3bb50902b99ac577f81a322.woff) format("woff")}@font-face{font-family:Montserrat;font-style:normal;font-display:swap;font-weight:500;src:local("Montserrat Medium "),local("Montserrat-Medium"),url(/static/montserrat-latin-500-92d16e458625f4d2c8940f6bdca0ff09.woff2) format("woff2"),url(/static/montserrat-latin-500-8b763220218ffc11c57c84ddb80e7b26.woff) format("woff")}@font-face{font-family:Montserrat;font-style:italic;font-display:swap;font-weight:500;src:local("Montserrat Medium italic"),local("Montserrat-Mediumitalic"),url(/static/montserrat-latin-500italic-47bfcca6b69d6a9acca7a8bff17193e2.woff2) format("woff2"),url(/static/montserrat-latin-500italic-72c01f753c3940c0b9cb6bf2389caddf.woff) format("woff")}@font-face{font-family:Montserrat;font-style:normal;font-display:swap;font-weight:600;src:local("Montserrat SemiBold "),local("Montserrat-SemiBold"),url(/static/montserrat-latin-600-6fb1b5623e528e27c18658fecf5ee0ee.woff2) format("woff2"),url(/static/montserrat-latin-600-7c839d15a6f54e7025ba8c0c4b333e8f.woff) format("woff")}@font-face{font-family:Montserrat;font-style:italic;font-display:swap;font-weight:600;src:local("Montserrat SemiBold italic"),local("Montserrat-SemiBolditalic"),url(/static/montserrat-latin-600italic-60789af1c9338ed1a9546722ec54b4f7.woff2) format("woff2"),url(/static/montserrat-latin-600italic-f3d4de8d0afb19e777c79032ce828e3d.woff) format("woff")}@font-face{font-family:Montserrat;font-style:normal;font-display:swap;font-weight:700;src:local("Montserrat Bold "),local("Montserrat-Bold"),url(/static/montserrat-latin-700-39d93cf678c740f9f6b2b1cfde34bee3.woff2) format("woff2"),url(/static/montserrat-latin-700-80f10bd382f0df1cd650fec59f3c9394.woff) format("woff")}@font-face{font-family:Montserrat;font-style:italic;font-display:swap;font-weight:700;src:local("Montserrat Bold italic"),local("Montserrat-Bolditalic"),url(/static/montserrat-latin-700italic-ba136d97b14e82284dd595e257f11c47.woff2) format("woff2"),url(/static/montserrat-latin-700italic-8c98142b425630821139c24bd1698700.woff) format("woff")}@font-face{font-family:Montserrat;font-style:normal;font-display:swap;font-weight:800;src:local("Montserrat ExtraBold "),local("Montserrat-ExtraBold"),url(/static/montserrat-latin-800-b7018be9ed6cd94da8b6675b3a468c3b.woff2) format("woff2"),url(/static/montserrat-latin-800-9a9befcf50d64f9d2d19d8b1d1984add.woff) format("woff")}@font-face{font-family:Montserrat;font-style:italic;font-display:swap;font-weight:800;src:local("Montserrat ExtraBold italic"),local("Montserrat-ExtraBolditalic"),url(/static/montserrat-latin-800italic-540ffdd223d1a9ad3d4e678e1a23372e.woff2) format("woff2"),url(/static/montserrat-latin-800italic-897086f99f4e1f45e6b1e9368527d0bc.woff) format("woff")}@font-face{font-family:Montserrat;font-style:normal;font-display:swap;font-weight:900;src:local("Montserrat Black "),local("Montserrat-Black"),url(/static/montserrat-latin-900-58cd789700850375b834e8b6776002eb.woff2) format("woff2"),url(/static/montserrat-latin-900-26d42c9428780e545a540bbb50c84bce.woff) format("woff")}@font-face{font-family:Montserrat;font-style:italic;font-display:swap;font-weight:900;src:local("Montserrat Black italic"),local("Montserrat-Blackitalic"),url(/static/montserrat-latin-900italic-451157bc8861fe54f523b3669a3def71.woff2) format("woff2"),url(/static/montserrat-latin-900italic-a8ec4957e1c24f5793305763ad9845b3.woff) format("woff")}@font-face{font-family:Merriweather;font-style:normal;font-display:swap;font-weight:300;src:local("Merriweather Light "),local("Merriweather-Light"),url(/static/merriweather-latin-300-b1158cfcd4aacb9d8fb61625e37af46a.woff2) format("woff2"),url(/static/merriweather-latin-300-cc7de05e166e90320d7d896e0f72a19d.woff) format("woff")}@font-face{font-family:Merriweather;font-style:italic;font-display:swap;font-weight:300;src:local("Merriweather Light italic"),local("Merriweather-Lightitalic"),url(/static/merriweather-latin-300italic-8fe52a48089d6ebe46db0b8e7cc66263.woff2) format("woff2"),url(/static/merriweather-latin-300italic-e1331f5397c2a673f9d3765138debdb5.woff) format("woff")}@font-face{font-family:Merriweather;font-style:normal;font-display:swap;font-weight:400;src:local("Merriweather Regular "),local("Merriweather-Regular"),url(/static/merriweather-latin-400-8276fdb72ae8f4714d4e6eba704cc39f.woff2) format("woff2"),url(/static/merriweather-latin-400-69f09800f4f6479d06e44eba837df872.woff) format("woff")}@font-face{font-family:Merriweather;font-style:italic;font-display:swap;font-weight:400;src:local("Merriweather Regular italic"),local("Merriweather-Regularitalic"),url(/static/merriweather-latin-400italic-3a9be9ea9f7aa4af6de7307df21d9fc0.woff2) format("woff2"),url(/static/merriweather-latin-400italic-d76079ed7541a433a54f79316de086e9.woff) format("woff")}@font-face{font-family:Merriweather;font-style:normal;font-display:swap;font-weight:700;src:local("Merriweather Bold "),local("Merriweather-Bold"),url(/static/merriweather-latin-700-fa534be7ffa380e39a7f6e03bf9a5e03.woff2) format("woff2"),url(/static/merriweather-latin-700-ba56ea84b8084b7ff9677f50d3cd81bd.woff) format("woff")}@font-face{font-family:Merriweather;font-style:italic;font-display:swap;font-weight:700;src:local("Merriweather Bold italic"),local("Merriweather-Bolditalic"),url(/static/merriweather-latin-700italic-1ef5edaaa20ae53ea50399884c5e48c6.woff2) format("woff2"),url(/static/merriweather-latin-700italic-534bc9e7ce93c73d73426e46acd78092.woff) format("woff")}@font-face{font-family:Merriweather;font-style:normal;font-display:swap;font-weight:900;src:local("Merriweather Black "),local("Merriweather-Black"),url(/static/merriweather-latin-900-7528fb70e8a4a82c7305e72ff43ac25f.woff2) format("woff2"),url(/static/merriweather-latin-900-3799b6e2f5ed3fcccf9d7a708d7419fa.woff) format("woff")}@font-face{font-family:Merriweather;font-style:italic;font-display:swap;font-weight:900;src:local("Merriweather Black italic"),local("Merriweather-Blackitalic"),url(/static/merriweather-latin-900italic-e1b4d2aaa78e12ad84aaf8a56321e4c2.woff2) format("woff2"),url(/static/merriweather-latin-900italic-2ae22f731b3424e8dbb4b37f7ca6e708.woff) format("woff")}code[class*=language-],pre[class*=language-]{color:#000;background:none;text-shadow:0 1px #fff;font-family:Consolas,Monaco,Andale Mono,Ubuntu Mono,monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-ms-hyphens:none;hyphens:none}code[class*=language-]::selection,code[class*=language-] ::selection,pre[class*=language-]::selection,pre[class*=language-] ::selection{text-shadow:none;background:#b3d4fc}@media print{code[class*=language-],pre[class*=language-]{text-shadow:none}}pre[class*=language-]{padding:1em;margin:.5em 0;overflow:auto}:not(pre)>code[class*=language-],pre[class*=language-]{background:#f5f2f0}:not(pre)>code[class*=language-]{padding:.1em;border-radius:.3em;white-space:normal}.token.cdata,.token.comment,.token.doctype,.token.prolog{color:#708090}.token.punctuation{color:#999}.token.namespace{opacity:.7}.token.boolean,.token.constant,.token.deleted,.token.number,.token.property,.token.symbol,.token.tag{color:#905}.token.attr-name,.token.builtin,.token.char,.token.inserted,.token.selector,.token.string{color:#690}.language-css .token.string,.style .token.string,.token.entity,.token.operator,.token.url{color:#9a6e3a;background:hsla(0,0%,100%,.5)}.token.atrule,.token.attr-value,.token.keyword{color:#07a}.token.class-name,.token.function{color:#dd4a68}.token.important,.token.regex,.token.variable{color:#e90}.token.bold,.token.important{font-weight:700}.token.italic{font-style:italic}.token.entity{cursor:help}.blog-post-module--blog-tag--2JghA{margin:.625rem .3125rem;height:2.1875rem;padding:0 1.5rem;line-height:2.1875rem;font-size:.9rem}.blog-post-module--blog-tag--2JghA,.blog-post-module--blog-tag-small-size--3s4nT{display:inline-block;border:1px solid #e6e6e6;text-decoration:none;border-radius:1.25rem;color:#222}.blog-post-module--blog-tag-small-size--3s4nT{margin:0 .3125rem;height:1.15rem;line-height:1rem;padding:0 .7rem;font-size:.8rem;white-space:nowrap}.blog-post-module--blog-tag--2JghA:hover,.blog-post-module--blog-tag-small-size--3s4nT:hover{color:#fff;background-color:grey;border:1px solid grey}</style><meta name="generator" content="Gatsby 2.23.12"/><link rel="icon" href="/favicon-32x32.png?v=9f50719bf6a5c0099a47921ead3762b3"/><link rel="manifest" href="/manifest.webmanifest"/><meta name="theme-color" content="#663399"/><link rel="apple-touch-icon" sizes="48x48" href="/icons/icon-48x48.png?v=9f50719bf6a5c0099a47921ead3762b3"/><link rel="apple-touch-icon" sizes="72x72" href="/icons/icon-72x72.png?v=9f50719bf6a5c0099a47921ead3762b3"/><link rel="apple-touch-icon" sizes="96x96" href="/icons/icon-96x96.png?v=9f50719bf6a5c0099a47921ead3762b3"/><link rel="apple-touch-icon" sizes="144x144" href="/icons/icon-144x144.png?v=9f50719bf6a5c0099a47921ead3762b3"/><link rel="apple-touch-icon" sizes="192x192" href="/icons/icon-192x192.png?v=9f50719bf6a5c0099a47921ead3762b3"/><link rel="apple-touch-icon" sizes="256x256" href="/icons/icon-256x256.png?v=9f50719bf6a5c0099a47921ead3762b3"/><link rel="apple-touch-icon" sizes="384x384" href="/icons/icon-384x384.png?v=9f50719bf6a5c0099a47921ead3762b3"/><link rel="apple-touch-icon" sizes="512x512" href="/icons/icon-512x512.png?v=9f50719bf6a5c0099a47921ead3762b3"/><title data-react-helmet="true">cs231n: Practical Machine Learning Project 2 | Twistronics Blog</title><meta data-react-helmet="true" name="description" content="Option 1. Image Captioning using RNN and LSTM. "/><meta data-react-helmet="true" property="og:title" content="cs231n: Practical Machine Learning Project 2"/><meta data-react-helmet="true" property="og:description" content="Option 1. Image Captioning using RNN and LSTM. "/><meta data-react-helmet="true" property="og:type" content="website"/><link href="//fonts.googleapis.com/css?family=Rosario:700|Crimson+Text:400,400i,600" rel="stylesheet" type="text/css"/><link as="script" rel="preload" href="/webpack-runtime-7057b47b0c1b3e1dc538.js"/><link as="script" rel="preload" href="/framework-93d3a746c3cf42acdafc.js"/><link as="script" rel="preload" href="/app-c94c84d1627c2405770e.js"/><link as="script" rel="preload" href="/styles-c2fe8482057191dca484.js"/><link as="script" rel="preload" href="/commons-83e5dfcf4e4c104a0e8d.js"/><link as="script" rel="preload" href="/component---src-templates-blog-post-js-11ba5fcb3e84959fd9c6.js"/><link as="fetch" rel="preload" href="/page-data\blogs\cs231n-Practical-Machine-Learning-Project-2\page-data.json" crossorigin="anonymous"/><link as="fetch" rel="preload" href="/page-data\app-data.json" crossorigin="anonymous"/></head><body><div id="___gatsby"><div style="outline:none" tabindex="-1" id="gatsby-focus-wrapper"><div style="margin-left:auto;margin-right:auto;max-width:46.5rem;padding:2.25rem 1.125rem"><header><h3 style="font-family:Montserrat, sans-serif;margin-top:0"><a style="box-shadow:none;color:inherit" href="/">Twistronics Blog</a></h3></header><main><article><header><h1 style="margin-top:1.5rem;margin-bottom:0">cs231n: Practical Machine Learning Project 2</h1><p style="font-size:0.87055rem;line-height:1.5rem;display:block;margin-bottom:1.2rem">November 10, 2016</p><div><ul style="padding:0;margin:0 -.625rem;margin-bottom:1.5rem"><a style="background-image:none" href="/tag/Python"><li class="blog-post-module--blog-tag--2JghA">Python</li></a><a style="background-image:none" href="/tag/Machine learning"><li class="blog-post-module--blog-tag--2JghA">Machine learning</li></a><a style="background-image:none" href="/tag/机器学习"><li class="blog-post-module--blog-tag--2JghA">机器学习</li></a></ul></div></header><section><h2>Option 1. Image Captioning using RNN and LSTM</h2>
<h3>Q1: Image Captioning with Vanilla RNNs</h3>
<p>The IPython notebook <code class="language-text">RNN_Captioning.ipynb</code> walk through the implementation of an image captioning system on MS-COCO using vanilla recurrent networks.</p>
<p>The file <code class="language-text">cs231n/rnn_layers.py</code> contains implementations of different layer types that are needed for recurrent neural networks. The file <code class="language-text">cs231n/classifiers/rnn.py</code> contains implementations of CaptioningRNN class.</p>
<p>run the following command</p>
<div class="gatsby-highlight" data-language="text"><pre class="language-text"><code class="language-text">ipython notebook RNN_Captioning.ipynb</code></pre></div>
<p><span
      class="gatsby-resp-image-wrapper"
      style="position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 590px; "
    >
      <a
    class="gatsby-resp-image-link"
    href="/static/5c2a1a0727a3df4380e360d8e9c65ca8/5754a/q1-1.png"
    style="display: block"
    target="_blank"
    rel="noopener"
  >
    <span
    class="gatsby-resp-image-background-image"
    style="padding-bottom: 82.43243243243244%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAQCAYAAAAWGF8bAAAACXBIWXMAAAsSAAALEgHS3X78AAABLUlEQVQ4y62U3WrCMBSAw2BvtPu9wSrMurHn2S7GHsIX2I3rBpuCQr0RigzGMPZKGabWiyahHWhNTZeYSm2ZYCUHDgknyccX8gOAiMWCvqcaIgiCR8kDCFErq61Fbk7IWC4mhDxsgfN5+KJ4nPETIhPJgbMZec2B1baZAVnZ0NIKnExowbAK9D/g2XQatZJEn+E5xupQxJgWQxBFasuMcaYmHQ89AFSGcZwD99vKQELwmyxQWjQ8xvSA4W9LFpZLzoQlV9MqXeyyIdndwzgM02S1SuWZF1Ks25Rre7l7eveZYfSh43PAGD9tgbZtX/q+f42QZ7guNCEc10cjz4AQ1Wz787bfd+uW5dx1u9DsdL4bjuPVhkPfaLe/bnq9sSn6V4PBT6PZfL4AAgx0xh9quEi13cfkwgAAAABJRU5ErkJggg=='); background-size: cover; display: block;"
  ></span>
  <img
        class="gatsby-resp-image-image"
        alt="q1 1"
        title="q1 1"
        src="/static/5c2a1a0727a3df4380e360d8e9c65ca8/fcda8/q1-1.png"
        srcset="/static/5c2a1a0727a3df4380e360d8e9c65ca8/12f09/q1-1.png 148w,
/static/5c2a1a0727a3df4380e360d8e9c65ca8/e4a3f/q1-1.png 295w,
/static/5c2a1a0727a3df4380e360d8e9c65ca8/fcda8/q1-1.png 590w,
/static/5c2a1a0727a3df4380e360d8e9c65ca8/5754a/q1-1.png 613w"
        sizes="(max-width: 590px) 100vw, 590px"
        style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;"
        loading="lazy"
      />
  </a>
    </span></p>
<p>result</p>
<p><span
      class="gatsby-resp-image-wrapper"
      style="position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 590px; "
    >
      <a
    class="gatsby-resp-image-link"
    href="/static/1c1beeec8cf45227483558972c058330/3dd3e/q1-2.png"
    style="display: block"
    target="_blank"
    rel="noopener"
  >
    <span
    class="gatsby-resp-image-background-image"
    style="padding-bottom: 75%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAPCAYAAADkmO9VAAAACXBIWXMAAAsSAAALEgHS3X78AAAEH0lEQVQ4y1WS3U9bdRjHzykvHdDTUqBAuxZKS19A3ikvhVagLRRIBxQObz2nDFoEgU0s5UUZAhlsDIeTBBzETGPUocu8ckuMeuOFF144TNyF/4DpjS/x2p3+vvawTeeTfPMkz/PNJ883eSjq/yUBIHY6oaQXuqhccf/CXPJMzz1Pa27nfpJvZsflCy0Pmcrr+cRo2KBSBKzqTE6TLeMpiSQolSbzsrRUXp4h5eTy9KA8UzaqVKRzvp4BrlSv4zJkikAoujV09NlXTso7fZ3h1z/5bSB6iOr2UfE8mNVZaDTmod6Qi9riXKhzZMiUpyErMwMaVTpK1akoMRZidjaCchWDxmYPHv8B3Hn44+NEEDMTunovNnfra4S27sd1piqSgBIlk06YNClpLj9PvHY9MeszSaUpi/ja68jy2k1y6bV1EuYmSH1eBnE6vU+Ovvsd/JUPHlE5ZgfTxl2JDUZu4fLeg3ho6ZBo1JozqCiJhCKq7AxiNOpJ9+AEeXXziOx+8TMJTi4Tq6WEmLPTiK2uTeh/4wTOoYVTamnjPcYViMYahiMY3/o8Htk4xubbn4INr6De44fd2YI2dxca+6YxsnyMyP6XGIu+g8JE1Gq9EjkKKQr0xYI/cozOifVTqrjWztS7fLGuPh6h2bX49PgMFmZXEIls4pWxcUwGx8D3sujr4zAcmMWl5V3YmtxwF2fh/akWGHMZpKSeE7z8CtjprVMqScowiWgxR7MbV29+HA/4/Bjs9CHy1iEC4ShaWzxwl+hRU9sIu6sHnsFJqLVa9FXqcIOtRX+1FnRKmsBH99HJLZ5SqnztGVCelY+t2w/iQW4avT2j2D75CeHtu3i5LwRHmQVGmxu2njC6xudRWqiG16rB3fFGtJvzQCelCNzyARy9U6fiKzI0LYmJ71JmtcR5vx9jvk6svz6PyPQMRru6UFNhQq29EoUVZnQ0lcKmUUKRmopARSGKlHKk0pTQ0MGiyTv0FCheKALlisz4+soq3r2xh72NHeyubSDA8mi01aC/04ma+hr0VBvQZso/+9eA3QJv4XlMFOiE2QoHmpvb/wPSNCWa4serC+SHOwfkeGGRXBsfIdfCk8TvrCP2lwqIt8pK+AYjKZDLiCrlHPloxkPuXWwnK0UWIarQY15t/hf4q0QiEYFPbq/OCX9+/1D4ZntVuNxUKQRri4SWYo3gsBQIw3UmwVepE/RJMkFBpwhHM63CSdAluJNz/g4odVjMNjx6DvzrGRARfgjffniIJW4Eb164AH+1Fd2lRlRqctFVpkOVOhtaSfqZd9VfhR1XNSwUgzFlAQJK7S8iMDkhH03TQ4nOsp42dn81wl7s72anWh1sk9HA2nQaVq+QszVaFauRZbBSOpkVvVyDgT3osLOO5KyBMaVupIXJ8fwDdsa+5ko/EiUAAAAASUVORK5CYII='); background-size: cover; display: block;"
  ></span>
  <img
        class="gatsby-resp-image-image"
        alt="q1 2"
        title="q1 2"
        src="/static/1c1beeec8cf45227483558972c058330/fcda8/q1-2.png"
        srcset="/static/1c1beeec8cf45227483558972c058330/12f09/q1-2.png 148w,
/static/1c1beeec8cf45227483558972c058330/e4a3f/q1-2.png 295w,
/static/1c1beeec8cf45227483558972c058330/fcda8/q1-2.png 590w,
/static/1c1beeec8cf45227483558972c058330/3dd3e/q1-2.png 595w"
        sizes="(max-width: 590px) 100vw, 590px"
        style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;"
        loading="lazy"
      />
  </a>
    </span>
<span
      class="gatsby-resp-image-wrapper"
      style="position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 498px; "
    >
      <a
    class="gatsby-resp-image-link"
    href="/static/306663fdfbc2c89f6a7e190a5eee2051/79e1b/q1-3.png"
    style="display: block"
    target="_blank"
    rel="noopener"
  >
    <span
    class="gatsby-resp-image-background-image"
    style="padding-bottom: 104.05405405405406%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,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'); background-size: cover; display: block;"
  ></span>
  <img
        class="gatsby-resp-image-image"
        alt="q1 3"
        title="q1 3"
        src="/static/306663fdfbc2c89f6a7e190a5eee2051/79e1b/q1-3.png"
        srcset="/static/306663fdfbc2c89f6a7e190a5eee2051/12f09/q1-3.png 148w,
/static/306663fdfbc2c89f6a7e190a5eee2051/e4a3f/q1-3.png 295w,
/static/306663fdfbc2c89f6a7e190a5eee2051/79e1b/q1-3.png 498w"
        sizes="(max-width: 498px) 100vw, 498px"
        style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;"
        loading="lazy"
      />
  </a>
    </span>
<span
      class="gatsby-resp-image-wrapper"
      style="position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 493px; "
    >
      <a
    class="gatsby-resp-image-link"
    href="/static/ef331f867c6cde9910796dbfae36ec58/f88d0/q1-4.png"
    style="display: block"
    target="_blank"
    rel="noopener"
  >
    <span
    class="gatsby-resp-image-background-image"
    style="padding-bottom: 105.40540540540542%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,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'); background-size: cover; display: block;"
  ></span>
  <img
        class="gatsby-resp-image-image"
        alt="q1 4"
        title="q1 4"
        src="/static/ef331f867c6cde9910796dbfae36ec58/f88d0/q1-4.png"
        srcset="/static/ef331f867c6cde9910796dbfae36ec58/12f09/q1-4.png 148w,
/static/ef331f867c6cde9910796dbfae36ec58/e4a3f/q1-4.png 295w,
/static/ef331f867c6cde9910796dbfae36ec58/f88d0/q1-4.png 493w"
        sizes="(max-width: 493px) 100vw, 493px"
        style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;"
        loading="lazy"
      />
  </a>
    </span>
<span
      class="gatsby-resp-image-wrapper"
      style="position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 489px; "
    >
      <a
    class="gatsby-resp-image-link"
    href="/static/23aee6a39b75f1da8cbbf4d8eaae6fcb/03e1f/q1-5.png"
    style="display: block"
    target="_blank"
    rel="noopener"
  >
    <span
    class="gatsby-resp-image-background-image"
    style="padding-bottom: 106.08108108108108%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAVCAYAAABG1c6oAAAACXBIWXMAAAsSAAALEgHS3X78AAAEbklEQVQ4y2WV+S+caxTHh7HvS7lErAmN3DJcqUtvpAQJWiFCYgvpFLGEH0osk3LREgTX1tqjUmtLUFtDYknT1C80/Fht+oNf7v0T3HfmOfd7nmJu0jc5eWbmfZ/P+z3nOec7KpVKZY5QW1tbq7FaIMxUP67r1QRhg3C6+m76v+BLbW5ufr2XQ/ULIgBx28nJKSIyMjIsNTU1JDY2NvLBgwe/urm5/XHr1q0QZ2dnjYuLS7iDg0MYXv67ra3tXQ8PDw2+/4a9gQjNzUtDQkJYpSo+Pr4c8XdCQsJ5enr619zc3O+9vb3fX79+/W1tbe0L1u+vXr36OjEx8e3FixdfOjs7/2ltba3nvTExMRaq62t2dpYlq/r7+xtHR0cJEIqIiKC4uDhaXV2lhYUFWlpaopWVFWppaaHGxkaqr68nwGloaKib956enpreALu7u2W9RkZGGvjBurq6y+TkZINWqzUkJSUZiouLDYWFhQaoMUCZYWpqyvDkyZN/oZQWFxc7eO/4+Lj6BoiHJHByclLX3t5OtbW1SkNDg8jLyyMrKyuKioqirKws4ntzc3OsWLS1tSkoAWfQyXvfvHnzMxCrDm+nyspKJScnR2g0GvLx8SE/Pz9CXQkKKTs7myoqKgRCWV9fp42NDQkE2Ajs6OiQQCjQAUrDw8MKVApvb28KDQ2l6OhoevjwIT19+pRYNUog8vPzld3dXXr//r0Ebm5uGoEvX768UchpfPr0SUGxBatDy5Cnpyfdu3dPKgSIQxQVFSk7Ozu0vb0tgVtbW0bg2NiYBOKEdfPz81RQUKD4+vqKwMBAYpWOjo4UHh4uFXJwfauqqhRkQn19fRKI1QiEXAlEW+iOj48pLS1NQfdLhUFBQbJuZWVl9OHDB/r8+TMdHR2Jd+/eKTU1NVRSUiKB5eXlRuDHjx8lcG9vT3dxcUFIWzExMRH+/v5SGQ6ASktLqbq6mgYGBgjPC2SlYHoIkySBWI3Aw8NDCTw4ONCxgpOTEwXpi8TERMJ4EUaN3N3dZfrcRniJ4LKwelNTUwm0s7MzAvf3928UouPp7OxMOT8/F9x7FhYWhHklV1dXwvySjY0Nr6xewcxTQECABAYHBxuBOCmzq5PScZ0AVqBaYFqkIobBOKRSS0tLsre3FwArDMc9CcRLjcDl5WWzq1WHAyJ0vYKiCziOhHDarJI/q9VqCYRKPjhCSCBSNwJnZmbMrlYdoDQ9Pa28fftWZGRkSIiXlxdDZMp4jMLCwgQcSuHPaCkJvPLEHxcAZlerDsNOfILc2JhXAcdhNQInKqBOcDthDAXmWwJx72cgTOHaHBpgZYQTvuzp6dE3NzfrHz9+rEeT61Ev/Z07d/SZmZl6GK8e5bhk5VAo3QbmawQODg5KIHrsT/Y+Ngj2RXQ/dXV1sZ3JGX7+/Dk1NTURmlg2e0pKCs/5X7z3/v37RiA28v+GCsaqQbpl8MVHAGlhFloYhxbpa+F9Wv4No6d99uyZFn34CO5eCke6y3thyJLxHwXuZpqGijIhAAAAAElFTkSuQmCC'); background-size: cover; display: block;"
  ></span>
  <img
        class="gatsby-resp-image-image"
        alt="q1 5"
        title="q1 5"
        src="/static/23aee6a39b75f1da8cbbf4d8eaae6fcb/03e1f/q1-5.png"
        srcset="/static/23aee6a39b75f1da8cbbf4d8eaae6fcb/12f09/q1-5.png 148w,
/static/23aee6a39b75f1da8cbbf4d8eaae6fcb/e4a3f/q1-5.png 295w,
/static/23aee6a39b75f1da8cbbf4d8eaae6fcb/03e1f/q1-5.png 489w"
        sizes="(max-width: 489px) 100vw, 489px"
        style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;"
        loading="lazy"
      />
  </a>
    </span></p>
<p>code: in <code class="language-text">cs231n/classifiers/rnn.py</code></p>
<div class="gatsby-highlight" data-language="python"><pre class="language-python"><code class="language-python">  <span class="token keyword">def</span> <span class="token function">loss</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> features<span class="token punctuation">,</span> captions<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">"""
    Compute training-time loss for the RNN. We input image features and
    ground-truth captions for those images, and use an RNN (or LSTM) to compute
    loss and gradients on all parameters.

    Inputs:
    - features: Input image features, of shape (N, D)
    - captions: Ground-truth captions; an integer array of shape (N, T) where
      each element is in the range 0 &lt;= y[i, t] &lt; V

    Returns a tuple of:
    - loss: Scalar loss
    - grads: Dictionary of gradients parallel to self.params
    """</span>
    <span class="token comment"># Cut captions into two pieces: captions_in has everything but the last word</span>
    <span class="token comment"># and will be input to the RNN; captions_out has everything but the first</span>
    <span class="token comment"># word and this is what we will expect the RNN to generate. These are offset</span>
    <span class="token comment"># by one relative to each other because the RNN should produce word (t+1)</span>
    <span class="token comment"># after receiving word t. The first element of captions_in will be the START</span>
    <span class="token comment"># token, and the first element of captions_out will be the first word.</span>
    captions_in <span class="token operator">=</span> captions<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span> <span class="token punctuation">:</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span>
    captions_out <span class="token operator">=</span> captions<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">:</span><span class="token punctuation">]</span>
    <span class="token comment"># You'll need this</span>
    mask <span class="token operator">=</span> <span class="token punctuation">(</span>captions_out <span class="token operator">!=</span> self<span class="token punctuation">.</span>_null<span class="token punctuation">)</span>

    <span class="token comment"># Weight and bias for the affine transform from image features to initial</span>
    <span class="token comment"># hidden state</span>
    W_proj<span class="token punctuation">,</span> b_proj <span class="token operator">=</span> self<span class="token punctuation">.</span>params<span class="token punctuation">[</span><span class="token string">'W_proj'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> self<span class="token punctuation">.</span>params<span class="token punctuation">[</span><span class="token string">'b_proj'</span><span class="token punctuation">]</span>
    <span class="token comment"># Word embedding matrix</span>
    W_embed <span class="token operator">=</span> self<span class="token punctuation">.</span>params<span class="token punctuation">[</span><span class="token string">'W_embed'</span><span class="token punctuation">]</span>
    <span class="token comment"># Input-to-hidden, hidden-to-hidden, and biases for the RNN</span>
    Wx<span class="token punctuation">,</span> Wh<span class="token punctuation">,</span> b <span class="token operator">=</span> self<span class="token punctuation">.</span>params<span class="token punctuation">[</span><span class="token string">'Wx'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> self<span class="token punctuation">.</span>params<span class="token punctuation">[</span><span class="token string">'Wh'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> self<span class="token punctuation">.</span>params<span class="token punctuation">[</span><span class="token string">'b'</span><span class="token punctuation">]</span>
    <span class="token comment"># Weight and bias for the hidden-to-vocab transformation.</span>
    W_vocab<span class="token punctuation">,</span> b_vocab <span class="token operator">=</span> self<span class="token punctuation">.</span>params<span class="token punctuation">[</span><span class="token string">'W_vocab'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> self<span class="token punctuation">.</span>params<span class="token punctuation">[</span><span class="token string">'b_vocab'</span><span class="token punctuation">]</span>
    loss<span class="token punctuation">,</span> grads <span class="token operator">=</span> <span class="token number">0.0</span><span class="token punctuation">,</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
    <span class="token comment">############################################################################</span>
    <span class="token comment"># TODO: Implement the forward and backward passes for the CaptioningRNN.   #</span>
    <span class="token comment"># In the forward pass you will need to do the following:                   #</span>
    <span class="token comment"># (1) Use an affine transformation to compute the initial hidden state     #</span>
    <span class="token comment">#     from the image features. This should produce an array of shape (N, H)#</span>
    <span class="token comment"># (2) Use a word embedding layer to transform the words in captions_in     #</span>
    <span class="token comment">#     from indices to vectors, giving an array of shape (N, T, W).         #</span>
    <span class="token comment"># (3) Use either a vanilla RNN or LSTM (depending on self.cell_type) to    #</span>
    <span class="token comment">#     process the sequence of input word vectors and produce hidden state  #</span>
    <span class="token comment">#     vectors for all timesteps, producing an array of shape (N, T, H).    #</span>
    <span class="token comment"># (4) Use a (temporal) affine transformation to compute scores over the    #</span>
    <span class="token comment">#     vocabulary at every timestep using the hidden states, giving an      #</span>
    <span class="token comment">#     array of shape (N, T, V).                                            #</span>
    <span class="token comment"># (5) Use (temporal) softmax to compute loss using captions_out, ignoring  #</span>
    <span class="token comment">#     the points where the output word is &lt;NULL> using the mask above.     #</span>
    <span class="token comment">#                                                                          #</span>
    <span class="token comment"># In the backward pass you will need to compute the gradient of the loss   #</span>
    <span class="token comment"># with respect to all model parameters. Use the loss and grads variables   #</span>
    <span class="token comment"># defined above to store loss and gradients; grads[k] should give the      #</span>
    <span class="token comment"># gradients for self.params[k].                                            #</span>
    <span class="token comment">############################################################################</span>

    affine_out<span class="token punctuation">,</span> affine_cache <span class="token operator">=</span> affine_forward<span class="token punctuation">(</span>features<span class="token punctuation">,</span> W_proj<span class="token punctuation">,</span> b_proj<span class="token punctuation">)</span>
    embed_out<span class="token punctuation">,</span> embed_cache <span class="token operator">=</span> word_embedding_forward<span class="token punctuation">(</span>captions_in<span class="token punctuation">,</span> W_embed<span class="token punctuation">)</span>
    forward <span class="token operator">=</span> rnn_forward <span class="token keyword">if</span> self<span class="token punctuation">.</span>cell_type <span class="token operator">==</span> <span class="token string">'rnn'</span> <span class="token keyword">else</span> lstm_forward
    forward_out<span class="token punctuation">,</span> forward_cache <span class="token operator">=</span> forward<span class="token punctuation">(</span>embed_out<span class="token punctuation">,</span> affine_out<span class="token punctuation">,</span> Wx<span class="token punctuation">,</span> Wh<span class="token punctuation">,</span> b<span class="token punctuation">)</span>
    temporal_out<span class="token punctuation">,</span> temporal_cache <span class="token operator">=</span> temporal_affine_forward<span class="token punctuation">(</span>forward_out<span class="token punctuation">,</span> W_vocab<span class="token punctuation">,</span> b_vocab<span class="token punctuation">)</span>
    loss<span class="token punctuation">,</span> dx <span class="token operator">=</span> temporal_softmax_loss<span class="token punctuation">(</span>temporal_out<span class="token punctuation">,</span> captions_out<span class="token punctuation">,</span> mask<span class="token punctuation">,</span> <span class="token boolean">False</span><span class="token punctuation">)</span>
    drnn<span class="token punctuation">,</span> dW_vocab<span class="token punctuation">,</span> db_vocab <span class="token operator">=</span> temporal_affine_backward<span class="token punctuation">(</span>dx<span class="token punctuation">,</span> temporal_cache<span class="token punctuation">)</span>
    backward <span class="token operator">=</span> rnn_backward <span class="token keyword">if</span> self<span class="token punctuation">.</span>cell_type <span class="token operator">==</span> <span class="token string">'rnn'</span> <span class="token keyword">else</span> lstm_backward
    dembed<span class="token punctuation">,</span> daffine<span class="token punctuation">,</span> dWx<span class="token punctuation">,</span> dWh<span class="token punctuation">,</span> db <span class="token operator">=</span> backward<span class="token punctuation">(</span>drnn<span class="token punctuation">,</span> forward_cache<span class="token punctuation">)</span>
    dW_embed <span class="token operator">=</span> word_embedding_backward<span class="token punctuation">(</span>dembed<span class="token punctuation">,</span> embed_cache<span class="token punctuation">)</span>
    dx<span class="token punctuation">,</span> dW_proj<span class="token punctuation">,</span> db_proj <span class="token operator">=</span> affine_backward<span class="token punctuation">(</span>daffine<span class="token punctuation">,</span> affine_cache<span class="token punctuation">)</span>
    grads <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token string">'W_vocab'</span><span class="token punctuation">:</span>dW_vocab<span class="token punctuation">,</span><span class="token string">'b_vocab'</span><span class="token punctuation">:</span>db_vocab<span class="token punctuation">,</span><span class="token string">'Wx'</span><span class="token punctuation">:</span>dWx<span class="token punctuation">,</span><span class="token string">'Wh'</span><span class="token punctuation">:</span>dWh<span class="token punctuation">,</span><span class="token string">'b'</span><span class="token punctuation">:</span>db<span class="token punctuation">,</span>
             <span class="token string">'W_embed'</span><span class="token punctuation">:</span>dW_embed<span class="token punctuation">,</span><span class="token string">'W_proj'</span><span class="token punctuation">:</span>dW_proj<span class="token punctuation">,</span><span class="token string">'b_proj'</span><span class="token punctuation">:</span>db_proj<span class="token punctuation">}</span>

    <span class="token comment">############################################################################</span>
    <span class="token comment">#                             END OF YOUR CODE                             #</span>
    <span class="token comment">############################################################################</span>
    <span class="token keyword">return</span> loss<span class="token punctuation">,</span> grads</code></pre></div>
<p>in <code class="language-text">cs231n/classifiers/rnn.py</code></p>
<div class="gatsby-highlight" data-language="python"><pre class="language-python"><code class="language-python">  <span class="token keyword">def</span> <span class="token function">sample</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> features<span class="token punctuation">,</span> max_length<span class="token operator">=</span><span class="token number">30</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">"""
    Run a test-time forward pass for the model, sampling captions for input
    feature vectors.

    At each timestep, we embed the current word, pass it and the previous hidden
    state to the RNN to get the next hidden state, use the hidden state to get
    scores for all vocab words, and choose the word with the highest score as
    the next word. The initial hidden state is computed by applying an affine
    transform to the input image features, and the initial word is the &lt;START>
    token.

    For LSTMs you will also have to keep track of the cell state; in that case
    the initial cell state should be zero.

    Inputs:
    - features: Array of input image features of shape (N, D).
    - max_length: Maximum length T of generated captions.

    Returns:
    - captions: Array of shape (N, max_length) giving sampled captions,
      where each element is an integer in the range [0, V). The first element
      of captions should be the first sampled word, not the &lt;START> token.
    """</span>
    N <span class="token operator">=</span> features<span class="token punctuation">.</span>shape<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>
    captions <span class="token operator">=</span> self<span class="token punctuation">.</span>_null <span class="token operator">*</span> np<span class="token punctuation">.</span>ones<span class="token punctuation">(</span><span class="token punctuation">(</span>N<span class="token punctuation">,</span> max_length<span class="token punctuation">)</span><span class="token punctuation">,</span> dtype<span class="token operator">=</span>np<span class="token punctuation">.</span>int32<span class="token punctuation">)</span>

    <span class="token comment"># Unpack parameters</span>
    W_proj<span class="token punctuation">,</span> b_proj <span class="token operator">=</span> self<span class="token punctuation">.</span>params<span class="token punctuation">[</span><span class="token string">'W_proj'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> self<span class="token punctuation">.</span>params<span class="token punctuation">[</span><span class="token string">'b_proj'</span><span class="token punctuation">]</span>
    W_embed <span class="token operator">=</span> self<span class="token punctuation">.</span>params<span class="token punctuation">[</span><span class="token string">'W_embed'</span><span class="token punctuation">]</span>
    Wx<span class="token punctuation">,</span> Wh<span class="token punctuation">,</span> b <span class="token operator">=</span> self<span class="token punctuation">.</span>params<span class="token punctuation">[</span><span class="token string">'Wx'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> self<span class="token punctuation">.</span>params<span class="token punctuation">[</span><span class="token string">'Wh'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> self<span class="token punctuation">.</span>params<span class="token punctuation">[</span><span class="token string">'b'</span><span class="token punctuation">]</span>
    W_vocab<span class="token punctuation">,</span> b_vocab <span class="token operator">=</span> self<span class="token punctuation">.</span>params<span class="token punctuation">[</span><span class="token string">'W_vocab'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> self<span class="token punctuation">.</span>params<span class="token punctuation">[</span><span class="token string">'b_vocab'</span><span class="token punctuation">]</span>

    <span class="token comment">###########################################################################</span>
    <span class="token comment"># TODO: Implement test-time sampling for the model. You will need to      #</span>
    <span class="token comment"># initialize the hidden state of the RNN by applying the learned affine   #</span>
    <span class="token comment"># transform to the input image features. The first word that you feed to  #</span>
    <span class="token comment"># the RNN should be the &lt;START> token; its value is stored in the         #</span>
    <span class="token comment"># variable self._start. At each timestep you will need to do to:          #</span>
    <span class="token comment"># (1) Embed the previous word using the learned word embeddings           #</span>
    <span class="token comment"># (2) Make an RNN step using the previous hidden state and the embedded   #</span>
    <span class="token comment">#     current word to get the next hidden state.                          #</span>
    <span class="token comment"># (3) Apply the learned affine transformation to the next hidden state to #</span>
    <span class="token comment">#     get scores for all words in the vocabulary                          #</span>
    <span class="token comment"># (4) Select the word with the highest score as the next word, writing it #</span>
    <span class="token comment">#     to the appropriate slot in the captions variable                    #</span>
    <span class="token comment">#                                                                         #</span>
    <span class="token comment"># For simplicity, you do not need to stop generating after an &lt;END> token #</span>
    <span class="token comment"># is sampled, but you can if you want to.                                 #</span>
    <span class="token comment">#                                                                         #</span>
    <span class="token comment"># HINT: You will not be able to use the rnn_forward or lstm_forward       #</span>
    <span class="token comment"># functions; you'll need to call rnn_step_forward or lstm_step_forward in #</span>
    <span class="token comment"># a loop.                                                                 #</span>
    <span class="token comment">###########################################################################</span>

    <span class="token keyword">if</span> self<span class="token punctuation">.</span>cell_type <span class="token operator">==</span> <span class="token string">'rnn'</span><span class="token punctuation">:</span>
      prev_word <span class="token operator">=</span> np<span class="token punctuation">.</span>zeros<span class="token punctuation">(</span><span class="token punctuation">(</span>N<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span> dtype<span class="token operator">=</span>np<span class="token punctuation">.</span>int32<span class="token punctuation">)</span> <span class="token operator">+</span> self<span class="token punctuation">.</span>_start
      prev_h<span class="token punctuation">,</span> affine_cache <span class="token operator">=</span> affine_forward<span class="token punctuation">(</span>features<span class="token punctuation">,</span> W_proj<span class="token punctuation">,</span> b_proj<span class="token punctuation">)</span>
      <span class="token keyword">for</span> t <span class="token keyword">in</span> <span class="token builtin">xrange</span><span class="token punctuation">(</span>max_length<span class="token punctuation">)</span><span class="token punctuation">:</span>
        embed_out<span class="token punctuation">,</span> embed_cache <span class="token operator">=</span> word_embedding_forward<span class="token punctuation">(</span>prev_word<span class="token punctuation">,</span> W_embed<span class="token punctuation">)</span>
        embed_out <span class="token operator">=</span> embed_out<span class="token punctuation">.</span>reshape<span class="token punctuation">(</span><span class="token punctuation">(</span>embed_out<span class="token punctuation">.</span>shape<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span>embed_out<span class="token punctuation">.</span>shape<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        h<span class="token punctuation">,</span> rnn_cache <span class="token operator">=</span> rnn_step_forward<span class="token punctuation">(</span>embed_out<span class="token punctuation">,</span> prev_h<span class="token punctuation">,</span> Wx<span class="token punctuation">,</span> Wh<span class="token punctuation">,</span> b<span class="token punctuation">)</span>
        scores<span class="token punctuation">,</span> affine_cache <span class="token operator">=</span> affine_forward<span class="token punctuation">(</span>h<span class="token punctuation">,</span> W_vocab<span class="token punctuation">,</span> b_vocab<span class="token punctuation">)</span>
        prev_word <span class="token operator">=</span> captions<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span> t<span class="token punctuation">]</span> <span class="token operator">=</span> scores<span class="token punctuation">.</span>argmax<span class="token punctuation">(</span>axis<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span>
        prev_word <span class="token operator">=</span> prev_word<span class="token punctuation">.</span>reshape<span class="token punctuation">(</span>N<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>
        prev_h <span class="token operator">=</span> h
    <span class="token keyword">else</span><span class="token punctuation">:</span>
      prev_word <span class="token operator">=</span> np<span class="token punctuation">.</span>zeros<span class="token punctuation">(</span><span class="token punctuation">(</span>N<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span> dtype<span class="token operator">=</span>np<span class="token punctuation">.</span>int32<span class="token punctuation">)</span> <span class="token operator">+</span> self<span class="token punctuation">.</span>_start
      prev_h<span class="token punctuation">,</span> affine_cache <span class="token operator">=</span> affine_forward<span class="token punctuation">(</span>features<span class="token punctuation">,</span> W_proj<span class="token punctuation">,</span> b_proj<span class="token punctuation">)</span>
      N<span class="token punctuation">,</span> H <span class="token operator">=</span> prev_h<span class="token punctuation">.</span>shape
      prev_c <span class="token operator">=</span> np<span class="token punctuation">.</span>zeros<span class="token punctuation">(</span><span class="token punctuation">(</span>N<span class="token punctuation">,</span>H<span class="token punctuation">)</span><span class="token punctuation">)</span>
      <span class="token keyword">for</span> t <span class="token keyword">in</span> <span class="token builtin">xrange</span><span class="token punctuation">(</span>max_length<span class="token punctuation">)</span><span class="token punctuation">:</span>
        embed_out<span class="token punctuation">,</span> embed_cache <span class="token operator">=</span> word_embedding_forward<span class="token punctuation">(</span>prev_word<span class="token punctuation">,</span> W_embed<span class="token punctuation">)</span>
        embed_out <span class="token operator">=</span> embed_out<span class="token punctuation">.</span>reshape<span class="token punctuation">(</span><span class="token punctuation">(</span>embed_out<span class="token punctuation">.</span>shape<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span>embed_out<span class="token punctuation">.</span>shape<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        h<span class="token punctuation">,</span> c<span class="token punctuation">,</span> lstm_cache <span class="token operator">=</span> lstm_step_forward<span class="token punctuation">(</span>embed_out<span class="token punctuation">,</span> prev_c<span class="token punctuation">,</span> prev_h<span class="token punctuation">,</span> Wx<span class="token punctuation">,</span> Wh<span class="token punctuation">,</span> b<span class="token punctuation">)</span>
        scores<span class="token punctuation">,</span> affine_cache <span class="token operator">=</span> affine_forward<span class="token punctuation">(</span>h<span class="token punctuation">,</span> W_vocab<span class="token punctuation">,</span> b_vocab<span class="token punctuation">)</span>
        prev_word <span class="token operator">=</span> captions<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span> t<span class="token punctuation">]</span> <span class="token operator">=</span> scores<span class="token punctuation">.</span>argmax<span class="token punctuation">(</span>axis<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span>
        prev_word <span class="token operator">=</span> prev_word<span class="token punctuation">.</span>reshape<span class="token punctuation">(</span>N<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>
        prev_h <span class="token operator">=</span> h
        prev_c <span class="token operator">=</span> c

    <span class="token comment">############################################################################</span>
    <span class="token comment">#                             END OF YOUR CODE                             #</span>
    <span class="token comment">############################################################################</span>
    <span class="token keyword">return</span> captions</code></pre></div>
<h3>Q2: Image Captioning with LSTMs</h3>
<p>The IPython notebook <code class="language-text">LSTM_Captioning.ipynb</code> walk through the implementation of Long-Short Term Memory (LSTM) RNNs, and apply them to image captioning on MS-COCO.</p>
<p>The file <code class="language-text">cs231n/rnn_layers.py</code> contains implementations of different layer types that are needed for LSTM. The file <code class="language-text">cs231n/classifiers/rnn.py</code> contains implementations of CaptioningRNN class.</p>
<p>run the following command</p>
<div class="gatsby-highlight" data-language="text"><pre class="language-text"><code class="language-text">ipython notebook LSTM_Captioning.ipynb</code></pre></div>
<p><span
      class="gatsby-resp-image-wrapper"
      style="position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 590px; "
    >
      <a
    class="gatsby-resp-image-link"
    href="/static/bc0cd97e8cecd39acb4ff83b762de01f/5754a/q2-1.png"
    style="display: block"
    target="_blank"
    rel="noopener"
  >
    <span
    class="gatsby-resp-image-background-image"
    style="padding-bottom: 82.43243243243244%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAQCAYAAAAWGF8bAAAACXBIWXMAAAsSAAALEgHS3X78AAABTElEQVQ4y63U22qDMBgA4DDYG+1+b7AWVrux59kuxh6iL7Cbzg62XrQgvSgdrSAD6+3AQ2nVoI3URtP98YCTOSbiD4kx0Y8/B0UIwjDw26mFsG37kXtI17GY9R2hxA1KyF92XfcBpRl6L6nHKGsQWSIFaJruqAChZvWnmYG0BO52ntgquNng0eFQgOmDzcEzQvwh7wgCRn9iddAq8Nzz0k3ZbhmNogJrCiKMcbIphDBKSDm7/9BKMM+Qr2EQwCitj1aCjuO85mAMx9TzfmN/LUEluN/vh9kg5TVMnWGcE7UOdhmEhpiBIQzzbYnC8BRBphFsUnIPo3F6rSz5p3efgL7vv7fxc4Cle0pASZIuLcu6Ngyjo6qqoGnrHm+bpt5VFPlWlrXeZPJxt1iowmz22V+tjO5yaXXGY+VmOl0L0L6az7/6g8HzBQIYtRnfOwxJKfKKoLAAAAAASUVORK5CYII='); background-size: cover; display: block;"
  ></span>
  <img
        class="gatsby-resp-image-image"
        alt="q2 1"
        title="q2 1"
        src="/static/bc0cd97e8cecd39acb4ff83b762de01f/fcda8/q2-1.png"
        srcset="/static/bc0cd97e8cecd39acb4ff83b762de01f/12f09/q2-1.png 148w,
/static/bc0cd97e8cecd39acb4ff83b762de01f/e4a3f/q2-1.png 295w,
/static/bc0cd97e8cecd39acb4ff83b762de01f/fcda8/q2-1.png 590w,
/static/bc0cd97e8cecd39acb4ff83b762de01f/5754a/q2-1.png 613w"
        sizes="(max-width: 590px) 100vw, 590px"
        style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;"
        loading="lazy"
      />
  </a>
    </span></p>
<p>result</p>
<p><span
      class="gatsby-resp-image-wrapper"
      style="position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 590px; "
    >
      <a
    class="gatsby-resp-image-link"
    href="/static/2937345fd96472e4bb8f9affce60cc93/3dd3e/q2-2.png"
    style="display: block"
    target="_blank"
    rel="noopener"
  >
    <span
    class="gatsby-resp-image-background-image"
    style="padding-bottom: 75%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAPCAYAAADkmO9VAAAACXBIWXMAAAsSAAALEgHS3X78AAAEaElEQVQ4y32TW0yTdwDFP0Xk5mfAcWtkIIIymFWoSlsFWqQCFqG0/cqgQotMsaPcKliVUtksVKBSEYsDlQpRjIBykzhUnI7NTRJadzExezCLutVkl2x7nV//Zzz4up3kl/N0Xs7Joaj/1/K37rvEmiWWvcX3PxMr4nb4BCbl8uPTi8VqadYeqWCTQi/ZnF+dnaIoy9isPSDZpi4TJZcK14ept8RE7pNviS7W79+/r6OlTtFpqpSdMOwvbDZ8mGdpqhWVlzE8KiFpA20sUv1azShwUL4bmpxUtBYJ0V0qwlltNk6rxWhVCFAreR8KXhw0O7kYvPkYc/e/wq1BC0b7LbhgM8HabIBmn+J76tFvoOdn5z3naithrdjDNuorSHOZivRXZhNHpZScrVITW5WGHD+gJaq0rUS2NYlcmnhKph++JDec7d5r58ykx2J802TQoYTJc1PFGw7Sdx7/6Rl7/ArKgkKvUiYlguQU0qzKIAPVMmL/qJRYGhuIMDObZIkLCMPfQmz2YTL62XNypddCnO0NpNVYzeor1CjIFbmp8fsv6Mm7rz1PfgGymVJvGEVhR0gASoSJGKuTou2DdGjkheCsfReHGSWaCySoZgphsY2jz96GLlMN6qsOscXKAqQLkt3Ud3+Dnpz/wzM19xoXnFPeQj4XNflp0CnEOFYiwEVrDbpsneBuFyCOsxZZaRkwH2tGr+08hlsNOK/bi080uay2cBe2Jye4qdGJl/TcU3gGrrshE6R65ZnbIEjlQ5aZgT2SZBw5ooJ5aRiNlI/MlCR0dZzBTK8NX3/agsWhTsz2n8F0i4G1G6qQk5PvppzjP9G3XfD0T/6IjKw8b0etFiMmNe6012PEYUdnWxvsRh0etNdipkWHIedVXLl8A5OTc/jym2/xcPEVTvXdY8XKQzC0Nbmpvonf6ekFr2fK9QabeOleU4MJP7gWsTDcB9f1i7h34SSuHZZj0GKAo8cBfZ0Ru3ZLcUBngP3iTVQZT4GbIWNj4hORJk53U0MzL2hjx5SnrPEyQjmx3lX0ahyvr8HttgrcM5dj1qTBlFWPif5TcM0/wKSpHHWyHRAmxoATQmPpG+CEh7Lh4Rz4+QW5qahoLh0WJ/IEr5dg9RqONyLYnwTTNJErVOTu/Qfk+cJD8sx5kiwsPiNfXD1PntwaIY+mR8nI8XLSZT5GeClbybrYODY4OAT06mA3RS+j6Mj1/J8juXJwUwRvirJS2I3x69iVvr7sZl4qe/q0g/28/yQ7M2BlL5k1rNNhZ+dnxtj5q93s2OwiW1quY8NCQ//xDwhCQGCQiwoJiabf4bz3V0SCFLxUERQSIRJjoxARHooAfz8EBq2CUlUEZ6cREz2NuPKxFr0NanRZrWiy9CBPUYqomFj4+q6Ev3/AMyoiVrxiTXjc3rBoftFG7k5GnZ/NKEU8JjIshImMjGCCAgOYpZ4Y7aFGZrjrKDPWfYRxHC1jegYnmPoTZxlxbgETtS5e6bPcp9jPz1/yL+GlPJA8AJy9AAAAAElFTkSuQmCC'); background-size: cover; display: block;"
  ></span>
  <img
        class="gatsby-resp-image-image"
        alt="q2 2"
        title="q2 2"
        src="/static/2937345fd96472e4bb8f9affce60cc93/fcda8/q2-2.png"
        srcset="/static/2937345fd96472e4bb8f9affce60cc93/12f09/q2-2.png 148w,
/static/2937345fd96472e4bb8f9affce60cc93/e4a3f/q2-2.png 295w,
/static/2937345fd96472e4bb8f9affce60cc93/fcda8/q2-2.png 590w,
/static/2937345fd96472e4bb8f9affce60cc93/3dd3e/q2-2.png 595w"
        sizes="(max-width: 590px) 100vw, 590px"
        style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;"
        loading="lazy"
      />
  </a>
    </span>
<span
      class="gatsby-resp-image-wrapper"
      style="position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 442px; "
    >
      <a
    class="gatsby-resp-image-link"
    href="/static/e6ae15790a41b9e874907fa779a6cca1/e03bf/q2-3.png"
    style="display: block"
    target="_blank"
    rel="noopener"
  >
    <span
    class="gatsby-resp-image-background-image"
    style="padding-bottom: 117.56756756756756%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,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'); background-size: cover; display: block;"
  ></span>
  <img
        class="gatsby-resp-image-image"
        alt="q2 3"
        title="q2 3"
        src="/static/e6ae15790a41b9e874907fa779a6cca1/e03bf/q2-3.png"
        srcset="/static/e6ae15790a41b9e874907fa779a6cca1/12f09/q2-3.png 148w,
/static/e6ae15790a41b9e874907fa779a6cca1/e4a3f/q2-3.png 295w,
/static/e6ae15790a41b9e874907fa779a6cca1/e03bf/q2-3.png 442w"
        sizes="(max-width: 442px) 100vw, 442px"
        style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;"
        loading="lazy"
      />
  </a>
    </span>
<span
      class="gatsby-resp-image-wrapper"
      style="position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 590px; "
    >
      <a
    class="gatsby-resp-image-link"
    href="/static/879ffa3d21a298c9e586e420a9b4a85b/3dd3e/q2-4.png"
    style="display: block"
    target="_blank"
    rel="noopener"
  >
    <span
    class="gatsby-resp-image-background-image"
    style="padding-bottom: 82.43243243243244%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAQCAYAAAAWGF8bAAAACXBIWXMAAAsSAAALEgHS3X78AAAEpklEQVQ4y4WSaUyTBwCGP/dT/UKMiXEWFaGVgkChQlEsRwuCLYeI2MMCttyggLYI7eRQoCBt5FLACCgIiHITSwVvDoVPqEcz545syRLXZHOJyRK3ZH7f9+6Iv7fnz/v+eJL3z0sQ/8+aT0l+6mv+0zbtIz4z6xP2n68qUBYq49XHZFKVxXRObR+8qRzptik7NbW5AxMzx6Zn72ZN2Ga0ff0jmU6nQ1Faolcpk5NTY8KEKl2qTHlCp0w3Gkr2ES2dnWR3S+mvEz1G1Bdr8IUqDgN1Z7B4qxcvWkfxwTCFpdEZfP/yOb51foMfH0ziu7kltFh60VakhbXmDBrrz6KqyoCKymwnAYDsvTX109myYhSrDtAFkiDGnJ7AXDOXMcvnzjOvtc3sythtdnlyiP3h2TL77m4T89DSzIw0PWAom52xDc8wV7vHPnZ1DeJSa8MqoS+tI3WqTFdyrAy6pEimNlvBtlcWs+OXrOxX80vs49mn7LPFFfa6qZadH2xjqeErrL1az96yNrBfP33BvpyeZedGbfT8hB13R6ZXCQEvgJRHSlxhu4Pgw93G8L3ckSrfj1eON/iHP377HdT9aazOPcQT2zheLT/F64UFFB7LgWCXH6Tivcg9mkIbC3XQ52Q4iAiRmEySSlzhIULs9Pic2c3joOZMA3r6+9DccQFTszN4frsXYx1WLN+5h5/fffh3aOHJl8jMLIenhwd4HlvowF1eEAXxHYRKHk8ejpO6ZOHBaD1Xwzy6bcebFQd6rOUoz1Kgod6CB4PdGLI0YqC9C1pDCe6Pj+KXt+9xb2YJ6fJoyML86ZQYEY4mRTqIlNhwUhYpdjWezsWCfZZZXHRistsCk1aNnobLWF1yoK+9Hp3VBWgrzUKaKh1m03k4F5zo6RpAXmo8NJG7aHW0EMkRAsffT1xHlufpXHPDHTilUzByiRQ1p/KQkayEQVuEO7YbmLpZi6FGDVrjBaiQBKCr5SqudfRjangYL58s4lq9gS7TSJGfLHYQ1Sf05PjFOldjWR5sk/eZriuDqKm2Qp0kQbsxEebTBphL0nAjX4bpygzkxkehtrwCj8eGMNF/A4uP5jFnn6abSlJRkSV3EPN9l0lrfb6rtDgfJ/THmZQUJbKy87HDazskQh4ydflobdbj1Mk4GPNScDJHgzRFMA7G7saefYHwjdoMSYofbdYfQqXugIMwNR8hD+ZHu8pMxUjIFTMiWSCCIwTwFu6ATzgXTcO5uDJaiBxLOAqMYWgzGFBw+hDS1ALkVCUhsy4WimoRXXRJgfKigw4iWOJHhsi5bzNK1AhV8D8GxnHpbbwttF+oBy1K8KYPHw+lyyxJtMF8mK4wRNOP0qLoZwYl/bgyla6+UETrjEfoxOPCPxMLY5CREb1CbOK4kZ5cznvNkaPw9ebCX8xFkISHaK0v+CHu8OF5gsfbij1BPOgSQyEVbsXJMHdkx/jA128HPN09sIWzEdu2boYowP81cWh/1FpZhMgeEx7sCA3kL4sCvakQ0U6Kz99OuZFu1Pq1aym3deupDSRJbdq4geJwOBTX35va6eNFCfieVKjAi4oV+S4ligOccXv9rv8FdvuWZAvSsmcAAAAASUVORK5CYII='); background-size: cover; display: block;"
  ></span>
  <img
        class="gatsby-resp-image-image"
        alt="q2 4"
        title="q2 4"
        src="/static/879ffa3d21a298c9e586e420a9b4a85b/fcda8/q2-4.png"
        srcset="/static/879ffa3d21a298c9e586e420a9b4a85b/12f09/q2-4.png 148w,
/static/879ffa3d21a298c9e586e420a9b4a85b/e4a3f/q2-4.png 295w,
/static/879ffa3d21a298c9e586e420a9b4a85b/fcda8/q2-4.png 590w,
/static/879ffa3d21a298c9e586e420a9b4a85b/3dd3e/q2-4.png 595w"
        sizes="(max-width: 590px) 100vw, 590px"
        style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;"
        loading="lazy"
      />
  </a>
    </span>
<span
      class="gatsby-resp-image-wrapper"
      style="position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 590px; "
    >
      <a
    class="gatsby-resp-image-link"
    href="/static/3c91bcb587d44182d7d6d050f6f72242/1568e/q2-5.png"
    style="display: block"
    target="_blank"
    rel="noopener"
  >
    <span
    class="gatsby-resp-image-background-image"
    style="padding-bottom: 50%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAYAAAC0VX7mAAAACXBIWXMAAAsSAAALEgHS3X78AAACqElEQVQoz2XSTUzTYBgH8Dkik9iiBwQSPcLFREEPxhhikEEwHBRCvMCGxKBLIJEQBwGHBCMQCFpHQCRRIozh2EfXbu3Kvtpu3cbGMEA2vXn04NmLhm57bBtwB5s8eT/S/y/vl0qlUp2VCpGrtLQUqai4cA5B0WoELa9EUUSq8ioEQS8iCHJJo9FUnikrq7paX1dlHDZWt3d0nJdyqFqtlvPosaUqabzTfFruWG34TZzcPnQRTIak/BkPHch6qMBXwruddRG+rJtkMjjhyywtr2b1Dw2HpomZ79K8Vs5qW+5qZEvuqwDglNxSDNfMRVPARZMgJPYgntxXWl5IQiSWBoZLQVf3E6ipvQ6tbZ1AeINAUsFOOfvj5y+16uQjvAFl4PPzTYGwAJyQyrGRVC7MJfIsv5PnhN08H0vn348P5fQNdTltY0uO3ub+SP+A1eZuP95dyT8wyAoK6A9FtJHYLjBMsBCNxgvpg2+ws7sP4XAU7OY5IOdGwdyvg1fGp0D5QkcfVq2w5aI75OxnO1kEQydggNXGUgdg6m4rPGu9VVhfXIaPC0vw1jQOljfzMGMcgQm9DmaGR+Dl5PSRdL5gc3oV0ObwFEEuklBAjo9pI0IKzNNThZ76y4W+240w+qgP5kzPYaBHB7OmF0A43ODCveAkfEchfgeklSmg3UUVQbP5nQJi2GLT8tIKWDZs4tTggDjWqxPnDV1i740a0TQ0KPKJL6KXYUUPHRLdHv9v6UJksP2/LeNuSgEdTrKV4+PAsgKM9T+Gew3XYLLnPljnZ8HvC0KITwLj50G6EJBA8IdjsLbheCBn162OIhhmBeXZCPF0LYF7Fkg3jZkMeszQ3YkFhD0sHN/D6ACPeeggJr0IzIHT2KadeG3ZdK58smxdkbNrG1vKov4CRDd9gAbwGuIAAAAASUVORK5CYII='); background-size: cover; display: block;"
  ></span>
  <img
        class="gatsby-resp-image-image"
        alt="q2 5"
        title="q2 5"
        src="/static/3c91bcb587d44182d7d6d050f6f72242/fcda8/q2-5.png"
        srcset="/static/3c91bcb587d44182d7d6d050f6f72242/12f09/q2-5.png 148w,
/static/3c91bcb587d44182d7d6d050f6f72242/e4a3f/q2-5.png 295w,
/static/3c91bcb587d44182d7d6d050f6f72242/fcda8/q2-5.png 590w,
/static/3c91bcb587d44182d7d6d050f6f72242/efc66/q2-5.png 885w,
/static/3c91bcb587d44182d7d6d050f6f72242/1568e/q2-5.png 892w"
        sizes="(max-width: 590px) 100vw, 590px"
        style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;"
        loading="lazy"
      />
  </a>
    </span></p>
<p>code: in <code class="language-text">cs231n/rnn_layers.py</code></p>
<div class="gatsby-highlight" data-language="python"><pre class="language-python"><code class="language-python"><span class="token keyword">def</span> <span class="token function">rnn_step_forward</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span> prev_h<span class="token punctuation">,</span> Wx<span class="token punctuation">,</span> Wh<span class="token punctuation">,</span> b<span class="token punctuation">)</span><span class="token punctuation">:</span>
  <span class="token triple-quoted-string string">"""
  Run the forward pass for a single timestep of a vanilla RNN that uses a tanh
  activation function.

  The input data has dimension D, the hidden state has dimension H, and we use
  a minibatch size of N.

  Inputs:
  - x: Input data for this timestep, of shape (N, D).
  - prev_h: Hidden state from previous timestep, of shape (N, H)
  - Wx: Weight matrix for input-to-hidden connections, of shape (D, H)
  - Wh: Weight matrix for hidden-to-hidden connections, of shape (H, H)
  - b: Biases of shape (H,)

  Returns a tuple of:
  - next_h: Next hidden state, of shape (N, H)
  - cache: Tuple of values needed for the backward pass.
  """</span>
  next_h<span class="token punctuation">,</span> cache <span class="token operator">=</span> <span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token boolean">None</span>
  <span class="token comment">##############################################################################</span>
  <span class="token comment"># TODO: Implement a single forward step for the vanilla RNN. Store the next  #</span>
  <span class="token comment"># hidden state and any values you need for the backward pass in the next_h   #</span>
  <span class="token comment"># and cache variables respectively.                                          #</span>
  <span class="token comment">##############################################################################</span>

  next_h <span class="token operator">=</span> np<span class="token punctuation">.</span>tanh<span class="token punctuation">(</span>np<span class="token punctuation">.</span>dot<span class="token punctuation">(</span>x<span class="token punctuation">,</span> Wx<span class="token punctuation">)</span> <span class="token operator">+</span> np<span class="token punctuation">.</span>dot<span class="token punctuation">(</span>prev_h<span class="token punctuation">,</span> Wh<span class="token punctuation">)</span> <span class="token operator">+</span> b<span class="token punctuation">)</span>

  cache <span class="token operator">=</span> <span class="token punctuation">(</span>x<span class="token punctuation">,</span> prev_h<span class="token punctuation">,</span> Wx<span class="token punctuation">,</span> Wh<span class="token punctuation">,</span> next_h<span class="token punctuation">)</span>
  <span class="token comment">##############################################################################</span>
  <span class="token comment">#                               END OF YOUR CODE                             #</span>
  <span class="token comment">##############################################################################</span>
  <span class="token keyword">return</span> next_h<span class="token punctuation">,</span> cache</code></pre></div>
<p>in <code class="language-text">cs231n/rnn_layers.py</code></p>
<div class="gatsby-highlight" data-language="python"><pre class="language-python"><code class="language-python"><span class="token keyword">def</span> <span class="token function">rnn_step_backward</span><span class="token punctuation">(</span>dnext_h<span class="token punctuation">,</span> cache<span class="token punctuation">)</span><span class="token punctuation">:</span>
  <span class="token triple-quoted-string string">"""
  Backward pass for a single timestep of a vanilla RNN.

  Inputs:
  - dnext_h: Gradient of loss with respect to next hidden state
  - cache: Cache object from the forward pass

  Returns a tuple of:
  - dx: Gradients of input data, of shape (N, D)
  - dprev_h: Gradients of previous hidden state, of shape (N, H)
  - dWx: Gradients of input-to-hidden weights, of shape (N, H)
  - dWh: Gradients of hidden-to-hidden weights, of shape (H, H)
  - db: Gradients of bias vector, of shape (H,)
  """</span>
  dx<span class="token punctuation">,</span> dprev_h<span class="token punctuation">,</span> dWx<span class="token punctuation">,</span> dWh<span class="token punctuation">,</span> db <span class="token operator">=</span> <span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token boolean">None</span>
  <span class="token comment">##############################################################################</span>
  <span class="token comment"># TODO: Implement the backward pass for a single step of a vanilla RNN.      #</span>
  <span class="token comment">#                                                                            #</span>
  <span class="token comment"># HINT: For the tanh function, you can compute the local derivative in terms #</span>
  <span class="token comment"># of the output value from tanh.                                             #</span>
  <span class="token comment">##############################################################################</span>

  x<span class="token punctuation">,</span> prev_h<span class="token punctuation">,</span> Wx<span class="token punctuation">,</span> Wh<span class="token punctuation">,</span> next_h <span class="token operator">=</span> cache

  dt <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token number">1</span> <span class="token operator">-</span> next_h <span class="token operator">**</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token operator">*</span> dnext_h
  dx <span class="token operator">=</span> np<span class="token punctuation">.</span>dot<span class="token punctuation">(</span>dt<span class="token punctuation">,</span> np<span class="token punctuation">.</span>transpose<span class="token punctuation">(</span>Wx<span class="token punctuation">)</span><span class="token punctuation">)</span>
  dprev_h <span class="token operator">=</span> np<span class="token punctuation">.</span>dot<span class="token punctuation">(</span>dt<span class="token punctuation">,</span> np<span class="token punctuation">.</span>transpose<span class="token punctuation">(</span>Wh<span class="token punctuation">)</span><span class="token punctuation">)</span>
  dWx <span class="token operator">=</span> np<span class="token punctuation">.</span>dot<span class="token punctuation">(</span>np<span class="token punctuation">.</span>transpose<span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">,</span> dt<span class="token punctuation">)</span>
  dWh <span class="token operator">=</span> np<span class="token punctuation">.</span>dot<span class="token punctuation">(</span>np<span class="token punctuation">.</span>transpose<span class="token punctuation">(</span>prev_h<span class="token punctuation">)</span><span class="token punctuation">,</span> dt<span class="token punctuation">)</span>
  db <span class="token operator">=</span> np<span class="token punctuation">.</span><span class="token builtin">sum</span><span class="token punctuation">(</span>dt<span class="token punctuation">,</span> axis<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">)</span>

  <span class="token comment">##############################################################################</span>
  <span class="token comment">#                               END OF YOUR CODE                             #</span>
  <span class="token comment">##############################################################################</span>
  <span class="token keyword">return</span> dx<span class="token punctuation">,</span> dprev_h<span class="token punctuation">,</span> dWx<span class="token punctuation">,</span> dWh<span class="token punctuation">,</span> db</code></pre></div>
<p>in <code class="language-text">cs231n/rnn_layers.py</code></p>
<div class="gatsby-highlight" data-language="python"><pre class="language-python"><code class="language-python"><span class="token keyword">def</span> <span class="token function">rnn_forward</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span> h0<span class="token punctuation">,</span> Wx<span class="token punctuation">,</span> Wh<span class="token punctuation">,</span> b<span class="token punctuation">)</span><span class="token punctuation">:</span>
  <span class="token triple-quoted-string string">"""
  Run a vanilla RNN forward on an entire sequence of data. We assume an input
  sequence composed of T vectors, each of dimension D. The RNN uses a hidden
  size of H, and we work over a minibatch containing N sequences. After running
  the RNN forward, we return the hidden states for all timesteps.

  Inputs:
  - x: Input data for the entire timeseries, of shape (N, T, D).
  - h0: Initial hidden state, of shape (N, H)
  - Wx: Weight matrix for input-to-hidden connections, of shape (D, H)
  - Wh: Weight matrix for hidden-to-hidden connections, of shape (H, H)
  - b: Biases of shape (H,)

  Returns a tuple of:
  - h: Hidden states for the entire timeseries, of shape (N, T, H).
  - cache: Values needed in the backward pass
  """</span>
  h<span class="token punctuation">,</span> cache <span class="token operator">=</span> <span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token boolean">None</span>
  <span class="token comment">##############################################################################</span>
  <span class="token comment"># TODO: Implement forward pass for a vanilla RNN running on a sequence of    #</span>
  <span class="token comment"># input data. You should use the rnn_step_forward function that you defined  #</span>
  <span class="token comment"># above.                                                                     #</span>
  <span class="token comment">##############################################################################</span>

  N<span class="token punctuation">,</span> T<span class="token punctuation">,</span> D <span class="token operator">=</span> x<span class="token punctuation">.</span>shape
  N<span class="token punctuation">,</span> H <span class="token operator">=</span> h0<span class="token punctuation">.</span>shape
  h <span class="token operator">=</span> np<span class="token punctuation">.</span>zeros<span class="token punctuation">(</span><span class="token punctuation">(</span>N<span class="token punctuation">,</span> T<span class="token punctuation">,</span> H<span class="token punctuation">)</span><span class="token punctuation">)</span>
  cache <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
  prev_h <span class="token operator">=</span> h0
  <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">xrange</span><span class="token punctuation">(</span>T<span class="token punctuation">)</span><span class="token punctuation">:</span>
    prev_h<span class="token punctuation">,</span> _cache <span class="token operator">=</span> rnn_step_forward<span class="token punctuation">(</span>x<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span> i<span class="token punctuation">,</span> <span class="token punctuation">:</span><span class="token punctuation">]</span><span class="token punctuation">,</span> prev_h<span class="token punctuation">,</span> Wx<span class="token punctuation">,</span> Wh<span class="token punctuation">,</span> b<span class="token punctuation">)</span>
    cache<span class="token punctuation">.</span>append<span class="token punctuation">(</span>_cache<span class="token punctuation">)</span>
    h<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span> i<span class="token punctuation">,</span> <span class="token punctuation">:</span><span class="token punctuation">]</span> <span class="token operator">=</span> prev_h

  <span class="token comment">##############################################################################</span>
  <span class="token comment">#                               END OF YOUR CODE                             #</span>
  <span class="token comment">##############################################################################</span>
  <span class="token keyword">return</span> h<span class="token punctuation">,</span> cache</code></pre></div>
<p>in <code class="language-text">cs231n/rnn_layers.py</code></p>
<div class="gatsby-highlight" data-language="python"><pre class="language-python"><code class="language-python"><span class="token keyword">def</span> <span class="token function">rnn_backward</span><span class="token punctuation">(</span>dh<span class="token punctuation">,</span> cache<span class="token punctuation">)</span><span class="token punctuation">:</span>
  <span class="token triple-quoted-string string">"""
  Compute the backward pass for a vanilla RNN over an entire sequence of data.

  Inputs:
  - dh: Upstream gradients of all hidden states, of shape (N, T, H)

  Returns a tuple of:
  - dx: Gradient of inputs, of shape (N, T, D)
  - dh0: Gradient of initial hidden state, of shape (N, H)
  - dWx: Gradient of input-to-hidden weights, of shape (D, H)
  - dWh: Gradient of hidden-to-hidden weights, of shape (H, H)
  - db: Gradient of biases, of shape (H,)
  """</span>
  dx<span class="token punctuation">,</span> dh0<span class="token punctuation">,</span> dWx<span class="token punctuation">,</span> dWh<span class="token punctuation">,</span> db <span class="token operator">=</span> <span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token boolean">None</span>
  <span class="token comment">##############################################################################</span>
  <span class="token comment"># TODO: Implement the backward pass for a vanilla RNN running an entire      #</span>
  <span class="token comment"># sequence of data. You should use the rnn_step_backward function that you   #</span>
  <span class="token comment"># defined above.                                                             #</span>
  <span class="token comment">##############################################################################</span>

  N<span class="token punctuation">,</span> T<span class="token punctuation">,</span> H <span class="token operator">=</span> dh<span class="token punctuation">.</span>shape
  N<span class="token punctuation">,</span> D <span class="token operator">=</span> cache<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>shape
  dx <span class="token operator">=</span> np<span class="token punctuation">.</span>zeros<span class="token punctuation">(</span><span class="token punctuation">(</span>N<span class="token punctuation">,</span> T<span class="token punctuation">,</span> D<span class="token punctuation">)</span><span class="token punctuation">)</span>
  dh0 <span class="token operator">=</span> np<span class="token punctuation">.</span>zeros<span class="token punctuation">(</span><span class="token punctuation">(</span>N<span class="token punctuation">,</span> H<span class="token punctuation">)</span><span class="token punctuation">)</span>
  dWx <span class="token operator">=</span> np<span class="token punctuation">.</span>zeros<span class="token punctuation">(</span><span class="token punctuation">(</span>D<span class="token punctuation">,</span> H<span class="token punctuation">)</span><span class="token punctuation">)</span>
  dWh <span class="token operator">=</span> np<span class="token punctuation">.</span>zeros<span class="token punctuation">(</span><span class="token punctuation">(</span>H<span class="token punctuation">,</span> H<span class="token punctuation">)</span><span class="token punctuation">)</span>
  db <span class="token operator">=</span> np<span class="token punctuation">.</span>zeros<span class="token punctuation">(</span>H<span class="token punctuation">)</span>
  dprevh<span class="token operator">=</span> np<span class="token punctuation">.</span>zeros<span class="token punctuation">(</span><span class="token punctuation">(</span>N<span class="token punctuation">,</span> H<span class="token punctuation">)</span><span class="token punctuation">)</span>
  <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">xrange</span><span class="token punctuation">(</span>T <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    t_dx<span class="token punctuation">,</span> t_dprevh<span class="token punctuation">,</span> t_dWx<span class="token punctuation">,</span> t_dWh<span class="token punctuation">,</span> t_db <span class="token operator">=</span> rnn_step_backward<span class="token punctuation">(</span>dh<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span>i<span class="token punctuation">,</span><span class="token punctuation">:</span><span class="token punctuation">]</span> <span class="token operator">+</span> dprevh<span class="token punctuation">,</span> cache<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span>
    dx<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span>i<span class="token punctuation">,</span><span class="token punctuation">:</span><span class="token punctuation">]</span> <span class="token operator">=</span> t_dx
    dWx <span class="token operator">+=</span> t_dWx
    dWh <span class="token operator">+=</span> t_dWh
    db <span class="token operator">+=</span> t_db
    dprevh <span class="token operator">=</span> t_dprevh
  dh0 <span class="token operator">=</span> dprevh

  <span class="token comment">##############################################################################</span>
  <span class="token comment">#                               END OF YOUR CODE                             #</span>
  <span class="token comment">##############################################################################</span>
  <span class="token keyword">return</span> dx<span class="token punctuation">,</span> dh0<span class="token punctuation">,</span> dWx<span class="token punctuation">,</span> dWh<span class="token punctuation">,</span> db</code></pre></div>
<p>in <code class="language-text">cs231n/rnn_layers.py</code></p>
<div class="gatsby-highlight" data-language="python"><pre class="language-python"><code class="language-python"><span class="token keyword">def</span> <span class="token function">word_embedding_forward</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span> W<span class="token punctuation">)</span><span class="token punctuation">:</span>
  <span class="token triple-quoted-string string">"""
  Forward pass for word embeddings. We operate on minibatches of size N where
  each sequence has length T. We assume a vocabulary of V words, assigning each
  to a vector of dimension D.

  Inputs:
  - x: Integer array of shape (N, T) giving indices of words. Each element idx
    of x muxt be in the range 0 &lt;= idx &lt; V.
  - W: Weight matrix of shape (V, D) giving word vectors for all words.

  Returns a tuple of:
  - out: Array of shape (N, T, D) giving word vectors for all input words.
  - cache: Values needed for the backward pass
  """</span>
  out<span class="token punctuation">,</span> cache <span class="token operator">=</span> <span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token boolean">None</span>
  <span class="token comment">##############################################################################</span>
  <span class="token comment"># TODO: Implement the forward pass for word embeddings.                      #</span>
  <span class="token comment">#                                                                            #</span>
  <span class="token comment"># HINT: This should be very simple.                                          #</span>
  <span class="token comment">##############################################################################</span>

  N<span class="token punctuation">,</span> T <span class="token operator">=</span> x<span class="token punctuation">.</span>shape
  V<span class="token punctuation">,</span> D <span class="token operator">=</span> W<span class="token punctuation">.</span>shape
  out <span class="token operator">=</span> np<span class="token punctuation">.</span>zeros<span class="token punctuation">(</span><span class="token punctuation">(</span>N<span class="token punctuation">,</span> T<span class="token punctuation">,</span> D<span class="token punctuation">)</span><span class="token punctuation">)</span>
  <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">xrange</span><span class="token punctuation">(</span>N<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">for</span> j <span class="token keyword">in</span> <span class="token builtin">xrange</span><span class="token punctuation">(</span>T<span class="token punctuation">)</span><span class="token punctuation">:</span>
      out<span class="token punctuation">[</span>i<span class="token punctuation">,</span> j<span class="token punctuation">]</span> <span class="token operator">=</span> W<span class="token punctuation">[</span>x<span class="token punctuation">[</span>i<span class="token punctuation">,</span> j<span class="token punctuation">]</span><span class="token punctuation">]</span>

  cache <span class="token operator">=</span> <span class="token punctuation">(</span>x<span class="token punctuation">,</span> W<span class="token punctuation">,</span> out<span class="token punctuation">)</span>

  <span class="token comment">##############################################################################</span>
  <span class="token comment">#                               END OF YOUR CODE                             #</span>
  <span class="token comment">##############################################################################</span>
  <span class="token keyword">return</span> out<span class="token punctuation">,</span> cache</code></pre></div>
<p>in <code class="language-text">cs231n/rnn_layers.py</code></p>
<div class="gatsby-highlight" data-language="python"><pre class="language-python"><code class="language-python"><span class="token keyword">def</span> <span class="token function">word_embedding_backward</span><span class="token punctuation">(</span>dout<span class="token punctuation">,</span> cache<span class="token punctuation">)</span><span class="token punctuation">:</span>
  <span class="token triple-quoted-string string">"""
  Backward pass for word embeddings. We cannot back-propagate into the words
  since they are integers, so we only return gradient for the word embedding
  matrix.

  HINT: Look up the function np.add.at

  Inputs:
  - dout: Upstream gradients of shape (N, T, D)
  - cache: Values from the forward pass

  Returns:
  - dW: Gradient of word embedding matrix, of shape (V, D).
  """</span>
  dW <span class="token operator">=</span> <span class="token boolean">None</span>
  <span class="token comment">##############################################################################</span>
  <span class="token comment"># TODO: Implement the backward pass for word embeddings.                     #</span>
  <span class="token comment">#                                                                            #</span>
  <span class="token comment"># HINT: Look up the function np.add.at                                       #</span>
  <span class="token comment">##############################################################################</span>

  x<span class="token punctuation">,</span> W<span class="token punctuation">,</span> o <span class="token operator">=</span> cache
  dW <span class="token operator">=</span> np<span class="token punctuation">.</span>zeros<span class="token punctuation">(</span><span class="token punctuation">(</span>W<span class="token punctuation">.</span>shape<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> dout<span class="token punctuation">.</span>shape<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
  np<span class="token punctuation">.</span>add<span class="token punctuation">.</span>at<span class="token punctuation">(</span>dW<span class="token punctuation">,</span> x<span class="token punctuation">,</span> dout<span class="token punctuation">)</span>

  <span class="token comment">##############################################################################</span>
  <span class="token comment">#                               END OF YOUR CODE                             #</span>
  <span class="token comment">##############################################################################</span>
  <span class="token keyword">return</span> dW</code></pre></div>
<p>in <code class="language-text">cs231n/rnn_layers.py</code></p>
<div class="gatsby-highlight" data-language="python"><pre class="language-python"><code class="language-python"><span class="token keyword">def</span> <span class="token function">lstm_step_forward</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span> prev_h<span class="token punctuation">,</span> prev_c<span class="token punctuation">,</span> Wx<span class="token punctuation">,</span> Wh<span class="token punctuation">,</span> b<span class="token punctuation">)</span><span class="token punctuation">:</span>
  <span class="token triple-quoted-string string">"""
  Forward pass for a single timestep of an LSTM.

  The input data has dimension D, the hidden state has dimension H, and we use
  a minibatch size of N.

  Inputs:
  - x: Input data, of shape (N, D)
  - prev_h: Previous hidden state, of shape (N, H)
  - prev_c: previous cell state, of shape (N, H)
  - Wx: Input-to-hidden weights, of shape (D, 4H)
  - Wh: Hidden-to-hidden weights, of shape (H, 4H)
  - b: Biases, of shape (4H,)

  Returns a tuple of:
  - next_h: Next hidden state, of shape (N, H)
  - next_c: Next cell state, of shape (N, H)
  - cache: Tuple of values needed for backward pass.
  """</span>
  next_h<span class="token punctuation">,</span> next_c<span class="token punctuation">,</span> cache <span class="token operator">=</span> <span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token boolean">None</span>
  <span class="token comment">#############################################################################</span>
  <span class="token comment"># TODO: Implement the forward pass for a single timestep of an LSTM.        #</span>
  <span class="token comment"># You may want to use the numerically stable sigmoid implementation above.  #</span>
  <span class="token comment">#############################################################################</span>

  N<span class="token punctuation">,</span> H <span class="token operator">=</span> prev_h<span class="token punctuation">.</span>shape
  a <span class="token operator">=</span> np<span class="token punctuation">.</span>dot<span class="token punctuation">(</span>prev_h<span class="token punctuation">,</span> Wh<span class="token punctuation">)</span> <span class="token operator">+</span> np<span class="token punctuation">.</span>dot<span class="token punctuation">(</span>x<span class="token punctuation">,</span> Wx<span class="token punctuation">)</span> <span class="token operator">+</span> b
  i <span class="token operator">=</span> sigmoid<span class="token punctuation">(</span>a<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span><span class="token punctuation">:</span>H<span class="token punctuation">]</span><span class="token punctuation">)</span>
  f <span class="token operator">=</span> sigmoid<span class="token punctuation">(</span>a<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span>H<span class="token punctuation">:</span><span class="token number">2</span><span class="token operator">*</span>H<span class="token punctuation">]</span><span class="token punctuation">)</span>
  o <span class="token operator">=</span> sigmoid<span class="token punctuation">(</span>a<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token operator">*</span>H<span class="token punctuation">:</span><span class="token number">3</span><span class="token operator">*</span>H<span class="token punctuation">]</span><span class="token punctuation">)</span>
  g <span class="token operator">=</span> np<span class="token punctuation">.</span>tanh<span class="token punctuation">(</span>a<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token operator">*</span>H<span class="token punctuation">:</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
  next_c <span class="token operator">=</span> g<span class="token operator">*</span>i <span class="token operator">+</span> prev_c<span class="token operator">*</span>f
  next_h <span class="token operator">=</span> np<span class="token punctuation">.</span>tanh<span class="token punctuation">(</span>next_c<span class="token punctuation">)</span> <span class="token operator">*</span> o
  cache <span class="token operator">=</span> <span class="token punctuation">(</span>next_c<span class="token punctuation">,</span> i<span class="token punctuation">,</span> f<span class="token punctuation">,</span> o<span class="token punctuation">,</span> g<span class="token punctuation">,</span> a<span class="token punctuation">,</span> x<span class="token punctuation">,</span> Wx<span class="token punctuation">,</span> Wh<span class="token punctuation">,</span> prev_h<span class="token punctuation">,</span> prev_c<span class="token punctuation">)</span>

  <span class="token comment">##############################################################################</span>
  <span class="token comment">#                               END OF YOUR CODE                             #</span>
  <span class="token comment">##############################################################################</span>

  <span class="token keyword">return</span> next_h<span class="token punctuation">,</span> next_c<span class="token punctuation">,</span> cache</code></pre></div>
<p>in <code class="language-text">cs231n/rnn_layers.py</code></p>
<div class="gatsby-highlight" data-language="python"><pre class="language-python"><code class="language-python"><span class="token keyword">def</span> <span class="token function">lstm_step_backward</span><span class="token punctuation">(</span>dnext_h<span class="token punctuation">,</span> dnext_c<span class="token punctuation">,</span> cache<span class="token punctuation">)</span><span class="token punctuation">:</span>
  <span class="token triple-quoted-string string">"""
  Backward pass for a single timestep of an LSTM.

  Inputs:
  - dnext_h: Gradients of next hidden state, of shape (N, H)
  - dnext_c: Gradients of next cell state, of shape (N, H)
  - cache: Values from the forward pass

  Returns a tuple of:
  - dx: Gradient of input data, of shape (N, D)
  - dprev_h: Gradient of previous hidden state, of shape (N, H)
  - dprev_c: Gradient of previous cell state, of shape (N, H)
  - dWx: Gradient of input-to-hidden weights, of shape (D, 4H)
  - dWh: Gradient of hidden-to-hidden weights, of shape (H, 4H)
  - db: Gradient of biases, of shape (4H,)
  """</span>
  dx<span class="token punctuation">,</span> dh<span class="token punctuation">,</span> dc<span class="token punctuation">,</span> dWx<span class="token punctuation">,</span> dWh<span class="token punctuation">,</span> db <span class="token operator">=</span> <span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token boolean">None</span>
  <span class="token comment">#############################################################################</span>
  <span class="token comment"># TODO: Implement the backward pass for a single timestep of an LSTM.       #</span>
  <span class="token comment">#                                                                           #</span>
  <span class="token comment"># HINT: For sigmoid and tanh you can compute local derivatives in terms of  #</span>
  <span class="token comment"># the output value from the nonlinearity.                                   #</span>
  <span class="token comment">#############################################################################</span>

  next_c<span class="token punctuation">,</span> i<span class="token punctuation">,</span> f<span class="token punctuation">,</span> o<span class="token punctuation">,</span> g<span class="token punctuation">,</span> a<span class="token punctuation">,</span> x<span class="token punctuation">,</span> Wx<span class="token punctuation">,</span> Wh<span class="token punctuation">,</span> prev_h<span class="token punctuation">,</span> prev_c <span class="token operator">=</span> cache
  dnext_c <span class="token operator">=</span> dnext_c <span class="token operator">+</span> <span class="token punctuation">(</span>dnext_h<span class="token operator">*</span>o<span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token punctuation">(</span><span class="token number">1</span> <span class="token operator">-</span> np<span class="token punctuation">.</span>tanh<span class="token punctuation">(</span>next_c<span class="token punctuation">)</span><span class="token operator">**</span><span class="token number">2</span><span class="token punctuation">)</span>
  dprev_c <span class="token operator">=</span> dnext_c<span class="token operator">*</span>f
  di <span class="token operator">=</span> g<span class="token operator">*</span>dnext_c
  df <span class="token operator">=</span> dnext_c<span class="token operator">*</span>prev_c
  do <span class="token operator">=</span> np<span class="token punctuation">.</span>tanh<span class="token punctuation">(</span>next_c<span class="token punctuation">)</span><span class="token operator">*</span>dnext_h
  dg <span class="token operator">=</span> dnext_c<span class="token operator">*</span>i
  da <span class="token operator">=</span> np<span class="token punctuation">.</span>zeros<span class="token punctuation">(</span>a<span class="token punctuation">.</span>shape<span class="token punctuation">)</span>
  H <span class="token operator">=</span> next_c<span class="token punctuation">.</span>shape<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span>
  da<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span><span class="token punctuation">:</span>H<span class="token punctuation">]</span> <span class="token operator">=</span> di<span class="token operator">*</span>i<span class="token operator">*</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token operator">-</span>i<span class="token punctuation">)</span>
  da<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span>H<span class="token punctuation">:</span><span class="token number">2</span><span class="token operator">*</span>H<span class="token punctuation">]</span> <span class="token operator">=</span> df<span class="token operator">*</span>f<span class="token operator">*</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token operator">-</span>f<span class="token punctuation">)</span>
  da<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token operator">*</span>H<span class="token punctuation">:</span><span class="token number">3</span><span class="token operator">*</span>H<span class="token punctuation">]</span> <span class="token operator">=</span> do<span class="token operator">*</span>o<span class="token operator">*</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token operator">-</span>o<span class="token punctuation">)</span>
  da<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token operator">*</span>H<span class="token punctuation">:</span><span class="token punctuation">]</span> <span class="token operator">=</span> dg<span class="token operator">*</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token operator">-</span>g<span class="token operator">**</span><span class="token number">2</span><span class="token punctuation">)</span>
  db <span class="token operator">=</span> np<span class="token punctuation">.</span><span class="token builtin">sum</span><span class="token punctuation">(</span>da<span class="token punctuation">,</span> axis<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">)</span>
  dWx <span class="token operator">=</span> np<span class="token punctuation">.</span>dot<span class="token punctuation">(</span>np<span class="token punctuation">.</span>transpose<span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">,</span> da<span class="token punctuation">)</span>
  dWh <span class="token operator">=</span> np<span class="token punctuation">.</span>dot<span class="token punctuation">(</span>np<span class="token punctuation">.</span>transpose<span class="token punctuation">(</span>prev_h<span class="token punctuation">)</span><span class="token punctuation">,</span> da<span class="token punctuation">)</span>
  dx <span class="token operator">=</span> np<span class="token punctuation">.</span>dot<span class="token punctuation">(</span>da<span class="token punctuation">,</span> np<span class="token punctuation">.</span>transpose<span class="token punctuation">(</span>Wx<span class="token punctuation">)</span><span class="token punctuation">)</span>
  dprev_h <span class="token operator">=</span> np<span class="token punctuation">.</span>dot<span class="token punctuation">(</span>da<span class="token punctuation">,</span> np<span class="token punctuation">.</span>transpose<span class="token punctuation">(</span>Wh<span class="token punctuation">)</span><span class="token punctuation">)</span>

  <span class="token comment">##############################################################################</span>
  <span class="token comment">#                               END OF YOUR CODE                             #</span>
  <span class="token comment">##############################################################################</span>

  <span class="token keyword">return</span> dx<span class="token punctuation">,</span> dprev_h<span class="token punctuation">,</span> dprev_c<span class="token punctuation">,</span> dWx<span class="token punctuation">,</span> dWh<span class="token punctuation">,</span> db</code></pre></div>
<p>in <code class="language-text">cs231n/rnn_layers.py</code></p>
<div class="gatsby-highlight" data-language="python"><pre class="language-python"><code class="language-python"><span class="token keyword">def</span> <span class="token function">lstm_forward</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span> h0<span class="token punctuation">,</span> Wx<span class="token punctuation">,</span> Wh<span class="token punctuation">,</span> b<span class="token punctuation">)</span><span class="token punctuation">:</span>
  <span class="token triple-quoted-string string">"""
  Forward pass for an LSTM over an entire sequence of data. We assume an input
  sequence composed of T vectors, each of dimension D. The LSTM uses a hidden
  size of H, and we work over a minibatch containing N sequences. After running
  the LSTM forward, we return the hidden states for all timesteps.

  Note that the initial cell state is passed as input, but the initial cell
  state is set to zero. Also note that the cell state is not returned; it is
  an internal variable to the LSTM and is not accessed from outside.

  Inputs:
  - x: Input data of shape (N, T, D)
  - h0: Initial hidden state of shape (N, H)
  - Wx: Weights for input-to-hidden connections, of shape (D, 4H)
  - Wh: Weights for hidden-to-hidden connections, of shape (H, 4H)
  - b: Biases of shape (4H,)

  Returns a tuple of:
  - h: Hidden states for all timesteps of all sequences, of shape (N, T, H)
  - cache: Values needed for the backward pass.
  """</span>
  h<span class="token punctuation">,</span> cache <span class="token operator">=</span> <span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token boolean">None</span>
  <span class="token comment">#############################################################################</span>
  <span class="token comment"># TODO: Implement the forward pass for an LSTM over an entire timeseries.   #</span>
  <span class="token comment"># You should use the lstm_step_forward function that you just defined.      #</span>
  <span class="token comment">#############################################################################</span>

  N<span class="token punctuation">,</span> T<span class="token punctuation">,</span> D <span class="token operator">=</span> x<span class="token punctuation">.</span>shape
  N<span class="token punctuation">,</span> H <span class="token operator">=</span> h0<span class="token punctuation">.</span>shape
  h <span class="token operator">=</span> np<span class="token punctuation">.</span>zeros<span class="token punctuation">(</span><span class="token punctuation">(</span>N<span class="token punctuation">,</span> T<span class="token punctuation">,</span> H<span class="token punctuation">)</span><span class="token punctuation">)</span>
  prev_h <span class="token operator">=</span> h0
  prev_c <span class="token operator">=</span> np<span class="token punctuation">.</span>zeros<span class="token punctuation">(</span><span class="token punctuation">(</span>N<span class="token punctuation">,</span> H<span class="token punctuation">)</span><span class="token punctuation">)</span>
  cache <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
  <span class="token keyword">for</span> t <span class="token keyword">in</span> <span class="token builtin">xrange</span><span class="token punctuation">(</span>T<span class="token punctuation">)</span><span class="token punctuation">:</span>
    prev_h<span class="token punctuation">,</span> prev_c<span class="token punctuation">,</span> t_cache <span class="token operator">=</span> lstm_step_forward<span class="token punctuation">(</span>x<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span>t<span class="token punctuation">,</span><span class="token punctuation">:</span><span class="token punctuation">]</span><span class="token punctuation">,</span>prev_h<span class="token punctuation">,</span>prev_c<span class="token punctuation">,</span>Wx<span class="token punctuation">,</span>Wh<span class="token punctuation">,</span>b<span class="token punctuation">)</span>
    h<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span>t<span class="token punctuation">,</span><span class="token punctuation">:</span><span class="token punctuation">]</span> <span class="token operator">=</span> prev_h
    cache<span class="token punctuation">.</span>append<span class="token punctuation">(</span>t_cache<span class="token punctuation">)</span>
  cache <span class="token operator">=</span> <span class="token punctuation">(</span>cache<span class="token punctuation">,</span> D<span class="token punctuation">)</span>

  <span class="token comment">##############################################################################</span>
  <span class="token comment">#                               END OF YOUR CODE                             #</span>
  <span class="token comment">##############################################################################</span>

  <span class="token keyword">return</span> h<span class="token punctuation">,</span> cache</code></pre></div>
<p>in <code class="language-text">cs231n/rnn_layers.py</code></p>
<div class="gatsby-highlight" data-language="python"><pre class="language-python"><code class="language-python"><span class="token keyword">def</span> <span class="token function">lstm_backward</span><span class="token punctuation">(</span>dh<span class="token punctuation">,</span> cache<span class="token punctuation">)</span><span class="token punctuation">:</span>
  <span class="token triple-quoted-string string">"""
  Backward pass for an LSTM over an entire sequence of data.]

  Inputs:
  - dh: Upstream gradients of hidden states, of shape (N, T, H)
  - cache: Values from the forward pass

  Returns a tuple of:
  - dx: Gradient of input data of shape (N, T, D)
  - dh0: Gradient of initial hidden state of shape (N, H)
  - dWx: Gradient of input-to-hidden weight matrix of shape (D, 4H)
  - dWh: Gradient of hidden-to-hidden weight matrix of shape (H, 4H)
  - db: Gradient of biases, of shape (4H,)
  """</span>
  dx<span class="token punctuation">,</span> dh0<span class="token punctuation">,</span> dWx<span class="token punctuation">,</span> dWh<span class="token punctuation">,</span> db <span class="token operator">=</span> <span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token boolean">None</span>
  <span class="token comment">#############################################################################</span>
  <span class="token comment"># TODO: Implement the backward pass for an LSTM over an entire timeseries.  #</span>
  <span class="token comment"># You should use the lstm_step_backward function that you just defined.     #</span>
  <span class="token comment">#############################################################################</span>
  N<span class="token punctuation">,</span> T<span class="token punctuation">,</span> H <span class="token operator">=</span> dh<span class="token punctuation">.</span>shape
  cache<span class="token punctuation">,</span> D <span class="token operator">=</span> cache
  dx <span class="token operator">=</span> np<span class="token punctuation">.</span>zeros<span class="token punctuation">(</span><span class="token punctuation">(</span>N<span class="token punctuation">,</span> T<span class="token punctuation">,</span> D<span class="token punctuation">)</span><span class="token punctuation">)</span>
  dh0 <span class="token operator">=</span> np<span class="token punctuation">.</span>zeros<span class="token punctuation">(</span><span class="token punctuation">(</span>N<span class="token punctuation">,</span> H<span class="token punctuation">)</span><span class="token punctuation">)</span>
  dWx <span class="token operator">=</span> np<span class="token punctuation">.</span>zeros<span class="token punctuation">(</span><span class="token punctuation">(</span>D<span class="token punctuation">,</span> <span class="token number">4</span><span class="token operator">*</span>H<span class="token punctuation">)</span><span class="token punctuation">)</span>
  dWh <span class="token operator">=</span> np<span class="token punctuation">.</span>zeros<span class="token punctuation">(</span><span class="token punctuation">(</span>H<span class="token punctuation">,</span> <span class="token number">4</span><span class="token operator">*</span>H<span class="token punctuation">)</span><span class="token punctuation">)</span>
  db <span class="token operator">=</span> np<span class="token punctuation">.</span>zeros<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token operator">*</span>H<span class="token punctuation">,</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
  dprev_h <span class="token operator">=</span> np<span class="token punctuation">.</span>zeros<span class="token punctuation">(</span><span class="token punctuation">(</span>N<span class="token punctuation">,</span> H<span class="token punctuation">)</span><span class="token punctuation">)</span>
  dprev_c <span class="token operator">=</span> np<span class="token punctuation">.</span>zeros<span class="token punctuation">(</span><span class="token punctuation">(</span>N<span class="token punctuation">,</span> H<span class="token punctuation">)</span><span class="token punctuation">)</span>
  <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">xrange</span><span class="token punctuation">(</span>T<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    dx_i<span class="token punctuation">,</span>dprev_h<span class="token punctuation">,</span>dprev_c<span class="token punctuation">,</span>dWx_i<span class="token punctuation">,</span>dWh_i<span class="token punctuation">,</span>db_i <span class="token operator">=</span> lstm_step_backward<span class="token punctuation">(</span>dh<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span>i<span class="token punctuation">,</span><span class="token punctuation">:</span><span class="token punctuation">]</span><span class="token operator">+</span>dprev_h<span class="token punctuation">,</span>dprev_c<span class="token punctuation">,</span>cache<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span>
    dx<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span>i<span class="token punctuation">,</span><span class="token punctuation">:</span><span class="token punctuation">]</span> <span class="token operator">=</span> dx_i
    dWh <span class="token operator">+=</span> dWh_i
    dWx <span class="token operator">+=</span> dWx_i
    db <span class="token operator">+=</span> db_i
  dh0 <span class="token operator">=</span> dprev_h

  <span class="token comment">##############################################################################</span>
  <span class="token comment">#                               END OF YOUR CODE                             #</span>
  <span class="token comment">##############################################################################</span>

  <span class="token keyword">return</span> dx<span class="token punctuation">,</span> dh0<span class="token punctuation">,</span> dWx<span class="token punctuation">,</span> dWh<span class="token punctuation">,</span> db</code></pre></div></section><hr style="margin-bottom:1.5rem"/><footer><div style="display:flex;margin-bottom:3.75rem"><p>Written by <a href="https://github.com/twistronics" style="background-image:none"><strong>twistronics</strong></a></p> <!-- -->  <!-- --> </div></footer></article><nav><ul style="display:flex;flex-wrap:wrap;justify-content:space-between;list-style:none;padding:0"><li><a rel="prev" href="/blogs/latent-semantic-indexing/">← <!-- -->对zhwiki数据集进行LSI分析 (latent semantic indexing)</a></li><li><a rel="next" href="/blogs/an-attempt-to-playing-contra-with-machine-learning/">An attempt to playing contra with machine learning<!-- --> →</a></li></ul></nav></main><footer>© <!-- -->2020<!-- -->, Built with<!-- --> <a href="https://www.gatsbyjs.com" style="background-image:none">Gatsby</a></footer></div></div><div id="gatsby-announcer" style="position:absolute;top:0;width:1px;height:1px;padding:0;overflow:hidden;clip:rect(0, 0, 0, 0);white-space:nowrap;border:0" aria-live="assertive" aria-atomic="true"></div></div><script id="gatsby-script-loader">/*<![CDATA[*/window.pagePath="/blogs/cs231n-Practical-Machine-Learning-Project-2/";/*]]>*/</script><script id="gatsby-chunk-mapping">/*<![CDATA[*/window.___chunkMapping={"app":["/app-c94c84d1627c2405770e.js"],"component---src-pages-404-js":["/component---src-pages-404-js-f54b3ee11fe2b68846ad.js"],"component---src-pages-all-tags-js":["/component---src-pages-all-tags-js-fc7b58de7b3eb2ea01bb.js"],"component---src-pages-index-js":["/component---src-pages-index-js-e9f1f7b70f886ee7244f.js"],"component---src-pages-using-typescript-tsx":["/component---src-pages-using-typescript-tsx-96180b52c76d6242ee01.js"],"component---src-templates-blog-post-js":["/component---src-templates-blog-post-js-11ba5fcb3e84959fd9c6.js"],"component---src-templates-tag-page-js":["/component---src-templates-tag-page-js-359eac9b6566a50e4d0f.js"]};/*]]>*/</script><script src="/component---src-templates-blog-post-js-11ba5fcb3e84959fd9c6.js" async=""></script><script src="/commons-83e5dfcf4e4c104a0e8d.js" async=""></script><script src="/styles-c2fe8482057191dca484.js" async=""></script><script src="/app-c94c84d1627c2405770e.js" async=""></script><script src="/framework-93d3a746c3cf42acdafc.js" async=""></script><script src="/webpack-runtime-7057b47b0c1b3e1dc538.js" async=""></script></body></html>